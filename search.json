[{"categories":["CTF"],"content":"前言\r好多题，质量很高，misc没怎么看，全在看web，Java还是打不动😿，还有一些关于云的，也不会，先贴一下写了的wp，pop当时没做，其他题之后有空复现一下 ","date":"2025-01-14","objectID":"/posts/48766ef/:1:0","tags":["CTF"],"title":"SUCTF2025部分wp","uri":"/posts/48766ef/"},{"categories":["CTF"],"content":"Misc\r","date":"2025-01-14","objectID":"/posts/48766ef/:2:0","tags":["CTF"],"title":"SUCTF2025部分wp","uri":"/posts/48766ef/"},{"categories":["CTF"],"content":"SU_checkin\r找到个password：SePassWordLen23SUCT 加密方式：PBEWithMD5AndDES 感觉hacker这个用户里的密码就是盐，但是爆破出来是 hacker（怎么不是8位） 迭代次数应该是默认的1000，不行的话爆破也行，OUTPUT应该就是密文：ElV+bGCnJYHVR8m23GLhprTGY0gHi/tNXBkGBtQusB/zs0uIHHoXMJoYd6oSOoKuFWmAHYrxkbg= 后来发现不用盐也可以解密，密码SePassWordLen23SUCT其实是暗示密码length为23，其实应该是SUCTF，照着加密脚本：https://blog.csdn.net/iin729/article/details/128432332，叫ai写了个python解密脚本 import base64 import hashlib import re import itertools import string from Crypto.Cipher import DES def get_derived_key(password, salt, count): key = password + salt for i in range(count): m = hashlib.md5(key) key = m.digest() return (key[:8], key[8:]) def decrypt(msg, password): msg_bytes = base64.b64decode(msg) salt = msg_bytes[:8] enc_text = msg_bytes[8:] (dk, iv) = get_derived_key(password, salt, 1000) crypter = DES.new(dk, DES.MODE_CBC, iv) text = crypter.decrypt(enc_text) # Remove padding at the end, if any return re.sub(r'[\\x01-\\x08]', '', text.decode(\"utf-8\", errors=\"ignore\")) def brute_force_decrypt(ciphertext, prefix, length, charset): # Calculate the number of missing characters missing_length = length - len(prefix) # Generate all possible combinations of the missing characters for combination in itertools.product(charset, repeat=missing_length): # Construct the full password password = prefix + ''.join(combination) try: # Attempt to decrypt the ciphertext decrypted_text = decrypt(ciphertext, password.encode(\"utf-8\")) # Check if the decrypted text contains \"SUCTF\" if \"SUCTF\" in decrypted_text: print(f\"Found valid password: {password}\") print(f\"Decrypted text: {decrypted_text}\") return password, decrypted_text except Exception as e: # If decryption fails, just continue to the next combination continue print(\"No valid password found.\") return None, None def main(): # Known prefix of the password prefix = \"SePassWordLen23SUCTF\" # Total length of the password length = 23 # Character set to use for the missing characters (alphanumeric) charset = string.ascii_letters + string.digits # Ciphertext to decrypt ciphertext = \"ElV+bGCnJYHVR8m23GLhprTGY0gHi/tNXBkGBtQusB/zs0uIHHoXMJoYd6oSOoKuFWmAHYrxkbg=\" # Start brute-forcing password, decrypted_text = brute_force_decrypt(ciphertext, prefix, length, charset) if password: print(f\"Success! Password: {password}\") print(f\"Decrypted text: {decrypted_text}\") if __name__ == \"__main__\": main() ","date":"2025-01-14","objectID":"/posts/48766ef/:2:1","tags":["CTF"],"title":"SUCTF2025部分wp","uri":"/posts/48766ef/"},{"categories":["CTF"],"content":"SU_RealCheckin\rhello ctf -\u003e 🏠🦅🍋🍋🍊 🐈🌮🍟 $flag -\u003e 🐍☂️🐈🌮🍟{🐋🦅🍋🐈🍊🏔️🦅_🌮🍊_🐍☂️🐈🌮🍟_🧶🍊☂️_🐈🍎🌃_🌈🦅🍎🍋🍋🧶_🐬🍎🌃🐈🦅} $flag 前五个为suctf，根据映射关系最后大括号里面的推断出来是 ? e l c o ? e _ t o _ s u c t f _ ? o u _ c ? ? _ r e ? l l ? _ d ? ? c e 其实第一段很明显是welcome，可以发现该emoji代表的东西的英文首字母就是该emoji代表的字符，故最后flag为 suctf{welcome_to_suctf_you_can_really_dance} ","date":"2025-01-14","objectID":"/posts/48766ef/:2:2","tags":["CTF"],"title":"SUCTF2025部分wp","uri":"/posts/48766ef/"},{"categories":["CTF"],"content":"Web\r","date":"2025-01-14","objectID":"/posts/48766ef/:3:0","tags":["CTF"],"title":"SUCTF2025部分wp","uri":"/posts/48766ef/"},{"categories":["CTF"],"content":"SU_blog\rarticles 目录有目录穿越，读启动命令，双写绕过一下 article?file=articles/....//....//....//....//....//....//proc/self/cmdline 拿到pythonapp/app.py，拿源码 article?file=articles/....//....//app/app.py 源码 from flask import * import time,os,json,hashlib from pydash import set_ from waf import pwaf,cwaf app = Flask(__name__) app.config['SECRET_KEY'] = hashlib.md5(str(int(time.time())).encode()).hexdigest() users = {\"testuser\": \"password\"} BASE_DIR = '/var/www/html/myblog/app' articles = { 1: \"articles/article1.txt\", 2: \"articles/article2.txt\", 3: \"articles/article3.txt\" } friend_links = [ {\"name\": \"bkf1sh\", \"url\": \"https://ctf.org.cn/\"}, {\"name\": \"fushuling\", \"url\": \"https://fushuling.com/\"}, {\"name\": \"yulate\", \"url\": \"https://www.yulate.com/\"}, {\"name\": \"zimablue\", \"url\": \"https://www.zimablue.life/\"}, {\"name\": \"baozongwi\", \"url\": \"https://baozongwi.xyz/\"}, ] class User(): def __init__(self): pass user_data = User() @app.route('/') def index(): if 'username' in session: return render_template('blog.html', articles=articles, friend_links=friend_links) return redirect(url_for('login')) @app.route('/login', methods=['GET', 'POST']) def login(): if request.method == 'POST': username = request.form['username'] password = request.form['password'] if username in users and users[username] == password: session['username'] = username return redirect(url_for('index')) else: return \"Invalid credentials\", 403 return render_template('login.html') @app.route('/register', methods=['GET', 'POST']) def register(): if request.method == 'POST': username = request.form['username'] password = request.form['password'] users[username] = password return redirect(url_for('login')) return render_template('register.html') @app.route('/change_password', methods=['GET', 'POST']) def change_password(): if 'username' not in session: return redirect(url_for('login')) if request.method == 'POST': old_password = request.form['old_password'] new_password = request.form['new_password'] confirm_password = request.form['confirm_password'] if users[session['username']] != old_password: flash(\"Old password is incorrect\", \"error\") elif new_password != confirm_password: flash(\"New passwords do not match\", \"error\") else: users[session['username']] = new_password flash(\"Password changed successfully\", \"success\") return redirect(url_for('index')) return render_template('change_password.html') @app.route('/friendlinks') def friendlinks(): if 'username' not in session or session['username'] != 'admin': return redirect(url_for('login')) return render_template('friendlinks.html', links=friend_links) @app.route('/add_friendlink', methods=['POST']) def add_friendlink(): if 'username' not in session or session['username'] != 'admin': return redirect(url_for('login')) name = request.form.get('name') url = request.form.get('url') if name and url: friend_links.append({\"name\": name, \"url\": url}) return redirect(url_for('friendlinks')) @app.route('/delete_friendlink/\u003cint:index\u003e') def delete_friendlink(index): if 'username' not in session or session['username'] != 'admin': return redirect(url_for('login')) if 0 \u003c= index \u003c len(friend_links): del friend_links[index] return redirect(url_for('friendlinks')) @app.route('/article') def article(): if 'username' not in session: return redirect(url_for('login')) file_name = request.args.get('file', '') if not file_name: return render_template('article.html', file_name='', content=\"未提供文件名。\") blacklist = [\"waf.py\"] if any(blacklisted_file in file_name for blacklisted_file in blacklist): return render_template('article.html', file_name=file_name, content=\"大黑阔不许看\") if not file_name.startswith('articles/'): return render_template('article.html', file_name=file_name, content=\"无效的文件路径。\") if file_name not in articles.values(): if session.get('username') != 'admin': return render_template('article.html', file_name=file_name, content=\"无权访问该文件。\") file_path = os.path.join(BASE_DIR, file_name) file_path = file_path.replace('../', '') try: with open(file_path, 'r', encoding='ut","date":"2025-01-14","objectID":"/posts/48766ef/:3:1","tags":["CTF"],"title":"SUCTF2025部分wp","uri":"/posts/48766ef/"},{"categories":["CTF"],"content":"SU_photogallery\r404页面 参考 [FSCTF 2023]签到plus 尝试打下 php＜= 7 . 4 . 21 development server源码泄露，其实随便访问一下就出源码了 unzip.php \u003c?php error_reporting(0); function get_extension($filename){ return pathinfo($filename, PATHINFO_EXTENSION); } function check_extension($filename,$path){ $filePath = $path . DIRECTORY_SEPARATOR . $filename; if (is_file($filePath)) { $extension = strtolower(get_extension($filename)); if (!in_array($extension, ['jpg', 'jpeg', 'png', 'gif'])) { if (!unlink($filePath)) { // echo \"Fail to delete file: $filename\\n\"; return false; } else{ // echo \"This file format is not supported:$extension\\n\"; return false; } } else{ return true; } } else{ // echo \"nofile\"; return false; } } function file_rename ($path,$file){ $randomName = md5(uniqid().rand(0, 99999)) . '.' . get_extension($file); $oldPath = $path . DIRECTORY_SEPARATOR . $file; $newPath = $path . DIRECTORY_SEPARATOR . $randomName; if (!rename($oldPath, $newPath)) { unlink($path . DIRECTORY_SEPARATOR . $file); // echo \"Fail to rename file: $file\\n\"; return false; } else{ return true; } } function move_file($path,$basePath){ foreach (glob($path . DIRECTORY_SEPARATOR . '*') as $file) { $destination = $basePath . DIRECTORY_SEPARATOR . basename($file); if (!rename($file, $destination)){ // echo \"Fail to rename file: $file\\n\"; return false; } } return true; } function check_base($fileContent){ $keywords = ['eval', 'base64', 'shell_exec', 'system', 'passthru', 'assert', 'flag', 'exec', 'phar', 'xml', 'DOCTYPE', 'iconv', 'zip', 'file', 'chr', 'hex2bin', 'dir', 'function', 'pcntl_exec', 'array', 'include', 'require', 'call_user_func', 'getallheaders', 'get_defined_vars','info']; $base64_keywords = []; foreach ($keywords as $keyword) { $base64_keywords[] = base64_encode($keyword); } foreach ($base64_keywords as $base64_keyword) { if (strpos($fileContent, $base64_keyword)!== false) { return true; } else{ return false; } } } function check_content($zip){ for ($i = 0; $i \u003c $zip-\u003enumFiles; $i++) { $fileInfo = $zip-\u003estatIndex($i); $fileName = $fileInfo['name']; if (preg_match('/\\.\\.(\\/|\\.|%2e%2e%2f)/i', $fileName)) { return false; } // echo \"Checking file: $fileName\\n\"; $fileContent = $zip-\u003egetFromName($fileName); if (preg_match('/(eval|base64|shell_exec|system|passthru|assert|flag|exec|phar|xml|DOCTYPE|iconv|zip|file|chr|hex2bin|dir|function|pcntl_exec|array|include|require|call_user_func|getallheaders|get_defined_vars|info)/i', $fileContent) || check_base($fileContent)) { // echo \"Don't hack me!\\n\"; return false; } else { continue; } } return true; } function unzip($zipname, $basePath) { $zip = new ZipArchive; if (!file_exists($zipname)) { // echo \"Zip file does not exist\"; return \"zip_not_found\"; } if (!$zip-\u003eopen($zipname)) { // echo \"Fail to open zip file\"; return \"zip_open_failed\"; } if (!check_content($zip)) { return \"malicious_content_detected\"; } $randomDir = 'tmp_'.md5(uniqid().rand(0, 99999)); $path = $basePath . DIRECTORY_SEPARATOR . $randomDir; if (!mkdir($path, 0777, true)) { // echo \"Fail to create directory\"; $zip-\u003eclose(); return \"mkdir_failed\"; } if (!$zip-\u003eextractTo($path)) { // echo \"Fail to extract zip file\"; $zip-\u003eclose(); } for ($i = 0; $i \u003c $zip-\u003enumFiles; $i++) { $fileInfo = $zip-\u003estatIndex($i); $fileName = $fileInfo['name']; if (!check_extension($fileName, $path)) { // echo \"Unsupported file extension\"; continue; } if (!file_rename($path, $fileName)) { // echo \"File rename failed\"; continue; } } if (!move_file($path, $basePath)) { $zip-\u003eclose(); // echo \"Fail to move file\"; return \"move_failed\"; } rmdir($path); $zip-\u003eclose(); return true; } $uploadDir = __DIR__ . DIRECTORY_SEPARATOR . 'upload/suimages/'; if (!is_dir($uploadDir)) { mkdir($uploadDir, 0777, true); } if (isset($_FILES['file']) \u0026\u0026 $_FILES['file']['error'] === UPLOAD_ERR_OK) { $uploadedFile = $_FILES['file']; $zipname = $uploadedFile['tmp_name']; $path = $uploadDir; $result = unzip($zipname, $path); if ($result === true) { header(\"Location: index.html?status=success\"); exit(); } else { header(\"Loca","date":"2025-01-14","objectID":"/posts/48766ef/:3:2","tags":["CTF"],"title":"SUCTF2025部分wp","uri":"/posts/48766ef/"},{"categories":["CTF"],"content":"前言\r比赛时间有点阴间，题目的话全是二进制，能看的题就只有三道，Java听说是个1day，摆了 ","date":"2025-01-07","objectID":"/posts/6c39531/:1:0","tags":["CTF"],"title":"软件系统安全赛初赛2025部分wp","uri":"/posts/6c39531/"},{"categories":["CTF"],"content":"钓鱼邮件\r记事本打开是一大串base64编码，解码后是个zip，下载下来爆破密码，最后密码为 20001111，得到个exe，拿到奇安信在线沙箱出 尝试后发现是222.218.218.218那个，md5一下就行 ","date":"2025-01-07","objectID":"/posts/6c39531/:2:0","tags":["CTF"],"title":"软件系统安全赛初赛2025部分wp","uri":"/posts/6c39531/"},{"categories":["CTF"],"content":"CachedVisitor\rmain.lua local function read_file(filename) local file = io.open(filename, \"r\") if not file then print(\"Error: Could not open file \" .. filename) return nil end local content = file:read(\"*a\") file:close() return content end local function execute_lua_code(script_content) local lua_code = script_content:match(\"##LUA_START##(.-)##LUA_END##\") if lua_code then local chunk, err = load(lua_code) if chunk then local success, result = pcall(chunk) if not success then print(\"Error executing Lua code: \", result) end else print(\"Error loading Lua code: \", err) end else print(\"Error: No valid Lua code block found.\") end end local function main() local filename = \"/scripts/visit.script\" local script_content = read_file(filename) if script_content then execute_lua_code(script_content) end end main() 最后是执行了一个文件，而/scripts/visit.script的作用是从外部 URL 获取数据并将其缓存到 Redis 中，一个很明显的ssrf打redis，刚开始走偏了，以为是打个cve 可以直接把/scripts/visit.script覆盖成执行/readflag并获取回显，用dict协议老是会报引号有问题，用gopher协议打 这里选择的是phpshell，默认生成的是shell.php，解码改一下文件名和长度 最后编码的话还是建议用bp直接编码，其他的总会出点问题 接下来是二进制爷的wp ","date":"2025-01-07","objectID":"/posts/6c39531/:3:0","tags":["CTF"],"title":"软件系统安全赛初赛2025部分wp","uri":"/posts/6c39531/"},{"categories":["CTF"],"content":"donntyousee\r打开文件逐步调试 这里面是call-ret型花指令，所以把相关内容nop掉，大致格式是： push rax; call loop; loop: xxxxx; ret; pop rax; 每个相关的函数都有这个，可以全部nop掉 调用了这两个函数，分别都是call r8，只有动态调试 第一个是执行Sbox的初始化，用的数据是byte_5C5110，这个是key 第二个函数是执行加密，很明显是一个魔改RC4，可以直接逆向。 继续往后调试 这里进行了比较，sub_4E4060是输出正确与否，所以看v7的终值，直接解密即可 key:921C2B1FBAFBA2FF07697D77188C data:25 cd 54 af 51 1c 58 d3 a8 4b 4f 56 ec 83 5d d4 f6 47 4a 6f e0 73 b0 a5 a8 c3 17 81 5e 2b f4 f6 71 ea 2f ff a8 63 99 57 flag:dart{y0UD0ntL4cKg0oD3y34T0F1nDTh3B4aUtY} ","date":"2025-01-07","objectID":"/posts/6c39531/:4:0","tags":["CTF"],"title":"软件系统安全赛初赛2025部分wp","uri":"/posts/6c39531/"},{"categories":["杂记"],"content":"前置\r下载好Git、Go 和 Dart Sass、hugo Dart Sass我这用的npm下的 npm install -g sass sass --version //验证安装 hugo下载：https://github.com/gohugoio/hugo/releases（下载extend拓展版的，方便自定义加东西，记得加环境变量） 其他我都配好了，不多说 ","date":"2025-01-06","objectID":"/posts/5c6225e/:1:0","tags":["杂记"],"title":"博客搭建","uri":"/posts/5c6225e/"},{"categories":["杂记"],"content":"博客配置\r然后按照这个来吧： https://fixit.lruihao.cn/zh-cn/documentation/getting-started/quick-start/ 这里echo时要去掉双引号，其他的不多说 ","date":"2025-01-06","objectID":"/posts/5c6225e/:2:0","tags":["杂记"],"title":"博客搭建","uri":"/posts/5c6225e/"},{"categories":null,"content":"Introduction👨‍💻\rWeb/Misc@D0g3 想学渗透，想学Java ","date":"0001-01-01","objectID":"/about/:1:0","tags":null,"title":"About","uri":"/about/"},{"categories":null,"content":"Contact me☎️\rQQ：Mjg2OTg3Mzk1OQ== Github：https://github.com/6s6-630 ","date":"0001-01-01","objectID":"/about/:2:0","tags":null,"title":"About","uri":"/about/"},{"categories":null,"content":"待更新 ","date":"0001-01-01","objectID":"/links/:0:0","tags":null,"title":"Links","uri":"/links/"}]